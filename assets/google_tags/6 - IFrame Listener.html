<script>

(function () {
  const CF_IFRAME_ID = 'communityFinderFrame';
  const CF_ORIGIN = 'https://neighborhoods.truesouthcoastalhomes.com';

  const frame = document.getElementById(CF_IFRAME_ID);
  if (!frame || !frame.contentWindow) return;

  const sendMessage = (type, payload = {}) => {
    frame.contentWindow.postMessage({ type, ...payload }, CF_ORIGIN);
  };

  const bindButton = (selector, messageType) => {
    const btn = document.querySelector(selector);
    if (!btn) return;
    btn.addEventListener('click', () => sendMessage(messageType));
  };

  bindButton('[data-map-fullscreen="enter"]', 'enterFullscreen');
  bindButton('[data-map-fullscreen="exit"]', 'exitFullscreen');

  // Optional: respond to child state updates
  window.addEventListener('message', (event) => {
    if (event.origin !== CF_ORIGIN || !event.data) return;

    switch (event.data.type) {
      case 'fullscreenChanged':
        document.body.classList.toggle('cf-hostfullscreen', Boolean(event.data.active));
        const enterBtn = document.querySelector('[data-map-fullscreen="enter"]');
        const exitBtn = document.querySelector('[data-map-fullscreen="exit"]');
        if (enterBtn && exitBtn) {
          enterBtn.disabled = Boolean(event.data.active);
          exitBtn.disabled = !Boolean(event.data.active);
        }
        break;
      case 'drawerState':
        console.log('Drawer state:', event.data.open ? 'open' : 'closed');
        break;
    }
  });
})();
</script>
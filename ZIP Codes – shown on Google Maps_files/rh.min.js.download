(()=>{const e={EmbedTypes:{Twitter:0,Instagram:1,Spotify:2,Soundcloud:3,Facebook:4,Youtube:5,Megaphone:6,Giphy:7,Imgur:8,Reddit:9,Anchor:10,Vimeo:11,Twitch:12,TikTok:13,GfyCat:14,AppleMusic:15,Tumblr:16,Pinterest:17,LinkedIn:18},ProductType:{Spotlight:"Spotlight",FabrikPlayer:"FabrikPlayer",HappeningNow:"HappeningNow",SocialCanvas:"SocialCanvas"},zIndexMax:2147483647,apiDom:"https://socialcanvas-api.kargo.com/",cdnDom:"https://socialcanvas-cdn.kargo.com/",lhPort:10548};function t(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i]);return t}function i(e){if(Array.isArray(e)){const t=[];for(let i=0;i<e.length;i++)t.push(e[i]);return t}if(e&&"object"==typeof e){const t={},s=Object.keys(e);for(let n=0;n<s.length;n++){const o=s[n];t[o]=i(e[o])}return t}return e}function s(e,t,n=0){if(!e)return t;if(!t)return e;const o=i(e),a=Object.keys(t);for(let e=0;e<a.length;e++){const l=a[e];if(l in o&&"object"==typeof o[l]){const e=s(o[l],t[l],n);o[l]=e}else n&&!t[l]||(o[l]=i(t[l]))}return o}function n(e,t){const i=t.split(".");for(;i.length;){let t=i.shift();if(t&&t.includes("(")&&t.endsWith(")")){let i=t.replace(")","").split("(")[1].split(",");if(i=i.map((e=>e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.substr(1,e.length-2):e)),t=t.split("(")[0],!e[t])return null;e=e[t].apply(e,i)}else if(t&&!(e=e[t]))return null}return e}function o(e,t){let i=0;if(!e)return i;if("string"==typeof e)i=e.includes(t);else if("object"==typeof e){const s=Object.keys(e);for(let n=0;n<s.length&&(i=o(e[s[n]],t),!i);n++);}else if(Array.isArray(e))for(let s=0;s<e.length&&(i=o(e[s],t),!i);s++);return i}function a(e){let t=e;return t=l("//",t,""),t=l("https",t,""),t=l("http",t,""),t=l("<",t,""),t=l("&lt;",t,""),t=l("&#60;",t,""),t=l(">",t,""),t=l("&gt;",t,""),t=l("&#62;",t,""),t}function l(e,t,i){return i?t.replace(RegExp(e,"g"),i):t}function r(e,t,i){let s=e.substring(e.indexOf(t)+t.length);return i&&(s=s.substring(0,s.indexOf(i))),s}function d(e,t,i,s,n,o){o||(o=document);const a=o.querySelectorAll("script");for(let t=0;t<a.length;t++){const i=a[t];if(i.src&&(i.src.includes(e)||e.includes(i.src)))return i}const l=o.createElement("script");l.type="text/javascript",l.src=e,void 0!==t&&(l.async=t),void 0!==s&&(l.id=s),void 0!==i&&i&&l.addEventListener("load",i);const r=n||document.getElementsByTagName("head")[0];return r.insertBefore(l,r.firstChild),l}function h(e){if(!(e instanceof HTMLScriptElement))return null;const t=document.createElement("script");return e.getAttribute("id")&&(t.id=e.id),e.getAttribute("async")&&(t.async=e.async),e.src&&e.src.length>0&&(t.src=e.src),e.getAttribute("charset")&&t.setAttribute("charset",e.getAttribute("charset")||""),t.text=e.innerHTML,t}function c(e){if(e.childNodes.length>0)for(let t=0;t<e.childNodes.length;t++)if(e.childNodes[t]instanceof HTMLElement&&"SCRIPT"==e.childNodes[t].tagName){const i=h(e.childNodes[t]);i&&(e.removeChild(e.childNodes[t]),t<e.childNodes.length-1?e.insertBefore(i,e.childNodes[t+1]):e.appendChild(i))}else c(e.childNodes[t])}function p(e,t,i,s,n=null,o=null){const a=document.createElement(e);return t&&(a.className=t),i&&(a.innerHTML=i),s&&(a.style.cssText=s),n&&(a.onclick=n),o&&a.setAttribute("value",o),a}function g(e){const t=document.createElement("div");var i;return t.innerHTML=(i=l("{{hostname}}",i=e.trim(),window.location.hostname),i=l("{{href}}",i,window.location.href),i=l("{{page_title}}",i,document.title),i=l("{hostname}",i,window.location.hostname),i=l("{href}",i,window.location.href),l("{page_title}",i,document.title)),t.children&&1==t.children.length&&1==t.children[0].children.length&&"IMG"==t.children[0].children[0].tagName&&(t.children[0].children[0].setAttribute("nopin","nopin"),t.children[0].children[0].setAttribute("data-pin-nopin","nopin")),Array.from(t.childNodes)}function m(e,t){let i=null==e?void 0:e.parentElement;for(;i;){if(t.some((e=>i.classList.contains(e))))return i;i=i.parentElement}return null}function u(e,t){let i=e.parentElement;for(;i;){if(i.matches(t))return i;i=i.parentElement}return null}function b(e){if(!e)return null;let t=e,i=null;for(;!i&&t.previousElementSibling;)t=t.previousElementSibling,((t.innerHTML||"").trim().length||"TWITTER-WIDGET"==t.tagName||"IFRAME"==t.tagName||t.classList&&t.classList.contains("o-Article__m-Divider"))&&(i=t);return i}function y(e){return"fixed"==window.getComputedStyle(e).position}function f(e){if(!(e instanceof HTMLElement))return 0;if(0==e.clientWidth||0==e.clientHeight)return 1;if(null===e.offsetParent&&!y(e))return 1;if(null===e.offsetParent){const t=window.getComputedStyle(e);if("none"==t.display||"hidden"==t.visibility)return 1}return 0}function v(e){const t=e.getBoundingClientRect(),i=window.pageXOffset||document.documentElement.scrollLeft,s=window.pageYOffset||document.documentElement.scrollTop;return{top:t.top+s,left:t.left+i,bottom:t.top+s+e.clientHeight,right:t.left+i+e.clientWidth}}function w(e){const t=e.getBoundingClientRect();return t.bottom>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)}function S(e){const t=e.getBoundingClientRect(),i=1*(window.innerHeight||document.documentElement.clientHeight);return t.bottom>=0-i&&t.top<=(window.innerHeight||document.documentElement.clientHeight)+i}function k(e){if(!e)return 0;const t=e.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight;return Math.min(1,t.bottom/i)}function T(e){let t=0;const i=e.children;let s=null,n=0;for(n=0;n<i.length;n++){if(s=i[n],"A"!=s.tagName&&"SPAN"!=s.tagName&&"EM"!=s.tagName&&"STRONG"!=s.tagName&&"B"!=s.tagName&&"I"!=s.tagName&&"U"!=s.tagName&&"S"!=s.tagName&&"STRIKE"!=s.tagName&&"SUB"!=s.tagName&&"SUP"!=s.tagName&&"CODE"!=s.tagName&&"PRE"!=s.tagName&&"SMALL"!=s.tagName&&"BIG"!=s.tagName&&"TT"!=s.tagName&&"VAR"!=s.tagName&&"DFN"!=s.tagName&&"CITE"!=s.tagName&&"ABBR"!=s.tagName&&"ACRONYM"!=s.tagName&&"Q"!=s.tagName&&"KBD"!=s.tagName&&"SAMP"!=s.tagName&&"IMG"!=s.tagName&&"SVG"!=s.tagName&&"MATH"!=s.tagName&&"MAP"!=s.tagName&&"AREA"!=s.tagName){t=1;break}if(s.children.length>0&&T(s)){t=1;break}}if(!t&&0==e.children.length){let i=0;for(n=0;n<e.childNodes.length;n++){const t=e.childNodes[n];if(3==t.nodeType&&t.textContent&&t.textContent.trim().length>0){i=1;break}}i||(t=1)}return t}function A(e,t){let i=0,s=null;if(!t.contains(e))return null;let n=e;for(;n&&n!=t;)n.parentElement==t&&(s=n.tagName),n=n.parentElement,i++;return{distance:i,childContainer:s}}function E(e,t=0){let i,s;const n=e.querySelectorAll("p,blockquote,div"),o=[];for(i=0;i<n.length;i++){const e=n[i];T(e)||e.textContent&&e.textContent.replace(/\s{2,}/g," ").trim().length>150&&o.push(e)}const a=((e,t)=>{const i=[];return document.querySelectorAll("*").forEach((t=>{["NAV","UL","OL","LI","IFRAME","HEADER"].includes(t.tagName)||t.classList&&t.classList.contains("sticky-element")||f(t)||u(t,'nav,header,[role="navigation"]')||e.filter((e=>t.contains(e))).length>=2&&i.push(t)})),i})(o),l={};for(i=0;i<o.length;i++)for(let e=0;e<a.length;e++){const t=A(o[i],a[e]);l[e]||(l[e]={totalDistance:0,count:0,childContainers:[]}),t&&(l[e].totalDistance+=t.distance,l[e].childContainers.push(t.childContainer),l[e].count++)}for(i=0;i<Object.keys(l).length;i++)s=Object.keys(l)[i],0!=l[s].count&&(l[s].averageDistance=l[s].totalDistance/l[s].count,w(a[i])&&(l[s].averageDistance=l[s].averageDistance-.99));let r=null,d=99999;for(i=0;i<Object.keys(l).length;i++){let e=Object.keys(l)[i];l[e].averageDistance<d&&(r=Number(e),d=l[e].averageDistance)}if(!r&&0!==r)return null;const h={};if(l[r].childContainers)for(i=0;i<l[r].childContainers.length;i++){const e=l[r].childContainers[i];h[e]||(h[e]=0),h[e]++}let c=null,p=0;for(i=0;i<Object.keys(h).length;i++)s=Object.keys(h)[i],h[s]>p&&(c=s,p=h[s]);return{contentContainer:a[r],childContainerType:t?c:null}}function C(e=0){const t=t=>{for(let i=0;i<t.length;i++){const s=t[i],n=getComputedStyle(s);if(("sticky"===n.position||"fixed"===n.position)&&parseFloat(n.top||"auto")<window.innerHeight/3){if(s.className.includes("ksc-"))continue;if(e)continue;return s}}},i=[];let s;for(let e=0;e<10;e++){s=document.elementsFromPoint(window.innerWidth/2,1+window.innerHeight/30*e);const n=t(s);n&&i.push(n)}return i}function I(e){e.stopPropagation()}function x(e,t=0,i=0,s=0,n=0){if(!e)return 0;let o=100;if(s&&(o=160),n)return 0;const a=document.body.getElementsByTagName("*");for(let s=0;s<a.length;s++)if(L(a[s])){const n=e.getBoundingClientRect(),l=a[s].getBoundingClientRect();if(l.height>=40&&l.left<n.right&&l.right>n.left)if(!i&&l.bottom<n.top){if(n.top-l.bottom<o)return 1}else if(!t&&l.top>n.bottom){if(l.top-n.bottom<o)return 1}else if(t&&l.top>n.top){if(l.top-n.top<o)return 1}else if(!t&&n.bottom-l.bottom<o)return 1}return 0}function L(e){return e?f(e)?0:e&&"classList"in e&&(M(e.classList,["adunitwrapper","ad-zone-container","ad","Ad","admz","in-article-ad","gpt-ad","suitcase-ad","dfp-tag-wrapper","slate-ad","ad--desktopOnly","ad--inArticleBanner","teads-inread","SimpleAd","in-article-oop-container","adWrapper","adl-report-ad-container","adthrive-ad","ad-vertical","ad-title","advertisement-holder","ad-unit","ad-container","breaker-ad","mv-ad-box","Post__ad","Post__openWebSlot"])||e.className&&e.className.length&&e.className.includes("evolve_ad_gpt")||e.className&&e.className.length&&e.className.includes("advert-placeholder")||e.className&&e.className.length&&e.className.includes("kargoad-")||e.className&&e.className.length&&e.className.includes("kargo-ad-")||e.className&&e.className.length&&e.className.includes("bbc_drop-capped")||e.id&&e.id.includes("s2n-player")||e.id&&e.id.includes("kargo-ad-")||e.id&&e.id.includes("google_ads_iframe_")||e.id&&e.id.includes("div-gpt-ad")||e.id&&e.id.includes("ad-breaker-wrapper")||e.id&&e.id.includes("skm_ad_banner")||e.id&&e.id.includes("oopAdWrapper"))?e.classList.contains("Post__ad")&&e.querySelector(".Ad--empty")?0:1:0:0}function D(e=12){const t=[];for(let i=0;i<e;++i){const e=Math.floor(62*P());t.push("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"[e])}const i=new Date,s=new Date(i.getFullYear(),0),n=(i.getTime()-s.getTime())/1e3/60;let o="";return window.crypto&&window.crypto.getRandomValues||(o="r"),o+""+(i.getFullYear()-2e3)+Math.floor(n)+t.join("")}function N(){return Math.random().toString(36).substr(2,9)}function P(){const e=window.crypto||window.msCrypto;return e&&e.getRandomValues?e.getRandomValues(new Uint32Array(1))[0]/4294967295:Math.random()}function q(e,t=0){Array.isArray(e)||(e=[e]);for(let i=0;i<e.length;i++)if(t){if(window.location.hostname.includes(e[i]))return 1}else if(window.location.href.includes(e[i]))return 1;return 0}function _(e){return l("%%CACHEBUSTER%%",e,""+Math.round((new Date).getTime()/1e3))}function M(e,t){const i=e instanceof DOMTokenList;for(let s=0;s<t.length;s++)if(Array.isArray(t[s])){let n=1;for(let o=0;o<t[s].length;o++)i?e.contains(t[s][o])||(n=0):e.includes(t[s][o])||(n=0);if(n)return 1}else if(i){if(e.contains(t[s]))return 1}else if(e.includes&&e.includes(t[s]))return 1;return 0}class R{constructor(){var t;if(this.alreadyRan=0,this.ksoDisabled=0,this.debugMode=0,this.rhRunAgain=0,this.disableAdRendering=0,this.hashQs={},this.preloggingEnabled=0,this.otherUrlRequestIds={},this.requests={},this.overrideBlocklist=0,this.forceAdStacking=0,this.demoSettings={},this.doingReloadFor=null,this.loadSearchParams(),this.debugMode=null!=(t=Number(this.qsGet("kso_debug")))?t:0,this.qsBool("rhd")||this.qsBool("kso_disable"))this.ksoDisabled=1;else{if((this.qsBool("kso_disable_ads")||(document.body||{}).ksocan_disableads)&&(this.disableAdRendering=1),this.rhRunAgain=this.qsBool("rhrunagain"),this.qsHas("kso_diag")&&this.qsGet("kso_diag").length>0){let t=a(this.qsGet("kso_diag"));t.includes(".js")?d(t.split("/")[t.split("/").length-1].split(".")[0]):d(e.cdnDom+"js/"+t+".js")}(this.qsBool("rhobl")||this.qsBool("kso_obl"))&&(this.overrideBlocklist=1,this.forceAdStacking=1),(this.qsBool("rhadstacking")||this.qsBool("kso_adstacking")||this.qsBool("rhfas")||this.qsBool("adstacking"))&&(this.forceAdStacking=1),this.qsHas("rhdemo_celtra")&&(this.doDemo="celtra_"+this.qsGet("rhdemo_celtra")),this.qsHas("rhdemo")&&(this.doDemo=this.qsGet("rhdemo")),this.qsHas("kso_demo")&&(this.doDemo=this.qsGet("kso_demo")),this.qsHas("sc_demo_celtra")&&(this.doDemo="celtra_"+this.qsGet("sc_demo_celtra")),this.qsHas("sc_demo")&&(this.doDemo=this.qsGet("sc_demo")),this.qsHas("kso_demo")&&(this.doDemo=this.qsGet("kso_demo")),this.qsHas("kso_demo_celtra")&&(this.doDemo="celtra_"+this.qsGet("kso_demo_celtra")),this.qsHas("kso_demo_km")&&(this.doDemo="km_"+this.qsGet("kso_demo_km")),this.qsGet("kso_demo_db")&&(this.doDemo="db_"+this.qsGet("kso_demo_db")),this.qsGet("ksl_democreative")&&(this.doDemo=this.qsGet("ksl_democreative"))}}loadSearchParams(){if(this.loadPolyfill(),this.searchParams=new URLSearchParams(window.location.search),window.location.hash.length>1){const e=window.location.hash.substr(1).split("&");for(let t=0;t<e.length;t++){const i=e[t].split("=");i.length>1&&(this.hashQs[i[0]]=decodeURIComponent(i[1]))}}}qsGet(e){var t;return(null==(t=this.searchParams)?void 0:t.get(e))||(window.kso_qs||{})[e]||(this.hashQs||{})[e]||null}qsBool(e){return 1==this.qsGet(e)||1==this.qsGet(e)}qsHas(e){var t;return null!=(t=this.searchParams)&&t.has(e)||e in(window.kso_qs||{})||e in(this.hashQs||{})?1:0}loadPolyfill(){window.URLSearchParams||(window.URLSearchParams=function(e){const t=this;t.searchString=e,t.get=e=>{const i=RegExp("[?&]"+e+"=([^&#]*)").exec(t.searchString);return null==i?null:decodeURI(i[1])||0}})}}class O{constructor(){this.pageViewId=D(),this.newSession=0,this.initialLoad=1,this.sessionId=this.fetchSessionId()}fetchSessionId(){let e=sessionStorage.getItem("kso-session-id");if(e){const t=sessionStorage.getItem("kso-session-id-generated");if(!t||(new Date).getTime()-Number(t)<108e5)return this.newSession=0,e}return this.newSession=1,e=D(),sessionStorage.setItem("kso-session-id",e),sessionStorage.setItem("kso-session-id-generated",""+(new Date).getTime()),e}resetPageViewId(){this.pageViewId=D(),this.initialLoad=0}}class F{constructor(){this.subscriptions=[],this.eventHandler=e=>{const t=this.subscriptions.filter((t=>t.event===e.type)).slice().sort(((e,t)=>t.priority-e.priority));for(const i of t)try{i.callback(e)}catch(e){}}}activate(){window.addEventListener("beforeunload",this.eventHandler),window.addEventListener("message",this.eventHandler),window.addEventListener("blur",this.eventHandler),window.addEventListener("mousemove",this.eventHandler,{passive:1}),document.addEventListener("mouseout",this.eventHandler,{passive:1}),window.addEventListener("resize",this.eventHandler,{passive:1}),window.addEventListener("touchstart",this.eventHandler,{passive:1}),window.addEventListener("touchmove",this.eventHandler,{passive:1}),window.addEventListener("touchend",this.eventHandler,{passive:1}),window.addEventListener("touchcancel",this.eventHandler,{passive:1}),window.addEventListener("scroll",this.eventHandler,{passive:1})}subscribeToEvent(e,t,i){this.subscriptions.push({event:e,priority:t,callback:i}),this.subscriptions.sort(((e,t)=>t.priority-e.priority))}}class B{constructor(e){this.loaded=0,this.originalSlotIds=[],this.didUM=0,this.processedScriptSettings=0,this.productDefs={},this.productsEnabled={},this.deferForViewability=0,this.lowProf=0,this.multipleAds=0,this.requesting=0,this.standout=e,this.standout.settings.qsBool("rhsiteid")?(this.overrideSiteId=this.standout.settings.qsGet("rhsiteid"),this.standout.logger.SDTLog(13,null,{siteId:this.overrideSiteId})):window.top.ksoSiteId&&(this.overrideSiteId=window.top.ksoSiteId,this.standout.logger.SDTLog(13,null,{siteId:this.overrideSiteId}))}processServerSettings(e){this.loaded=1,"iu"in e&&this.processUM(e.iu),"siteId"in e&&(this.siteId=e.siteId,window.sc_sid=this.siteId,this.standout.logger.SDTLog(60,null,{siteId:this.siteId})),"kmId"in e&&(this.kmPid=e.kmId),"kmPubId"in e&&(this.kmPub=e.kmPubId),"scriptSettings"in e?this.processScriptSettings(e.scriptSettings):"prdef"in e&&this.processScriptSettings(e)}processScriptSettings(e,t){if(!this.processedScriptSettings){if(this.standout.logger.SDTLog(17,null,e),this.productDefs=e.prdef||{},(e=s(e,t)).prdef&&("fabrikPlayer"in e.prdef&&(this.productsEnabled.v=e.prdef.fabrikPlayer.enabled),"socialCanvas"in e.prdef&&(this.productsEnabled.sc=e.prdef.socialCanvas.enabled),e.prdef.advLabel&&(this.showAdvLabel=e.prdef.advLabel)),e.slotIds){this.originalSlotIds=e.slotIds,this.originalSlotIds.s&&(this.originalSlotIds.s||[]).length>1&&(this.multipleAds=1);const t=this.standout.session.pageViewId;this.standout.settings.requests[t]||(this.standout.settings.requests[t]={}),this.standout.settings.requests[t].slotIds=i(e.slotIds)}"dfv"in e&&(this.deferForViewability=e.dfv),this.standout.bidStack.loadServerSettings(e),Object.values(this.standout.products).forEach((t=>{t.loadServerSettings&&t.loadServerSettings(e)})),this.processedScriptSettings=1}}processUM(e){!this.didUM&&e&&(this.didUM=1,window.__krg_cerberus_disable_cookies=1,window.__krg_cerberus_partners="ttd,Dv360,AppNexus,bsw",this.standout.logger.SDTLog(18))}checkSiteSettings(){if(this.requesting)return void setTimeout((()=>{this.checkSiteSettings()}),500);this.requesting=1;const t={};this.overrideSiteId&&(t.osid=this.overrideSiteId),t.v=this.standout.version,t.u=window.location.href,t.url=window.location.href,t.pt=document.title,t.hn=window.location.hostname,t.rf=document.referrer,t.m=this.standout.device.mobile,t.dT=this.standout.device.deviceType,t.mobile=this.standout.device.mobile,t.rid=this.standout.session.pageViewId,t.now=(new Date).getTime(),t.cmp=this.standout.page.hasCMP(),t.cmpus=this.standout.page.hasUSCMP(),t.atc=this.standout.page.checkATC(),this.standout.communications.post(e.apiDom+"v2/request/css",t,(t=>{if(this.requesting=0,""==t||"TIMEOUT"==t);else{const i=JSON.parse(t);"siteId"in i&&(this.siteId=i.siteId,this.standout.logger.SDTLog(60,null,{siteId:this.siteId})),"kmId"in i&&(this.kmPid=i.kmId),"kmPubId"in i&&(this.kmPub=i.kmPubId),"scriptSettings"in i&&this.processScriptSettings(i.scriptSettings,i),"hnW"in i&&i.hnW.length>0&&this.standout.getProductByType(e.ProductType.SocialCanvas).processHNWidgets(i.hnW),"iu"in i&&this.processUM(i.iu)}}))}}class H{constructor(e){this.mobile=0,this.deviceType=2,this.ua=((navigator||{}).userAgent||"").toLowerCase(),this.standout=e,this.deviceCategory=this.getDeviceCategory(),this.standout.logger.SDTLog(14,this.deviceCategory),(window.matchMedia("only screen and (max-width: 767px)").matches||"phone"==this.deviceCategory||"tablet"==this.deviceCategory)&&(this.mobile=1,this.standout.logger.SDTLog(15)),"phone"==this.deviceCategory?this.deviceType=4:"tablet"==this.deviceCategory?this.deviceType=5:"desktop"==this.deviceCategory&&(this.deviceType=2)}activate(){}getDeviceCategory(){let e=navigator.userAgent;return e.match(/iPad/i)||e.match(/tablet/i)&&!e.match(/RX-34/i)||e.match(/FOLIO/i)||e.match(/Linux/i)&&e.match(/Android/i)&&!e.match(/Fennec|mobi|HTC.Magic|HTCX06HT|Nexus.One|SC-02B|fone.945/i)||e.match(/Kindle/i)||e.match(/Mac.OS/i)&&e.match(/Silk/i)?"tablet":e.match(/Opera/i)&&e.match(/Windows.NT.5/i)&&e.match(/HTC|Xda|Mini|Vario|SAMSUNG-GT-i8000|SAMSUNG-SGH-i9/i)?"phone":e.match(/Windows.(NT|XP|ME|9)/)&&!e.match(/Phone/i)||e.match(/Win(9|.9|NT)/i)||e.match(/Macintosh|PowerPC/i)&&!e.match(/Silk/i)||e.match(/Linux/i)&&e.match(/X11/i)||e.match(/Solaris|SunOS|BSD/i)||e.match(/Bot|Crawler|Spider|Yahoo|ia_archiver|Covario-IDS|findlinks|DataparkSearch|larbin|Mediapartners-Google|NG-Search|Snappy|Teoma|Jeeves|TinEye/i)&&!e.match(/Mobile/i)?"desktop":"phone"}isSafariVC(){return/SafariViewService/.test(navigator.userAgent)}}class W{constructor(e){this.kargoPresent=0,this.btoPresent=0,this.kargoDemoSite=0,this.kargoDevDemoSite=0,this.standout=e,this.kargoDemoSite=this.standout.settings.qsBool("kso_demosite")||q(["demo.kargo.com","demo.dev.kargo.com"]),this.kargoDevDemoSite=this.standout.settings.qsBool("kso_devsite")||q(["demo.dev.kargo.com"])}getPageDataFor(e){const t={url:window.location.href,pageTitle:document.title},i=u(e,"section[data-permalink]");return i&&i.dataset&&(i.dataset.permalink&&(t.url=i.dataset.permalink),i.dataset.title&&(t.pageTitle=i.dataset.title)),t}hasCMP(){try{return"function"==typeof window.top.__cmp||"function"==typeof window.top.__tcfapi||"function"==typeof window.__cmp||"object"==typeof window.__cmp||"function"==typeof window.CMP||"object"==typeof window.CMP||"object"==typeof window.Cookiebot||"object"==typeof window.__cmpArg||"function"==typeof window.__cmpCall||"object"==typeof window.cmp}catch(e){}return 0}hasGPPCMP(){try{return"function"==typeof window.__gpp||"object"==typeof window.__gpp}catch(e){}return 0}shimGPP(){if(window.__gpp||!window.__tcfapi)return;window.__gpp=(e,t)=>{"getGPPData"===e?t({gppString:"",applicableSections:[2]}):"getSection"===e?window.__tcfapi("getTCData",2,(e=>{t(e)})):t(null)};const e=document.createElement("iframe");e.style.display="none",e.name="__gppLocator",document.body.appendChild(e)}hasTCFCMP(){try{return"function"==typeof window.__tcfapi}catch(e){}return 0}hasUSCMP(){try{return"function"==typeof window.__uspapi||"function"==typeof window.__uspcmp}catch(e){}return 0}checkKargoPresent(){if(this.kargoPresent)return 1;const e=this.readCRB();return e&&e.pageViewUrl&&e.pageViewUrl==window.location.href?(this.kargoPresent=1,this.standout.logger.recordLogEvent("detected-kargo",{crbData:e}),1):(this.kargoPresent=0,0)}checkForBTO(){const e=this.readCRB();return e&&e.pageViewId?(this.standout.logger.recordLogEvent("detected-bto",{crbData:e}),this.btoPresent=1,1):(this.btoPresent=0,0)}readCRB(){let e=this.getCookie("krg_crb");if(e){e=decodeURIComponent(e);const t=JSON.parse(e);if(t&&t.v){const e=atob(t.v);if(e){const t=JSON.parse(e);if(t)return t}}}return null}getCookie(e){return(document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)")||[]).pop()||""}checkATC(){const e=document.querySelectorAll("script");let t=0,i=0;for(let s=0;s<e.length;s++){const n=e[s];n.src&&n.src.includes("/rh.min.js")&&("kso-atc"==n.id?i=1:t=1)}return i&&!t}collapseLoadingContainers(){document.body.querySelectorAll("iframe:not([src])").forEach((e=>{if(e instanceof HTMLIFrameElement)try{const t=e.contentDocument||(e.contentWindow?e.contentWindow.document:null);if(t&&t.body&&t.body.innerHTML.includes("createElement")&&t.body.innerHTML.includes("socialcanvas-cdn.kargo.com/js/rh.min.js")){const t=u(e,'.mobile-incontent-social,div[data-ad=mobile-incontent-social],div[id^="div-gpt-ad-"],div[class^="kargoad-"],#pw-oop-flex_container');t&&(t.style.display="none")}}catch(e){this.standout.logger.log("Error collapsing loading container",e)}}))}}class U{constructor(e){this.recordedLogEvents=[],this.standout=e,window.krg_so.kso_log=this.SDTLogExternal}log(...e){if(this.standout.settings.debugMode>0){const t=Array.from(e);1==this.standout.settings.debugMode?(t.unshift("background-color:gray;color:white;border-radius:4px;padding:1px 4px;opacity:0.7;"),t.unshift("background-color:purple;color:white;border-radius:4px;padding:1px 4px;margin-right:3px;"),t.unshift("%cStandout%c"+(new Date).getTime())):t.unshift("Standout ("+(new Date).getTime()+"):"),console.log.apply(console,t)}}recordLogEvent(e,t,i){let s=i||{};s.sid=this.standout.serverSettings.siteId,s.en=e,s.ed=t,this.standout.communications.postKSO("rlg/ev",s)}recordLogEventOnce(e,t,i){this.recordedLogEvents.includes(e)||(this.recordedLogEvents.push(e),this.recordLogEvent(e,t,i))}recordRequest(e,t,i,s){}SDTLog(e,t=null,i=null){const s={status:e,time:new Date,timeline:document.timeline.currentTime,data:t,object:i};this.SDTLogAddEntry(s)}SDTLogExternal(t,i,s=null,n=null,o=0){const a={entry:t,time:new Date,timeline:document.timeline.currentTime,data:s,object:n,entryType:o,source:i||"External"};if(i){a.source=i;const s=this.standout.getProductByType(e.ProductType.Spotlight);s&&"KargoPlayer"==i&&"transitionToFloat"==t&&s.showingMasthead&&s.checkMastheadScrollPosition(null,1)}else a.source="External";this.SDTLogAddEntry(a)}SDTLogAddEntry(e){document&&document.body&&(document.body.vjcgyzet||(document.body.vjcgyzet=[]),document.body.vjcgyzet.push(e),document.body.sbypvt&&document.body.sbypvt(e))}SDTLogAddEmbedDetails(e,t){t||(t={}),document.body.msqryxdy||(document.body.msqryxdy={});let i=document.body.msqryxdy[e];i||(i={}),i=Object.assign(i,t),document.body.msqryxdy[e]=i,document.body.obiofe&&document.body.obiofe(e,i)}timeBetween(e,t){return window.krg_so||(window.krg_so={}),window.krg_so[e]&&window.krg_so[t]?Number(window.krg_so[t])-Number(window.krg_so[e]):0}timeFor(e){return(window.krg_so||{})[e]||null}markTime(e){window.krg_so||(window.krg_so={}),document.timeline&&document.timeline.currentTime?window.krg_so[e]=document.timeline.currentTime:window.krg_so[e]=(new Date).getTime()}getExecutionTime(){return document.timeline&&document.timeline.currentTime?Number(document.timeline.currentTime)-Number(window.krg_so.kso_load):(new Date).getTime()-window.krg_so.kso_load}}class j{constructor(e){this.standout=e}x(){if("rollbar"in window.top){var e;const t=document.createElement("iframe");if(document.documentElement.appendChild(t),null!=(e=t.contentWindow)&&e.XMLHttpRequest)return new t.contentWindow.XMLHttpRequest}if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;const t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"];let i;for(let e=0;e<t.length;e++)try{i=new ActiveXObject(t[e]);break}catch(e){}return i}overrideHttp(){var e,t,i;if(window.location.hostname.includes("thehill.com"))return;const s=document.createElement("iframe");document.documentElement.appendChild(s);const n=null==(e=s.contentWindow)?void 0:e.XMLHttpRequest.prototype.send,o=null==(t=s.contentWindow)?void 0:t.XMLHttpRequest.prototype.open;null==(i=s.parentNode||s.parentElement)||i.removeChild(s),window.XMLHttpRequest.prototype.send=n,window.XMLHttpRequest.prototype.open=o}send(e,t,i,s,n,o){void 0===n&&(n=1);const a=this.x();if(!a)return;a.open(i,e,n),o&&(a.withCredentials=1),a.onreadystatechange=()=>{4==a.readyState&&(clearTimeout(l),t(a.responseText))},"POST"==i&&a.setRequestHeader("Content-type","application/json"),a.send(s);const l=setTimeout((()=>{a.abort(),t("TIMEOUT")}),6e3)}get(e,t,i,s,n){const o=[];for(const e in t)o.push(encodeURIComponent(e)+"="+encodeURIComponent(t[e]));this.send(e+(o.length?"?"+o.join("&"):""),i,"GET",null,s,n)}post(e,t,i,s,n){t.t_n=this.standout.logger.getExecutionTime(),this.send(e,i,"POST",JSON.stringify(t),s,n)}postKSO(t,i,s){let n=i;this.standout.serverSettings.overrideSiteId&&(n.osid=this.standout.serverSettings.overrideSiteId),n.v=this.standout.version,n.rid=this.standout.session.pageViewId,n.sid=this.standout.serverSettings.siteId,n.ses=this.standout.session.sessionId,n.u=window.location.href,n.h=window.location.hostname,n.kmPid=this.standout.serverSettings.kmPid,n.kmPub=this.standout.serverSettings.kmPub,n.m=this.standout.device.mobile,n.mobile=this.standout.device.mobile,n.dT=this.standout.device.deviceType,n.atc=this.standout.page.checkATC(),n.prelig=this.standout.getProductEligiblityObj(),this.post(e.apiDom+"v2/"+t,n,(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);this.standout.serverSettings.processServerSettings(t)}catch(e){}s&&s(e)}))}sendUnloadBeacon(){const t=new Blob([JSON.stringify({sid:this.standout.serverSettings.siteId,rid:this.standout.session.pageViewId,rea:"beforeunload"})],{type:"application/json"});navigator.sendBeacon(e.apiDom+"v2/request/unl",t)}}class z{constructor(e){this.preloadedImages=[],this.standout=e}generateCeltraTag(e){const t=`\n<div class="celtra-ad-v3">\x3c!-- eas.JWVjaWQh         = raw %ecid! --\x3e\x3c!-- externalCreativeId   = raw %ecid! --\x3e\x3c!-- externalPlacementId  = raw %epid! --\x3e\x3c!-- externalSiteId       = raw %esid! --\x3e\x3c!-- externalSiteName     = raw %%SITE%% --\x3e\x3c!-- externalLineItemId   = raw %eaid! --\x3e\x3c!-- externalCampaignId   = raw %ebuy! --\x3e\x3c!-- externalAdvertiserId = raw %eadv! --\x3e\x3c!-- coppa                = raw %%TFCD%% --\x3e\x3c!-- externalCreativeSize = raw %%WIDTH%%x%%HEIGHT%% --\x3e\n  <img src="data:image/png,celtra" style="display: none" onerror="(function(img) {\n    var params = {'clickUrl':'%%CLICK_URL_UNESC%%','widthBreakpoint':'','expandDirection':'undefined','preferredClickThroughWindow':'new','clickEvent':'advertiser','iosAdvId':'%%ADVERTISING_IDENTIFIER_PLAIN%%','androidAdvId':'%%ADVERTISING_IDENTIFIER_PLAIN%%','externalAdServer':'GoogleAdManager','tagVersion':'html-standard-7'};\n    [].slice.apply(img.parentNode.childNodes).forEach(function(n) { var decfs = { urldecode: decodeURIComponent, htmldecode: function(v) { var d = document.createElement('div'); d.innerHTML = v; return d.textContent; }, eval: function(v) { return eval(v); }, raw: function(v) { return v; } }; var m; if (n.nodeType == 8 &amp;&amp; (m = n.textContent.match(/^&#92;s+([&#92;w%.]+)(&#92;[.+&#92;])?&#92;s+=&#92;s+(&#92;w+)&#92;s+(.*)$/i))) { try { params[m[1]+(m[2] || '')] = decfs[m[3]](m[4].replace(/^&#92;s+|&#92;s+$/g, '')); } catch (e) {} } });\n    var req = document.createElement('script');\n    req.id = params.scriptId = 'celtra-script-' + (window.celtraScriptIndex = (window.celtraScriptIndex||0)+1);\n    params.clientTimestamp = new Date/1000;\n    params.clientTimeZoneOffsetInMinutes = new Date().getTimezoneOffset();\n    params.hostPageLoadId=window.celtraHostPageLoadId=window.celtraHostPageLoadId||(Math.random()+'').slice(2);\n    var qs = '';\n    for (var k in params) { qs += '&amp;' + encodeURIComponent(k) + '=' + encodeURIComponent(params[k]); }\n    var src = 'https://ads.celtra.com/${e}/web.js?' + qs;\n    req.src = src;\n    img.parentNode.insertBefore(req, img.nextSibling);\n  })(this);"/>\n</div>`;return this.preloadCeltraAssets(e),t}preloadCeltraAssets(e){if(!e)return;let t=null;e.includes("ads.celtra.com/")?t=r(e,"ads.celtra.com/","/web.js"):8==e.length&&(t=e)}isIvo(e){return(e||"").includes("servedbyivo.com")||(e||"").includes("data-ivo-format")}listenForGAMSizing(){}sizeGAMUnit(e,t){if(!e||!t)return;const i=e.parentElement;if(!i||!i.parentElement)return;const s=t.split("x");if(2!==s.length)return;const n=parseInt(s[0],10)||0,o=parseInt(s[1],10)||0;let a=1;const l=i.parentElement.clientWidth||0;n>l&&l>0&&(a=l/n,e.style.transformOrigin="left top",e.style.transform="scale("+a+")",e.style.width=n+"px",e.style.maxWidth=n+"px",i.style.height=o*a+"px",i.style.width=n*a+"px")}renderOpenAd(e,t){var i;const s=null==(i=window.scpbjs)||null==i.getBidResponses?void 0:i.getBidResponses();if(!s)return;let n=null;const o=(s[null==t?void 0:t.auctionId]||{}).bids||[];for(let e=0;e<o.length;e++){var a;if((null==(a=o[e])?void 0:a.adId)==(null==t?void 0:t.aId)){n=o[e];break}}if(!n)return;const l=document.createElement("iframe");l.style.cssText="overflow:hidden;border:none;margin:0 0;box-shadow:none;",l.style.width=(n.width||0)+"px",l.style.height=(n.height||0)+"px",e.appendChild(l);const r=l.contentWindow;r&&(r.document.open(),r.document.write(n.ad||""),r.document.close(),r.document.documentElement&&(r.document.documentElement.style.overflow="hidden"),r.document.body&&(r.document.body.style.margin="0 0",r.document.body.style.padding="0 0"),l.dataset.height=(n.height||0)+"px",l.dataset.width=(n.width||0)+"px",this.watchForHeavyAd(l,n))}watchForHeavyAd(e,t){if(!e)return;if(e.dataset.haWatch)return;e.dataset.haWatch="1";const i=performance.now();window.addEventListener("message",(s=>{if(s.source===e.contentWindow&&s.data&&"heavy-ad-intervention"===s.data.type){const e=s.data.report;this.standout.logger.log("Heavy Ad Intervention detected",e);const n={tti:Math.round(performance.now()-i)};t&&(n.bid={adId:t.adId,auctionId:t.auctionId,bidder:t.bidder,bidderCode:t.bidderCode,cpm:t.cpm,creative_id:t.creativeId,size:t.size,width:t.width,height:t.height,mediaType:t.mediaType,format:t.format,execution:t.execution,creativeId:t.creativeId,lineItemId:t.lineItemId}),this.standout.logger.recordLogEventOnce("heavy-ad-intervention",n),e&&e.body&&this.standout.logger.log("Heavy Ad removed: "+(e.body.message||"Unknown reason"))}}));const s=()=>{let t=0;try{e.contentDocument&&(t=1,this.injectHeavyAdMonitor(e))}catch(e){this.standout.logger.log("Cannot inject heavy ad monitor into cross-origin iframe")}};e.contentDocument&&"complete"===e.contentDocument.readyState&&s(),e.addEventListener("load",(()=>{setTimeout((()=>{s()}),0)}))}injectHeavyAdMonitor(e){try{const t=e.contentDocument;if(!t)return;const i=t.createElement("script");i.textContent="\n        (function() {\n          // Only set up if ReportingObserver is supported\n          if (!window.ReportingObserver) {\n            return;\n          }\n\n          let interventionDetected = false;\n\n          // Callback to handle intervention reports\n          function sendReports(reports) {\n            for (let report of reports) {\n              // Check if this is a heavy ad intervention\n              if (report.type === 'intervention' && \n                  report.body && \n                  report.body.id === 'HeavyAdIntervention') {\n                \n                interventionDetected = true;\n                \n                const reportData = {\n                  type: 'heavy-ad-intervention',\n                  report: {\n                    type: report.type,\n                    url: report.url,\n                    body: {\n                      id: report.body.id,\n                      message: report.body.message,\n                      sourceFile: report.body.sourceFile,\n                      lineNumber: report.body.lineNumber,\n                      columnNumber: report.body.columnNumber\n                    }\n                  }\n                };\n                \n                // Try postMessage immediately\n                try {\n                  window.parent.postMessage(reportData, '*');\n                } catch (e) {\n                  // postMessage might fail if parent is gone\n                }\n              }\n            }\n          }\n\n          // Create the ReportingObserver\n          const observer = new ReportingObserver(\n            (reports, observer) => {\n              sendReports(reports);\n            },\n            { buffered: true }\n          );\n\n          // Start watching for interventions\n          observer.observe();\n\n          // Set up pagehide event as a failsafe to catch reports before unload\n          // This fires BEFORE the frame is removed, giving us the best chance\n          window.addEventListener('pagehide', (event) => {\n            // Pull all pending reports from the queue\n            let reports = observer.takeRecords();\n            sendReports(reports);\n            \n            // Additional synchronous attempt to send if we detected an intervention\n            if (interventionDetected) {\n              try {\n                window.parent.postMessage({\n                  type: 'heavy-ad-intervention',\n                  timestamp: Date.now()\n                }, '*');\n              } catch (e) {}\n            }\n          }, { capture: true });\n          \n          // Also try on visibilitychange as another fallback\n          document.addEventListener('visibilitychange', () => {\n            if (document.visibilityState === 'hidden') {\n              let reports = observer.takeRecords();\n              if (reports.length > 0) {\n                sendReports(reports);\n              }\n            }\n          });\n        })();\n      ",t.head?t.head.insertBefore(i,t.head.firstChild):t.body?t.body.insertBefore(i,t.body.firstChild):t.appendChild(i)}catch(e){this.standout.logger.log("Error injecting heavy ad monitor",e)}}}function G(){return G=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},G.apply(null,arguments)}class V{constructor(e){this.pbEnabled=1,this.minFloor=.25,this.doPBMock=0,this.pbRequests={},this.gptDemo=0,this.gptRequestedSlotIds=new Set,this.girEnabled=0,this.girCpmBuckets=[{max:.1,roundTo:.01},{max:5,roundTo:.05},{max:20,roundTo:.1},{max:100,roundTo:.5}],this.girAdUnitAutogenerate=0,this.girDemoCpm=1,this.girShowIframe=0,this.girUseIframe=1,this.reportedFill=0,this.adSlotFill=0,this.pbSBRKey=null,this.persistentMode=0,this.pbDebug=0,this.pbDisableEXP=0,this.allowedBidders=[],this.pbBidDemo=null,this.pbBidDemoResults=null,this.pbKrkDebug=0,this.usePublisherPrebid="",this.forcePublisherPrebid=null,this.prebidScriptRequested=0,this.pbBidForceProduct=null,this.persistentRebid=0,this.forceGam=0,this.deferForViewability=0,this.usePublisherAuction="",this.publisherAuctionListeners=new Map,this.overrideTargetSegments=[],this.winningTargetIds=[],this.productDefs={},this.bidderDefs={},this.disablePBRetry=0,this.maxRetryCount=1,this.passbackRendered=0,this.standout=e}activate(){this.standout.settings.disableAdRendering||q(["time.com/"])||(this.loadSettings(),this.standout.listeners.subscribeToEvent("message",0,(e=>this.receiveMessage(e))),q(["si.com"],1)&&(this.maxRetryCount=3))}loadSettings(){var e;const t=this.standout.settings;if(this.pbSBRKey=t.qsGet("kso_sbr"),this.persistentMode=t.qsGet("rhpersist")?1:0,this.pbDebug=t.qsGet("kso_pbdebug")?1:0,this.pbDisableEXP=t.qsGet("kso_pbdisableexp")?1:0,this.allowedBidders=(null==(e=t.qsGet("kso_bidders"))?void 0:e.split(","))||[],this.gptDemo=t.qsGet("kso_gptdemo")?1:0,this.girEnabled=t.qsBool("kso_rapt_gamtest")||t.qsBool("kso_gir_test"),this.girAdUnit=t.qsGet("kso_gir_adunit")||this.girAdUnit,this.girDemoCpm=t.qsGet("kso_gir_cpm"),this.girShowIframe=t.qsBool("kso_gir_showframe"),this.girUseIframe=t.qsBool("kso_gir_useframe"),this.pbKrkDebug=t.qsBool("kso_krkdebug"),this.pbBidDemo=t.qsGet("kso_biddemo"),this.doPBMock=t.qsBool("rhpbmock"),this.persistentRebid=t.qsBool("rhrebid"),t.qsHas("kso_usepubpb")){const e=this.normalizePrebidNamespace(t.qsGet("kso_usepubpb"));this.forcePublisherPrebid=e,this.usePublisherPrebid=e}else this.forcePublisherPrebid=null,this.usePublisherPrebid="";t.qsHas("kso_forcebid")&&(this.pbBidForceProduct=t.qsGet("kso_forcebid"))}loadServerSettings(e){var t,i;this.productDefs=e.prdef||{},this.bidderDefs=e.bdef||{};const s=this.normalizePrebidNamespace(null==e||null==(t=e.bdef)||null==(t=t.display)||null==(t=t.prebid)?void 0:t.usePubPB);if(this.usePublisherPrebid=this.forcePublisherPrebid||s,null!=e&&null!=(i=e.bdef)&&null!=(i=i.display)&&null!=(i=i.prebid)&&i.usePublisherAuction&&(this.usePublisherAuction=this.normalizePrebidNamespace(e.bdef.display.prebid.usePublisherAuction),this.standout.logger.log("Publisher auction enabled, using namespace:",this.usePublisherAuction)),this.maybeLoadKargoPrebidScript(),e.bdef&&e.bdef.passbackSnippet&&(this.passbackSnippet=e.bdef.passbackSnippet),e.prdef&&e.prdef.gir&&e.prdef.gir.enabled){if(this.girEnabled=1,e.prdef.gir.adUnit&&(this.girAdUnit=e.prdef.gir.adUnit),e.prdef.gir.autogenerate&&(this.girAdUnitAutogenerate=1),e.prdef.gir.adUnitBase&&(this.girAdUnitBase=e.prdef.gir.adUnitBase),e.prdef.gir.mapping&&e.prdef.gir.mapping.length>0){const t=e.prdef.gir.mapping;for(let e=0;e<t.length;e++){const i=t[e];if(i.domain&&i.adUnit&&(Array.isArray(i.domain)?i.domain:[i.domain]).some((e=>window.location.href.includes(e)))){this.girAdUnit=i.adUnit;break}}}var n,o;e.prdef.gir.cpmBuckets&&(this.girCpmBuckets=e.prdef.gir.cpmBuckets),this.girAdUnitAutogenerate&&!this.girAdUnit&&(null!=(n=window.adthrive)&&null!=(n=n.config)&&null!=(n=n.gam)&&n.account&&(this.girAdUnit="/"+window.adthrive.config.gam.account),this.girAdUnitBase&&(this.girAdUnit=(this.girAdUnit||"")+"/"+this.girAdUnitBase),null!=(o=window.adthrive)&&null!=(o=o.config)&&null!=(o=o.site)&&o.id&&(this.girAdUnit=(this.girAdUnit||"")+"/"+window.adthrive.config.site.id))}e.bidders&&(this.pbBidders=e.bidders),e.floors&&(this.pbFloors=e.floors),e.disablePBRetry&&(this.disablePBRetry=e.disablePBRetry),e.aarc&&Number(e.aarc)>1&&(this.maxRetryCount=Number(e.aarc))}receiveMessage(e){if(e.data.includes&&e.data.includes("adId")&&e.data.includes("Prebid Request")){const s=JSON.parse(e.data).adId,n=Object.keys(this.pbRequests||{});for(let e=0;e<n.length;e++)if(this.pbRequests[n[e]].gamPassedBids&&this.pbRequests[n[e]].gamPassedBids.length)for(let o=0;o<this.pbRequests[n[e]].gamPassedBids.length;o++)if(this.pbRequests[n[e]].gamPassedBids[o].aId==s&&!this.pbRequests[n[e]].gamPassedBids[o].win){this.standout.logger.log("GPT is requesting ad markup from Prebid",s),this.standout.logger.log("Found winning bid"),this.pbRequests[n[e]].gamPassedBids[o].win=1;const a=document.querySelector("#rh-gam-"+this.pbRequests[n[e]].gamPassedBids[o].auctionId);var t,i;return void(a&&a instanceof HTMLElement&&(this.standout.renderer.sizeGAMUnit(a,this.pbRequests[n[e]].gamPassedBids[o].sz),null!=(t=a.parentElement)&&null!=(t=t.parentElement)&&t.parentElement&&this.recordAdImpressionForContainer(null==(i=a.parentElement)||null==(i=i.parentElement)?void 0:i.parentElement,this.pbRequests[n[e]].gamPassedBids[o],this.pbRequests[n[e]].eqObject),this.recordAdFill(this.pbRequests[n[e]].gamPassedBids,this.pbRequests[n[e]].auctionId,this.pbRequests[n[e]].adSlot)))}}}normalizePrebidNamespace(e){if(null==e)return"";const t=(e+"").trim();if(!t)return"";const i=t.toLowerCase();return"false"===i||"0"===i||"scpbjs"===i?"":"true"===i||"1"===i?"pbjs":t}maybeLoadKargoPrebidScript(){this.usePublisherPrebid||this.usePublisherAuction||this.prebidScriptRequested||(d(e.cdnDom+"js/ksopb.js",1,null),this.prebidScriptRequested=1)}getPrebidNamespace(){return this.usePublisherPrebid||"scpbjs"}getPrebid(){const e=this.getPrebidNamespace();return e in window?window[e]:null}getPrebidResponses(){var e;return null==(e=this.getPrebid())?void 0:e.getBidResponses()}cancelSpotlightAuctions(e){const t=e?new Set(e):null,i=[];Object.keys(this.pbRequests||{}).forEach((e=>{var s;const n=this.pbRequests[e];if(!n||"spotlight"!==n.requestType)return;const o=null==(s=n.eqObject)?void 0:s.placement;t&&!t.has(o)||i.push(e)}));const s=this.getPrebid();if(i.length&&s&&"function"==typeof s.removeAdUnit)try{s.removeAdUnit(i)}catch(e){}i.forEach((e=>{delete this.pbRequests[e];const t=this.publisherAuctionListeners.get(e);t&&(clearInterval(t),this.publisherAuctionListeners.delete(e))}))}startPublisherAuctionListener(e,t,i,s){if(!this.usePublisherAuction)return;this.standout.logger.log("Starting publisher auction listener for",s,"with namespace",this.usePublisherAuction);const n=window.setInterval((()=>{const e=window[this.usePublisherAuction];if(!e||"object"!=typeof e.adUnits)return;const t=Array.isArray(e.adUnits)?e.adUnits:[];for(const n of t){if(!n.bids||!Array.isArray(n.bids))continue;if(!n.bids.find((e=>{var t;return"kargo"===e.bidder&&(null==(t=e.params)?void 0:t.placementId)===s})))continue;const t=null==e.getBidResponsesForAdUnitCode?void 0:e.getBidResponsesForAdUnitCode(n.code);if(!t||!t.bids||0===t.bids.length)continue;const o=t.bids.find((e=>"kargo"===e.bidder||"kargo"===e.bidderCode));if(!o||!o.ad)continue;const a=this.publisherAuctionListeners.get(i);a&&(clearInterval(a),this.publisherAuctionListeners.delete(i)),this.standout.logger.log("Found Kargo fill from publisher auction:",o);const l=G({},o,{adUnitCode:i,bidder:"kargo",bidderCode:"kargo"});return void this.handleSCBids({bids:[l],forceWin:1},this.pbRequests[i],i)}}),250);this.publisherAuctionListeners.set(i,n),setTimeout((()=>{this.publisherAuctionListeners.get(i)===n&&(clearInterval(n),this.publisherAuctionListeners.delete(i),this.standout.logger.log("Publisher auction listener timed out for",s),this.pbRequests[i]&&this.pbRequests[i].eqObject.completion(0,{},this.pbRequests[i].eqObject))}),1e4)}runPbjs(t){if(this.usePublisherAuction&&"spotlight"===t.type){this.standout.logger.SDTLog(165);const i=this.standout.session.pageViewId;"targetIds"in t&&(this.winningTargetIds=t.targetIds),this.overrideTargetSegments&&(this.winningTargetIds=this.overrideTargetSegments);const s=(t.adSlot||"").trim();let n="kso_"+i+"_"+t.id,o=n;const a=this.standout.getProductByType(e.ProductType.Spotlight),l=null==a?void 0:a.placements;if(l){if(l[t.placement].auctionTime=new Date,l[t.placement].auctionId){const e=l[t.placement].auctionId.split("_"),i=e[e.length-1];isNaN(i)?e.push(1):e[e.length-1]=parseInt(i)+1,o=e.join("_"),n=o}l[t.placement].auctionId=o,l[t.placement].adSlotId=s}return t.auctionId=o,this.pbRequests[n]={eqObject:t,winningTargetIds:this.winningTargetIds,adSlot:s,requestType:"spotlight",auctionId:o},void this.startPublisherAuctionListener(t,n,o,s)}const i=this.getPrebidNamespace();if(!window[i])return void setTimeout((()=>{this.runPbjs(t)}),100);this.standout.logger.SDTLog(165);const s=this.standout.session.pageViewId,n=this.standout.session.sessionId,o=this.standout.settings.requests,a=this.standout.serverSettings.productsEnabled,l=!!window.rhShowingHN;"targetIds"in t&&(this.winningTargetIds=t.targetIds),this.overrideTargetSegments&&(this.winningTargetIds=this.overrideTargetSegments);let r=null,d=null;if("spotlight"==t.type)d=t.adSlot,r="spotlight";else if(l){if(!(a.hn&&o[s].slotIds.hn&&o[s].slotIds.hn.length))return void t.completion(0,{},t);{const e=o[s].slotIds.hn;d=e.shift(),o[s].slotIds.hn=e,r="hn"}}else{if(!(a.sc&&o[s].slotIds.s&&o[s].slotIds.s.length))return void t.completion(0,{},t);{const e=o[s].slotIds.s;d=e.shift(),o[s].slotIds.s=e,r="sc"}}if("spotlight"!=r)for(let e=0;e<Object.keys(o[s].slotIds).length;e++)if("mobile"==o[s].slotIds[Object.keys(o[s].slotIds)[e]]){d=Object.keys(o[s].slotIds)[e];break}d=(d||"").trim();let h="kso_"+s+"_"+t.id,c=h;if("spotlight"==r){const i=this.standout.getProductByType(e.ProductType.Spotlight),s=null==i?void 0:i.placements;if(!s)return;if(s[t.placement].auctionTime=new Date,s[t.placement].auctionId){const e=s[t.placement].auctionId.split("_"),i=e[e.length-1];isNaN(i)?e.push(1):e[e.length-1]=parseInt(i)+1,c=e.join("_"),h=c}s[t.placement].auctionId=c,s[t.placement].adSlotId=d}if(t.auctionId=c,this.pbRequests[h]={eqObject:t,winningTargetIds:this.winningTargetIds,adSlot:d,requestType:r,auctionId:c},!this.usePublisherPrebid&&t.amazonAdUnit&&this.runAmazonAuction(t),this.doPBMock){const e=prompt("Enter bid JSON");if(!e)return;const t=JSON.parse(e);return t.adUnitCode=h,void this.bidHandler({auctionId:{bids:[t]}},0,c)}const p=window[i]||{};p.que=p.que||[],p.que.push((()=>{var o;const a=!(null==(o=this.standout.getProductByType(e.ProductType.Spotlight))||!o.forceSpotlight);this.usePublisherPrebid||(p.bidderSettings={standard:{storageAllowed:1},kargo:{storageAllowed:1}});let l,r=null,g=null,m=0;if(t.bidders){for(g=[],m=0;m<t.bidders.length;m++)if("kargo"!=t.bidders[m].bidder&&"gam"!=t.bidders[m].bidder&&(t.bidders[m].enabled||a));else if("kargo"==t.bidders[m].bidder&&(t.bidders[m].enabled||a)){const e=this;g.push({bidder:"kargo",params:{placementId:d,socialCanvas:{ksoPageViewId:s,ksoSessionId:n,segments:this.winningTargetIds,embedURL:t.url},krkDebug:this.pbKrkDebug,nbrCallback(t,i){e.standout.logger.log("No Bid Reason:",t),e.pbRequests[i]&&(e.pbRequests[i].nbr=t),510!=t&&e.standout.logger.recordLogEvent("nbr-response",{nbr:t})}}})}}else g=[{bidder:"kargo",params:{placementId:d,socialCanvas:{ksoPageViewId:s,ksoSessionId:n,segments:this.winningTargetIds,embedURL:t.url}},krkDebug:this.pbKrkDebug,nbrCallback:(e,t)=>{this.standout.logger.log("No Bid Reason:",e),this.pbRequests[t]&&(this.pbRequests[t].nbr=e),510!=e&&this.standout.logger.recordLogEvent("nbr-response",{nbr:e})}}],this.usePublisherPrebid||!this.pbBidders||this.pbDisableEXP||t.retryCount&&!(t.retryCount<this.maxRetryCount)||(g=g.concat(this.pbBidders));for(m=0;m<g.length;m++)if("pubmatic"==g[m].bidder){const e=window;g[m].params.kadpageurl=e.location.protocol+"//kso-request."+e.location.host+e.location.pathname+e.location.search+e.location.hash}l=this.standout.device.mobile?[[300,250],[320,50],[300,50],[300,300],[200,200],[250,250],[336,280],[320,100],[320,250],[300,600]]:[[300,250],[320,50],[300,50],[300,300],[200,200],[250,250],[336,280],[320,100],[320,250],[840,280]],r={code:h,ortb2Imp:{ext:{gpid:"/kargo/"+d+"/"+t.id}},mediaTypes:{banner:{sizes:l}},auctionId:c,bids:g},this.pbFloors?(!this.pbFloors.banner||this.pbFloors.banner<this.minFloor)&&(this.pbFloors.banner=this.minFloor):this.pbFloors={video:this.minFloor,banner:this.minFloor},this.pbFloors&&(r.floors={currency:"USD",schema:{fields:["mediaType"]},values:this.pbFloors});const u=[];for(let e=0;e<g.length;e++)u.push(g[e].bidder);if(!this.usePublisherPrebid&&t.bidders&&!u.includes("gam"))for(let e=0;e<t.bidders.length;e++)"gam"==t.bidders[e].bidder&&t.bidders[e].enabled&&u.push("gam");if(!this.usePublisherPrebid&&t.bidders&&!u.includes("amazon"))for(let e=0;e<t.bidders.length;e++)"amazon"==t.bidders[e].bidder&&t.bidders[e].enabled&&u.push("amazon");this.standout.logger.SDTLog(166,null,r),p.addAdUnits([r]);let b=null;if(this.usePublisherPrebid?this.standout.logger.SDTLog(167,null,{namespace:i,setConfigSkipped:1}):(b={debug:this.pbDebug,deviceAccess:1,enableTIDs:1,floors:{},userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"}},userIds:[{name:"33acrossId",params:{pid:"0010b00002EFnxPAAT"}},{name:"id5Id",params:{partner:562}},{name:"unifiedId",params:{partner:"vu6qg20"},storage:{name:"pbjs-unifiedid",type:"html5",expires:60}},{name:"sharedId",storage:{name:"sharedId",type:"cookie&html5",expires:365,refreshInSeconds:28800}}]}},this.standout.settings.debugMode&&(b.debug=1),this.standout.page.hasGPPCMP()&&(b.consentManagement={gpp:{cmpApi:"iab",timeout:4e3}}),this.standout.page.hasTCFCMP()&&(b.consentManagement||(b.consentManagement={}),b.consentManagement.tcf={cmpApi:"iab",timeout:1e4,defaultGdprScope:0},b.tcfControl={enabled:1,rules:[{purpose:"basicAds",enforcePurpose:1,enforceVendor:1,vendorExceptions:[]}]}),this.standout.logger.SDTLog(167,null,b),p.setConfig(b)),this.pbBidDemo)if(this.pbBidDemoResults&&this.pbBidDemoResults.response){const e=this.pbBidDemoResults.response;e.bidder="kargo",e.adUnitCode=c,e.ad=e.adm,this.handleSCBids({forceWin:1,bids:[e]},this.pbRequests[c],c)}else this.requestPbBidDemo(this.pbBidDemo,(e=>{if(e&&e.response){const t=e.response;t.bidder="kargo",t.adUnitCode=c,t.ad=t.adm,this.handleSCBids({forceWin:1,bids:[t]},this.pbRequests[c],c)}else this.standout.logger.log("No response from Pb Bid call",e)}));else this.pbRequests[c].pbConfig={adUnit:r,config:b},this.recordAdRequest({ads:d,auId:c,b:u,cid:"pb",eu:t.canonicalEmbedUrl,et:t.embedType}),this.standout.logger.SDTLog(168,c),g.length?(p.requestBids({adUnitCodes:[h],bidsBackHandler:this.bidHandler.bind(this),timeout:3e3,auctionId:c}),setTimeout((()=>{this.verifyPrebidReturned(c)}),7200)):this.bidHandler({},0,c)}))}bidHandler(t,i,s){if(!t&&!s&&!this.pbSBRKey)return;const n=this.pbRequests[s];if(this.pbRequests[s].auctionCompleted=1,this.pbSBRKey)this.standout.communications.post((e.apiDom||"")+"v2/demo/sbr",{key:this.pbSBRKey},(e=>{if(""==e||"TIMEOUT"==e);else{const t=JSON.parse(e);if(t&&t.bidJson){const e=JSON.parse(t.bidJson);e&&(e.adUnitCode=s,this.handleSCBids({bids:[e]},n,s))}}}));else if(t&&Object.keys(t).length)t[s]&&(this.standout.logger.SDTLog(169,t[s].bids.length+" bids",{pbRequest:n,auctionId:s}),this.handleSCBids(t[s],n,s));else if(this.pbBidForceProduct&&this.productFromAuctionId(s))t[s]={bids:[]},this.handleSCBids(t[s],n,s);else{if(this.standout.logger.SDTLog(170,s,{timedOut:i}),!this.disablePBRetry&&(!this.pbRequests[s].eqObject.retryCount||this.pbRequests[s].eqObject.retryCount<this.maxRetryCount))return this.pbRequests[s].eqObject.retryCount=1,void setTimeout((()=>{this.runPbjs(this.pbRequests[s].eqObject)}),4e3);if(!this.usePublisherPrebid&&this.pbRequests[s].eqObject.bidders)for(let e=0;e<this.pbRequests[s].eqObject.bidders.length;e++)if("gam"==this.pbRequests[s].eqObject.bidders[e].bidder)return void this.handoffToGAM(null,s,this.pbRequests[s].eqObject.bidders[e],this.pbRequests[s].eqObject.id);this.persistentRebid&&setTimeout((()=>{const e="kso_"+this.standout.session.pageViewId+"_"+Date.now(),t=this.getPrebid()||{};"function"==typeof t.requestBids&&t.requestBids({bidsBackHandler:this.bidHandler.bind(this),timeout:3e3,auctionId:e})}),2e3);const e=this.pbRequests[s];"spotlight"==e.requestType&&this.standout.logger.recordLogEvent("pb-no-fill",{slot:e.adSlot,aId:s,to:i,nbr:e.nbr}),this.pbRequests[s].eqObject.completion(0,{},this.pbRequests[s].eqObject),setTimeout((()=>{this.renderPassbackSnippet()}),500)}}handleSCBids(e,t,i){let s=null,n=null,o=0;const a=[];this.standout.logger.SDTLog(171,null,e);const l=this.productFromAuctionId(i);if(this.pbBidForceProduct&&l==this.pbBidForceProduct){e.bids=[];const t=prompt("Enter bid JSON");if(t){let s=t;s.trim().startsWith('"')&&(s=s.substring(1,s.length-1),s=s.replace(/(^|[^\\])(\\\\)*\\$/,"$&\\"),s=s.replace(/(^|[^\\])((\\\\)*")/g,"$1\\$2"),s=s.replace(/(?:\\(.))/g,"$1"),s=decodeURIComponent(s));const n=JSON.parse(s);n.bidder="kargo",n.source="forced",n.adm&&!n.ad&&(n.ad=n.adm),n.adUnitCode=i,e.bids.push(n)}e.forceWin=1}for(let t=0;t<e.bids.length;t++){const s=e.bids[t];if(s.status&&"bidRejected"==s.status)continue;let l=0;if(("kargo"==s.bidder&&s.cpm>=this.minFloor&&this.bidderAllowed(s.bidder)||e.forceWin)&&(n=s,l=1,o=999999999),s.cpm>o&&s.cpm>=this.minFloor&&this.bidderAllowed(s.bidder)&&(n=s,l=1,o=s.cpm),this.pbRequests[s.adUnitCode]){const e=s.source;let t=null,o=null,d=null,h=null,c=null,p=null,g=s.creativeId||s.creativeID,m=null,u=null,b=null,y=null,f=s.dealId;const v=s.mediaType;let w=null;try{if(s.ad&&s.ad.includes("w.Kargo.ads.push(")&&s.ad.includes("kraken:")){let e=r(s.ad,"w.Kargo.ads.push(");if(e=r(e,"kraken:","})"),c=JSON.parse(e),t=c.auction_type,"open"==t&&c.size&&"string"==typeof c.size&&c.size.includes("x")){const e=c.size.split("x");s.width=parseInt(e[0]),s.height=parseInt(e[1])}m=c.krg_imp_id;const i=atob(c.adm);if(i.includes('krg_ad_info":')){const e=JSON.parse(r(i,'krg_ad_info":',"--\x3e")||"{}");o=e.creativeId,d=e.format,h=e.execution,p=(e.asdata||{}).linid,g=e.creativeId}else d=c.ad_format_id,i.includes('execution":"')&&(h=r(i,'execution":"','"')),g=c.id&&c.id.includes("KM-CREA-")?c.id.split("KM-CREA-")[1]:c.id;u=c.scylla_impression_id,b=c.scylla_seat_bid_id,y="ad_format_id"in c?c.ad_format_id:c.ad_format,w=(c.ext||{}).response_type,c.deal_id&&(f=c.deal_id)}else"kargo"!=s.bidderCode&&(t="exp")}catch(e){}l&&(n.auctionType=t,n.source=e,n.kadId=o,n.format=d,n.execution=h,n.kData=c,n.creativeId=g,n.lineItemId=p,n.kBid=m,n.dId=f,n.kScImp=u,n.kScSeat=b,n.cfId=y,n.mT=v,n.rT=w),a.push({ads:this.pbRequests[s.adUnitCode].adSlot,cid:"pb",eu:this.pbRequests[s.adUnitCode].eqObject.canonicalEmbedUrl,et:this.pbRequests[s.adUnitCode].eqObject.embedType,fs:s.bidderCode,aId:s.adId||o,cpm:s.cpm,cId:g,lId:p,dId:f,src:e,sz:s.size,kId:o,aTy:t,cf:d,ce:h,auctionId:i,kBid:m,kScImp:u,kScSeat:b,cfId:y,mT:v,rT:w})}}const d=e=>{if(this.standout.logger.SDTLog(172,null,e),this.pbRequests[e.adUnitCode]){if(s={targetIds:this.pbRequests[e.adUnitCode].winningTargetIds,rhu:{contents:[{body:e.ad}]},rhl:null,cci:this.pbRequests[e.adUnitCode].eqObject.cci,pb:1,adSlot:this.pbRequests[e.adUnitCode].adSlot,auctionId:i,bid:e,kData:e.kData,aType:e.auctionType},e.kData&&e.kData.adm){const t=atob(e.kData.adm);this.standout.renderer.preloadCeltraAssets(t)}this.adSlotFill=1,this.pbRequests[e.adUnitCode].auctionType&&"direct"==this.pbRequests[e.adUnitCode].auctionType&&(this.deferForViewability=1),e.auctionType&&"direct"==e.auctionType&&(this.deferForViewability=1),this.pbRequests[e.adUnitCode].auctionType=e.auctionType,this.pbRequests[e.adUnitCode].eqObject.completion(1,{decisions:s},this.pbRequests[e.adUnitCode].eqObject)}};if(!this.usePublisherPrebid&&!this.standout.page.checkForBTO()&&(!n||"kargo"!=n.bidderCode||"open"==n.auctionType||this.forceGam)&&!e.forceWin&&!this.pbSBRKey&&this.pbRequests[i].eqObject.bidders)for(let e=0;e<this.pbRequests[i].eqObject.bidders.length;e++)if("gam"==this.pbRequests[i].eqObject.bidders[e].bidder&&this.bidderAllowed("gam"))return this.pbRequests[i].bidsArray=a,n&&(this.pbRequests[i].fallbackWinningBid=n,this.pbRequests[i].fallback=()=>{this.recordAdFill(a,i,t.adSlot),d(this.pbRequests[i].fallbackWinningBid)}),void this.handoffToGAM(a,i,this.pbRequests[i].eqObject.bidders[e],this.pbRequests[i].eqObject.id);if(!n||"kargo"==n.bidder||!this.standout.page.checkForBTO()){if(n)for(let e=0;e<a.length;e++)if(a[e].fs==n.bidderCode&&a[e].aId==n.adId&&a[e].cpm==n.cpm&&a[e].sz==n.size){a[e].win=1;break}n&&d(n),e.forceWin||this.recordAdFill(a,i,t.adSlot)}}bidderAllowed(e){return this.allowedBidders&&0!=this.allowedBidders.length?this.allowedBidders.includes(e)?1:0:1}handoffToGAM(t,i,s,n,o=0){if(this.usePublisherPrebid)return;const a=this.standout.getProductByType(e.ProductType.Spotlight),l=this.standout.getProductByType(e.ProductType.SocialCanvas),r=a.placements,h=window.scpbjs;if(this.pbRequests[i]&&"spotlight"==this.pbRequests[i].requestType&&a&&a.placements[this.pbRequests[i].eqObject.placement].waitingForAPS)return void setTimeout((()=>{this.handoffToGAM(t,i,s,n,o)}),100);let c=null;s&&(c=this.standout.device.mobile?s.mobileAdUnitPath:s.desktopAdUnitPath);let p=null;if(!("googletag"in window))return o||d("https://securepubads.g.doubleclick.net/tag/js/gpt.js",1),void setTimeout((()=>{this.handoffToGAM(t,i,s,n,1)}),100);p=window.googletag;const g=this.pbRequests[i];if(!g)return void this.standout.logger.log("No pbRequest");if(this.pbRequests[i].gamPassedBids=t,r[this.pbRequests[i].eqObject.placement].apsBids){const e=r[this.pbRequests[i].eqObject.placement].apsBids;for(let t=0;t<e.length;t++){const s={};s.ads=r[this.pbRequests[i].eqObject.placement].adSlotId,s.fs="aps",s.auId=i,s.sz=e[t].amznsz,s.src="aps",s.aId=e[t].amzniid,this.pbRequests[i].gamPassedBids||(this.pbRequests[i].gamPassedBids=[]),this.pbRequests[i].gamPassedBids.push(s)}}const m="rh-gam-"+i;g.eqObject.completion(1,{decisions:{targetIds:g.winningTargetIds,rhu:null,rhl:null,pb:1,adSlot:g.adSlot,waitForGam:1,auctionId:i,hasFill:(t||[]).length>0}},g.eqObject),p.cmd.push((()=>{let e;e="ei_overlay"==g.eqObject.id?this.standout.device.mobile?[[300,250],[300,300],[336,280],[320,250],[300,600],[250,250],[320,460],[320,350]]:[[300,250],[300,300],[336,280],[320,250],[300,600],[840,280]]:"ei_masthead"==g.eqObject.id?this.standout.device.mobile?[[300,250],[300,50],[320,50],[300,300],[336,280],[300,100],[320,100],[250,250],[320,460],[320,350],[300,600]]:[[970,250],[970,90],[840,280]]:"ei_inarticle"==g.eqObject.id?this.standout.device.mobile?[[300,250],[300,300],[200,200],[250,250],[336,280],[320,250],[300,600],[320,460],[320,350]]:[[300,250],[300,300],[336,280],[320,250],[300,600],[840,280],[320,460],[320,350]]:this.standout.device.mobile?[[300,250],[320,50],[300,50],[300,300],[200,200],[250,250],[336,280],[320,100],[320,250],[300,600]]:[[300,250],[320,50],[300,50],[300,300],[200,200],[250,250],[336,280],[320,100],[320,250],[840,280]],this.gptDemo&&(c="/6355419/Travel/Europe/France/Paris",e=[[300,250]]),r[g.eqObject.placement].deferredGamSlot&&p.destroySlots([r[g.eqObject.placement].deferredGamSlot]);const t=p.defineSlot((c||"").trim(),e,m).addService(p.pubads());if("spotlight"==this.pbRequests[i].requestType&&r[this.pbRequests[i].eqObject.placement].apsBids&&r[this.pbRequests[i].eqObject.placement].apsBids.length){const e=r[this.pbRequests[i].eqObject.placement].apsBids;this.standout.logger.log("Adding targeting from APS bids");for(let i=0;i<e.length;i++)for(let s=0;s<Object.keys(e[i]).length;s++)Object.keys(e[i])[s].includes("amzn")&&t.setTargeting(Object.keys(e[i])[s],e[i][Object.keys(e[i])[s]])}p.pubads().addEventListener("slotResponseReceived",(e=>{const i=e.slot;i===t&&this.standout.logger.log("Ad response for slot",i.getSlotElementId(),"received.")})),p.pubads().addEventListener("slotRequested",(e=>{const i=e.slot;i===t&&(this.standout.logger.log("GPT slot requested",i.getSlotElementId(),"sent."),this.gptRequestedSlotIds.add(i.getSlotElementId()))})),p.pubads().addEventListener("slotRenderEnded",(e=>{const s=e.slot;if(s===t)if(this.standout.logger.log("GPT render ended for slot",s.getSlotElementId()),e.isEmpty){if(this.standout.logger.log("GPT response empty",s.getSlotElementId()),g.fallbackWinningBid&&g.fallback){r[g.eqObject.placement].waitingForGam=0,r[g.eqObject.placement].gamRendered=0,r[g.eqObject.placement].recordedImpression=0;const e=document.querySelector(`#${m}-sizer`);if(e instanceof HTMLElement&&e.parentElement)e.parentElement.removeChild(e);else{const e=document.querySelector("#"+m);e instanceof HTMLElement&&e.parentElement&&e.parentElement.removeChild(e)}return g.fallback(g.fallbackWinningBid),g.fallback=null,g.fallbackWinningBid=null,"spotlight"==g.requestType&&a&&a.handleGamFallback(g.eqObject.placement),void p.destroySlots([s])}"spotlight"==g.requestType&&this.standout.logger.recordLogEvent("pb-no-fill",{slot:g.adSlot,aId:i,to:0,nbr:g.nbr}),"ei_overlay"==g.eqObject.id?(a.spotlightOverlayAvailable=0,r.overlay.waitingForGam=0,r.overlay.gamRendered=0,window.localStorage.setItem("ksocan-int-lastshown",window.localStorage.getItem("ksocan-int-lastshown-prev")||""),window.localStorage.setItem("ksocan-int-lastshown-0",window.localStorage.getItem("ksocan-int-lastshown-0-prev")||"0"),a.recordSpotlightAvail("overlay",r.overlay.gamTrigger)):"ei_masthead"==g.eqObject.id?(a.spotlightMastheadAvailable=0,r.masthead.waitingForGam=0,r.masthead.gamRendered=0,window.localStorage.setItem("ksocan-int-lastshown",window.localStorage.getItem("ksocan-int-lastshown-prev")||""),window.localStorage.setItem("ksocan-int-lastshown-2",window.localStorage.getItem("ksocan-int-lastshown-2-prev")||"0"),a.recordSpotlightAvail("masthead",r.masthead.gamTrigger)):"ei_inarticle"==g.eqObject.id&&(a.spotlightInarticleAvailable=0,r.inarticle.waitingForGam=0,r.inarticle.gamRendered=0,r.inarticle.container.style.display="none",window.localStorage.setItem("ksocan-int-lastshown",window.localStorage.getItem("ksocan-int-lastshown-prev")||""),window.localStorage.setItem("ksocan-int-lastshown-1",window.localStorage.getItem("ksocan-int-lastshown-1-prev")||"0"),a.recordSpotlightAvail("inarticle",r.inarticle.gamTrigger)),setTimeout((()=>{this.renderPassbackSnippet()}),500)}else{if("ei_overlay"==g.eqObject.id)a.spotlightOverlayAvailable=1,r.overlay.waitingForGam=0,r.overlay.gamRendered=1,e.size&&e.size[0]>1&&e.size[1]>1&&(this.recordAdImpression({ads:g.adSlot,bd:"gam",auId:i}),r.overlay.recordedImpression=1);else if("ei_masthead"==g.eqObject.id)a.spotlightMastheadAvailable=1,r.masthead.waitingForGam=0,r.masthead.gamRendered=1,e.size&&e.size[0]>1&&e.size[1]>1&&(this.recordAdImpression({ads:g.adSlot,bd:"gam",auId:i}),r.masthead.recordedImpression=1);else if("ei_inarticle"==g.eqObject.id)a.spotlightInarticleAvailable=0,r.inarticle.waitingForGam=0,r.inarticle.gamRendered=1,e.size&&e.size[0]>1&&e.size[1]>1&&(a.recordSpotlightAvail("inarticle",r.inarticle.gamTrigger,{f:1}),this.recordAdImpression({ads:g.adSlot,bd:"gam",auId:i}),r.inarticle.recordedImpression=1);else{var n;const e=null==(n=document.querySelector("#"+m))||null==(n=n.parentElement)||null==(n=n.parentElement)?void 0:n.parentElement;e instanceof HTMLElement&&l.readdBorders(e)}if(this.standout.logger.log("GPT ad rendered:",e.companyIds,e.advertiserId,e.labelIds,e.size,e.isBackfill,e.creativeId),(e.slot.getHtml()||"").includes("Prebid Request"))this.standout.logger.log("GPT returned Prebid bid as winner");else{var o;this.pbRequests[i].renderedSize=Array.isArray(e.size)?e.size[0]+"x"+e.size[1]:e.size,(null==(o=document.querySelector("#"+m))?void 0:o.parentElement).dataset.expSize=this.pbRequests[i].renderedSize,this.standout.renderer.sizeGAMUnit(document.querySelector("#"+m),this.pbRequests[i].renderedSize);let t=null;if(this.pbRequests[i].gamPassedBids&&this.pbRequests[i].gamPassedBids.length)for(let e=0;e<this.pbRequests[i].gamPassedBids.length;e++)if(1==this.pbRequests[i].gamPassedBids[e].win){t=this.pbRequests[i].gamPassedBids[e];break}var d;this.pbRequests[i].gamPassedBids||(this.pbRequests[i].gamPassedBids=[]),!t&&e.size&&e.size[0]>1&&e.size[1]>1&&(t={ads:g.adSlot,cid:"gam",eu:g.eqObject.canonicalEmbedUrl,et:g.eqObject.embedType,fs:"gam",aId:e.lineItemId||e.sourceAgnosticLineItemId,cId:e.creativeId||e.sourceAgnosticCreativeId,sz:this.pbRequests[i].renderedSize,aTy:"gam",win:1},this.pbRequests[i].gamPassedBids.push(t),"spotlight"==g.requestType?this.recordAdFill([t],i,this.pbRequests[i].adSlot):(this.recordAdImpressionForContainer(null==(d=document.querySelector("#"+m))||null==(d=d.parentElement)||null==(d=d.parentElement)?void 0:d.parentElement,{fs:"gam",auId:i}),this.recordAdFill(this.pbRequests[i].gamPassedBids,i,this.pbRequests[i].adSlot)))}}})),p.pubads().addEventListener("slotOnload",(e=>{e.slot===t&&(this.standout.logger.log("GPT ad loaded"),setTimeout((()=>{}),300))})),p.enableServices(),h.que.push((()=>{h.setTargetingForGPTAsync([i],(e=>t=>"/22558409563,22849718180/Inquisitr_SocialCanvas"==e.getAdUnitPath()||(e.getAdUnitPath()||"").endsWith("_SocialEmbed")||(e.getAdUnitPath()||"").endsWith("_SocialCanvas")||(e.getAdUnitPath()||"").endsWith("_IntentToClose")||(e.getAdUnitPath()||"")===(c||"")?1:0)),this.initiatePbInterception(),(g.eqObject||{}).amazonAdUnit&&this.initiateApsInterception(),"spotlight"==g.requestType?(r[g.eqObject.placement].deferredGamSlot=t,"overlay"==g.eqObject.placement?a.spotlightOverlayAvailable=1:"masthead"==g.eqObject.placement?a.spotlightMastheadAvailable=1:"inarticle"==g.eqObject.placement&&(a.spotlightInarticleAvailable=1),this.adSlotFill=1,this.pbRequests[i].gamPassedBids&&this.recordAdFill(this.pbRequests[i].gamPassedBids,i,this.pbRequests[i].adSlot)):(p.pubads().refresh([t]),this.standout.logger.recordLogEvent("gtag-refresh",{pl:"socan",gS:t.getAdUnitPath(),auId:i,adS:g.adSlot}))}))}))}initiatePbInterception(){const e=window;if(!e.pbjs||e.ret_ah)return;e.ret_ah=e.pbjs,e.pbjs={};const t=Object.keys(e.ret_ah);for(let i=0;i<t.length;i++)e.pbjs[t[i]]=e.ret_ah[t[i]];const i=this;e.pbjs.renderAd=(e,t,s)=>{i.standout.logger.log("Prebid renderAd");const n=i.pbRequests||{},o=i.standout.renderer.renderOpenAd.bind(i.standout.renderer),a=i.recordAdImpressionForContainer.bind(i),l=i.recordAdFill.bind(i);let r=0;const d=Object.keys(n);for(let s=0;s<d.length;s++){var h;const p=n[d[s]];if(null!=p&&null!=(h=p.gamPassedBids)&&h.length)for(let s=0;s<p.gamPassedBids.length;s++){const n=p.gamPassedBids[s];if(n.aId==t&&!n.win){i.standout.logger.log("Found winning bid"),n.win=1;const t=e.querySelector("#rh-gam-"+n.auctionId);if(t&&t.parentElement){var c;o(t.parentElement,n);const e=null==(c=t.parentElement)||null==(c=c.parentElement)?void 0:c.parentElement;e&&a(e,n,p.eqObject),l(p.gamPassedBids,p.auctionId,p.adSlot)}return void(r=1)}}}r||window.ret_ah.renderAd(e,t,s)}}verifyPrebidReturned(e){const t=this.pbRequests[e];if(!t||t.auctionCompleted)return;const i=this.getPrebid(),s=i&&"function"==typeof i.getEvents?i.getEvents():[];let n=0;for(let e=0;e<s.length;e++)if("auctionDebug"===s[e].eventType&&s[e].args&&s[e].args.arguments&&s[e].args.arguments[0]&&s[e].args.arguments[0].includes("GPP CMP not found Canceling auction")){n=1;break}this.standout.logger.log("Prebid auction did not complete",t),n&&this.standout.logger.log("GPP was not found or failed to return"),this.standout.logger.recordLogEvent("pb-auction-not-completed",{auctionId:e,gppNotFound:n})}recordGoogleTargeting(e,t){}runAmazonAuction(t){if(this.usePublisherPrebid)return;const i=this.standout.getProductByType(e.ProductType.Spotlight);if(!i)return;if(!t.amazonAdUnit)return;const s=i.placements;if(!s)return;s[t.placement].waitingForAPS=1;let n=null;if(!("apstag"in window))return s[t.placement].waitingForAPSStart||(s[t.placement].waitingForAPSStart=(new Date).getTime()),(new Date).getTime()-s[t.placement].waitingForAPSStart>4e3?void(s[t.placement].waitingForAPS=0):void setTimeout((()=>{this.runAmazonAuction(t)}),100);n=window.apstag;let o=[];"overlay"==t.placement?o=this.standout.device.mobile?[[300,250],[300,300],[336,280],[320,250],[300,600],[250,250],[320,460],[320,350]]:[[300,250],[300,300],[336,280],[320,250],[300,600],[840,280]]:"inarticle"==t.placement?o=this.standout.device.mobile?[[300,250],[300,300],[200,200],[250,250],[336,280],[320,250],[300,600],[320,460],[320,350]]:[[300,250],[300,300],[336,280],[320,250],[300,600],[840,280],[320,460],[320,350]]:"masthead"==t.placement&&(o=this.standout.device.mobile?[[300,250],[300,50],[320,50],[300,300],[336,280],[300,100],[320,100],[250,250],[320,460],[320,350],[300,600]]:[[970,250],[970,90],[840,280]]),n.fetchBids({slots:[{slotID:"rh-gam-"+t.auctionId,slotName:t.amazonAdUnit,sizes:o}]},(e=>{this.standout.logger.log("Received APS bids",e),s[t.placement].waitingForAPS?(s[t.placement].waitingForAPS=0,s[t.placement].apsBids=e.filter((e=>e.amzniid&&e.amzniid.length)),window.googletag.cmd.push((()=>{n.setDisplayBids()}))):this.standout.logger.log("Already timed out")})),setTimeout((()=>{s[t.placement].waitingForAPS&&(s[t.placement].waitingForAPS=0)}),3e3)}initiateApsInterception(){const e=window;if(!e.apstag||e.ret_ap)return;e.ret_ap=e.apstag,e.apstag={};const t=Object.keys(e.ret_ap);for(let i=0;i<t.length;i++)e.apstag[t[i]]=e.ret_ap[t[i]];const i=this;e.apstag.renderImp=(e,t,s)=>{i.standout.logger.log("APS renderImp",e,t,s),window.ret_ap.renderImp(e,t,s);const n=window.eiPlacements;for(let s=0;s<3;s++){const a=["inarticle","overlay","masthead"][s];if(!n[a].recordedImpression&&n[a].apsBids&&n[a].apsBids.length)for(let s=0;s<n[a].apsBids.length;s++){const l=n[a].apsBids[s];if(l.amzniid==t){const t={ads:n[a].adSlotId,fs:"aps",auId:n[a].auctionId,sz:l.amznsz,src:"aps",aId:l.amzniid};i.standout.logger.log("Found winning bid"),n[a].recordedImpression=1;const s=e.querySelector("#rh-gam-"+n[a].auctionId);var o;s&&i.recordAdImpressionForContainer(null==(o=s.parentElement)||null==(o=o.parentElement)?void 0:o.parentElement,t);break}}}}}initializeApsTag(e){}requestPbBidDemo(t,i){this.pbBidDemoResults&&this.pbBidDemoResults.waiting?setTimeout((()=>{this.requestPbBidDemo(t,i)}),200):(this.pbBidDemoResults={waiting:1},this.standout.communications.post(e.apiDom+"v2/demo/ast",{demo:t},(e=>{if(""===e||"TIMEOUT"===e)this.pbBidDemoResults=null,i(null);else{try{const t=JSON.parse(e),i=JSON.parse(t.upper||"");this.pbBidDemoResults.waiting=0,this.pbBidDemoResults.response=i}catch(e){this.standout.logger.log("Error parsing response",e),this.pbBidDemoResults=null}i(this.pbBidDemoResults)}})))}recordAdFill(e,t,i){const s={},n=[];for(let t=0;t<e.length;t++){const i=e[t];delete i.auctionId,n.push(i)}s.bids=n,s.cmp=this.standout.page.hasCMP(),s.cmpus=this.standout.page.hasUSCMP(),s.src||(s.src="0"),s.auId=t,s.ads=i,this.standout.communications.postKSO("request/adf",s,(()=>{}))}recordAdRequest(e){const t=e;t.sid=this.standout.serverSettings.siteId||"",t.mobile=this.standout.device.mobile?1:0,t.cmp=this.standout.page.hasCMP(),t.cmpus=this.standout.page.hasUSCMP(),this.standout.logger.SDTLog(51,null,t),this.standout.communications.postKSO("request/adr",t,(()=>{}))}recordPbAdImpression(e,t,i,s){const n={};n.ads=e,n.bd=t.bidderCode,n.cpm=t.cpm,n.sz=t.size,n.cId=t.creativeId,n.dId=t.dealId,n.aId=t.adId||t.aId,n.src=t.source,n.kId=t.kadId,n.aTy=t.auctionType,n.cf=t.format,n.ce=t.execution,n.auId=i,n.kScImp=t.kScImp,n.kScSeat=t.kScSeat,n.cfId=t.cfId,n.mT=t.mT,n.rT=t.rT,this.recordAdImpression(n),this.logExternally("spotlight-impression",{slotType:s,impressionTime:(new Date).getTime(),cpm:t.cpm})}logExternally(t,i){const s=this.standout.getProductByType(e.ProductType.Spotlight);s&&s.logExternally(t,i)}recordAdImpression(t,i){const s=t||{};if(s.sid=this.standout.serverSettings.siteId||"",s.mobile=this.standout.device.mobile?1:0,s.auId){this.addImpressionPerDay(s.auId);const e=this.getImpressionsPerDay(s.auId);let t;s.ed={ipd:e},t=this.productFromAuctionId(s.auId),!this.girEnabled||"overlay"!==t&&"masthead"!==t&&"inarticle"!==t||this.reportGIRImpression(s.auId,s.cpm,s.ads)}this.standout.logger.SDTLog(52,null,s),this.standout.communications.postKSO("request/imp",s,(e=>{i&&i(e)}));const n=this.standout.getProductByType(e.ProductType.SocialCanvas);n&&n.buildViewImage(null,1)}recordAdImpressionForContainer(e,t,i,s){const n=e.getAttribute("data-kas"),o=t||{};!o.ads&&n&&(o.ads=n),o.cid=e.id,i&&(o.eu=i.canonicalEmbedUrl,o.et=i.embedType),this.recordAdImpression(o,s)}reportGIRImpression(e,t,i){this.girEnabled&&this.reportImpressiontoGAM(this.girAdUnit,e,t,i)}reportImpressiontoGAM(e,t,i,s,n=0){if(!e)return;let o,a,l=null;if(this.girUseIframe){if(l=this.getGAMIsolationFrame(),!l)return;if(l.contentDocument)o=l.contentDocument;else{if(!l.contentWindow)return;o=l.contentWindow.document}a=l.contentWindow||l.parentWindow}else o=document,a=window;let r=null;if(!("googletag"in a)){if(!n)try{d("https://securepubads.g.doubleclick.net/tag/js/gpt.js",1,null,void 0,o.head||o.getElementsByTagName("head")[0])}catch(e){}return void setTimeout((()=>{this.reportImpressiontoGAM(e,t,i,s,1)}),100)}r=a.googletag;const h="rh-gam-imp-"+t,c=o.createElement("div");var p;c.id=h,c.style.cssText="position:fixed;height:1px;width:1px;left:0;top:0;",o.body?o.body.appendChild(c):null==(p=o.documentElement)||p.appendChild(c),r.cmd.push((()=>{const t=r.defineSlot(e.trim(),[[300,250]],h).addService(r.pubads());t.setTargeting("hb_bidder","kargo"),t.setTargeting("hb_pb_kargo",this.bucketCpm(i).toFixed(2)),r.enableServices(),r.pubads().addEventListener("slotResponseReceived",(e=>{const i=e.slot;i===t&&this.standout.logger.log("Ad response for slot",i.getSlotElementId(),"received.")})),r.pubads().addEventListener("slotRequested",(e=>{const i=e.slot;this.standout.logger.log("Slot",i.getSlotElementId(),"has been requested."),i===t&&(this.standout.logger.log("GPT slot requested",i.getSlotElementId()),this.gptRequestedSlotIds.add(i.getSlotElementId()))})),r.pubads().addEventListener("slotRenderEnded",(e=>{const i=e.slot;i===t&&(this.standout.logger.log("GPT render ended for slot",i.getSlotElementId()),this.standout.logger.log("Contents: ",i.getHtml()))})),this.displayAndRefreshGPTSlot(t)}))}displayAndRefreshGPTSlot(e){const t=window.googletag;e&&t&&(t.display(e.getSlotElementId()),setTimeout((()=>{this.gptRequestedSlotIds.has(e.getSlotElementId())||t.pubads().refresh([e])}),50))}bucketCpm(e){if(!e)return 0;const t=this.girCpmBuckets||[];for(let i=0;i<t.length;i++)if(e<=t[i].max)return Math.floor(e/t[i].roundTo)*t[i].roundTo;return 1*Math.floor(e/1)}createGamContainer(e,t){const i=document.createElement("div");i.dataset.auctionId=t,i.className="rh-gam-unit-sizer",i.id="rh-gam-"+t+"-sizer",e.appendChild(i);const s=document.createElement("div");s.dataset.auctionId=t,s.className="rh-gam-unit",s.id="rh-gam-"+t,i.appendChild(s)}getGAMIsolationFrame(){var e;const t=document.querySelector("#rh-gam-frame");if(t&&t instanceof HTMLIFrameElement)return t;const i=document.createElement("iframe");i.id="rh-gam-frame",i.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation"),i.style.cssText=this.girShowIframe?"position:fixed;height:75%;width:100%;left:0;top:0;background-color:white;":"position:fixed;height:1px;width:1px;left:0;top:0;visibility:hidden;",document.body.appendChild(i);const s=i.contentDocument||(null==(e=i.contentWindow)?void 0:e.document);return s.open(),s.write('\n    <!DOCTYPE html>\n    <html>\n      <head>\n        <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"><\/script>\n      </head>\n      <body>\n      </body>\n    </html>\n  '),s.close(),i}addImpressionPerDay(e){const t=this.productFromAuctionId(e);let i=localStorage.getItem("kso-imp-"+t),s=null;i&&(s=JSON.parse(i)),s||(s=[]),s.push((new Date).getTime());const n=(new Date).getTime();for(;s.length>0&&n-s[0]>864e5;)s.shift();localStorage.setItem("kso-imp-"+t,JSON.stringify(s))}getImpressionsPerDay(e){const t=this.productFromAuctionId(e);let i=localStorage.getItem("kso-imp-"+t),s=null;return i&&(s=JSON.parse(i)),s||(s=[]),s.length}productFromAuctionId(e){return e.includes("overlay")?"overlay":e.includes("masthead")?"masthead":e.includes("inarticle")?"inarticle":"socan"}checkAllAuctionsNoFill(){const t=Object.values(this.pbRequests||{});if(0===t.length)return 0;for(const o of t){if(!o.auctionCompleted)return 0;if(o.gamPassedBids&&o.gamPassedBids.length>0&&o.gamPassedBids.some((e=>1===e.win)))return 0;if("spotlight"===o.requestType){var i;const t=null==(i=o.eqObject)?void 0:i.placement;if(t){const i=this.standout.getProductByType(e.ProductType.Spotlight);if(i){var s,n;const e=i.placements;if(null!=(s=e[t])&&s.waitingForGam)return 0;if(null!=(n=e[t])&&n.gamRendered)return 0}}}}return 1}renderPassbackSnippet(){if(this.passbackRendered)return void this.standout.logger.log("Passback snippet already rendered");if(!this.passbackSnippet)return void this.standout.logger.log("No passback snippet configured");if(!this.checkAllAuctionsNoFill())return void this.standout.logger.log("Not all auctions completed with no-fill, passback not rendered");this.standout.logger.log("Rendering passback snippet");const e=document.createElement("div");e.id="kso-passback-container",e.style.cssText="width: 1px; height: 1px; visibility: hidden; position: absolute; left: 0; top: 0;",e.innerHTML=this.passbackSnippet,document.body.appendChild(e),this.passbackRendered=1,this.standout.logger.recordLogEvent("passback-rendered",{timestamp:(new Date).getTime(),snippet:this.passbackSnippet.substring(0,100)}),e.querySelectorAll("script").forEach((e=>{const t=document.createElement("script");Array.from(e.attributes).forEach((e=>{t.setAttribute(e.name,e.value)})),t.textContent=e.textContent,e.parentNode&&e.parentNode.replaceChild(t,e)}))}}class ${constructor(e){this.productEnabled=0,this.standout=e}loadServerSettings(e){}activate(){}reset(){}newUrl(e,t){}}class K extends ${constructor(e){super(e),this.recordedWKPresent=0,this.recordedWKAdsPresent=0}activate(){this.checkWK()}checkWK(){try{if(this.recordedWKPresent||document.querySelectorAll('script[src*="bounceexchange"]').length>0&&(this.standout.logger.recordLogEvent("wk-present"),this.recordedWKPresent=1),!this.recordedWKAdsPresent){const e=document.querySelectorAll('script[src*="bounceexchange"][src*="/ads-"]');let t=0;if("bouncex"in window&&window.bouncex.campaigns&&window.bouncex.campaigns.length>0)for(let e=0;e<window.bouncex.campaigns.length;e++){const i=window.bouncex.campaigns[e];if(i&&i.purpose&&i.purpose.includes("Ads")){t=1;break}}(e.length>0||t)&&(this.standout.logger.recordLogEvent("wk-ads-present"),this.recordedWKAdsPresent=1)}this.recordedWKAdsPresent||setTimeout(this.checkWK,2e3)}catch(e){}}}K.productName="WKScanner";class Y extends ${constructor(e){super(e),this.vpDom="https://static.kargovideo.com/player/",this.htlDom="https://htlbid.com/stage/v3/",this.videoConfig={hlsJs:"https://cdnjs.cloudflare.com/ajax/libs/hls.js/1.1.5/hls.light.min.js",prebidJs:this.vpDom+"prebid.js",playerJs:"default",playerCss:"default",playerAttrs:{configbydomain:{type:"prod"}},playerLib:"fvp_v2",widget:null,debug:0,override:0},this.invokedVideoPlayer=0,this.playerTypeOverride=null,this.playerEnabledOverride=0,this.videoContainer=null,this.playerVersionOverride=this.standout.settings.qsGet("kso_playerversion"),this.playerTypeOverride=this.standout.settings.qsGet("kso_playertype"),this.playerPrebidOverride=this.standout.settings.qsGet("kso_playerprebid"),this.playerLibOverride=this.standout.settings.qsGet("kso_playerlib"),this.playerScriptOverride=this.standout.settings.qsGet("kso_playerloadscript"),this.playerWidgetOverride=this.standout.settings.qsGet("kso_playerwidget"),this.playerEnabledOverride=this.standout.settings.qsBool("kso_playerenable"),this.standout.settings.qsBool("kso_playerdisable")&&(window.kso_disablevp=1),this.playerDomainOverride=this.standout.settings.qsGet("kso_playerdomain"),this.standout.settings.qsBool("kso_playerdomaintest")&&(this.playerDomainOverride="test-domain.com"),window.krg_so=window.krg_so||{},window.krg_so.loadPlayer=e=>{this.videoConfig=s(this.videoConfig,e),this.videoConfig.override=1,this.videoConfig.widget=1,this.processVideoPlayer()}}loadServerSettings(e){if(e.prdef&&"fabrikPlayer"in e.prdef&&(this.productEnabled=e.prdef.fabrikPlayer.enabled),e.vpDefaults&&!this.videoConfig.override&&(e.vpDefaults.prebidJs&&(this.videoConfig.prebidJs=e.vpDefaults.prebidJs),e.vpDefaults.playerJs&&(this.videoConfig.playerJs=e.vpDefaults.playerJs),e.vpDefaults.playerCss&&(this.videoConfig.playerCss=e.vpDefaults.playerCss)),e.vpWidgets&&e.vpWidgets.length&&!this.videoConfig.override){const t=[];let i=null,a=[];for(let s=0;s<e.vpWidgets.length;s++){i=e.vpWidgets[s];let l=0,r=0;if(this.standout.logger.log("Checking player",this),i.selT&&i.selT.length){for(let e=0;e<i.selT.length;e++){const s=i.selT[e];if("string"==typeof s||s instanceof String)document.querySelector(s)&&(r+=1);else{let e=null;if(s.key){if(s.key.startsWith("window.")){const t=n(window,s.key.split("window.")[1]);t&&(e={innerText:t})}else if(s.key.startsWith("@")){const t=n(window,s.key.substr(1));t&&(e={innerText:t})}else e=document.querySelector(s.key);if(e)if(s.value&&s.value.length)if(e.innerText==s.value||s.value.startsWith("*=")&&e.innerText.includes(s.value.split("*=")[1])){if("anti"==s.type||"not"==s.type){t.push(s.value.startsWith("*=")?s.value.split("*=")[1]:s.value);break}r+=1}else if(s.value.startsWith("//")&&o(e,s.value.split("//")[1])){if("anti"==s.type||"not"==s.type){t.push(s.value.split("//")[1]);break}r+=1}else if(e.getAttribute&&e.getAttribute("content")&&(e.getAttribute("content")==s.value||s.value.startsWith("*=")&&e.getAttribute("content").includes(s.value.split("*=")[1]))){if("anti"==s.type||"not"==s.type){t.push(s.value.startsWith("*=")?s.value.split("*=")[1]:s.value);break}r+=1}else"anti"!=s.type&&"not"!=s.type||(r+=1);else{if("anti"==s.type||"not"==s.type){s.key.includes("[")&&s.key.includes("]")&&(s.key.split("[")[1].split("]")[0].split("=").length>1?t.push(s.key.split("[")[1].split("]")[0].split("=")[1]):t.push(s.key.split("[")[1].split("]")[0]));break}r+=1}else"anti"!=s.type&&"not"!=s.type||(r+=1)}else e=document.querySelector(Object.keys(s)[0]),e&&e.innerText==s[Object.keys(s)[0]]&&(r+=1)}}r==i.selT.length&&(l=1)}else l=1;this.standout.logger.log("Player eligibility",l),"mQ"in i&&i.mQ&&(window.matchMedia(i.mQ).matches||(l=0,this.standout.logger.log("Doesn't match media query"))),l&&a.push(i)}if(this.playerWidgetOverride)for(let t=0;t<e.vpWidgets.length;t++)if(e.vpWidgets[t].id==this.playerWidgetOverride){a=[e.vpWidgets[t]],i=e.vpWidgets[t];break}if(a.length){let e=0;if(this.playerLibOverride){for(let t=0;t<a.length;t++)if(a[t].plLib==this.playerLibOverride){i=a[t],e=1;break}}else this.playerWidgetOverride&&(e=1);e||(i=((e,t)=>{let i,s=0,n=0;for(n=0;n<e.length;n++)s+=e[n].pct;i=s<1?Math.random()*s:Math.random();let o=0;for(n=0;n<e.length;n++)if(o+=e[n].pct,i<=o)return e[n];return null})(a)),i&&(this.standout.logger.log("Passed media query check"),this.videoConfig.playerId=i.id,this.videoConfig.playerAttrs=s(this.videoConfig.playerAttrs,i.plAttr),i.plJs&&(this.videoConfig.playerJs=i.plJs),i.plCss&&(this.videoConfig.playerCss=i.plCss),i.pbJs&&(this.videoConfig.prebidJs=i.pbJs),i.plId&&(this.videoConfig.playerAttrs||(this.videoConfig.playerAttrs={}),this.videoConfig.playerAttrs.configbydomain||(this.videoConfig.playerAttrs.configbydomain={}),this.videoConfig.playerAttrs.configbydomain.playerid=i.plId),this.videoConfig.containerStyles||(this.videoConfig.containerStyles={}),this.videoConfig.containerStyles.d=i.csD,this.videoConfig.containerStyles.m=i.csM,this.videoConfig.playerStyles||(this.videoConfig.playerStyles={}),this.videoConfig.playerStyles.d=i.psD,this.videoConfig.playerStyles.m=i.psM,i.ibS&&(this.videoConfig.insertBefore=i.ibS),i.iiS&&(this.videoConfig.insertInto=i.iiS),i.iaS&&(this.videoConfig.insertAfter=i.iaS),i.cC&&(this.videoConfig.containerClass=i.cC),i.debug&&(this.videoConfig.debug=i.debug),this.videoConfig.wrapperElement=i.wrE,this.videoConfig.footerElement=i.ftE,this.videoConfig.titleElement=i.ttE,i.plLib&&(this.videoConfig.playerLib=i.plLib),i.plSU&&(this.videoConfig.playerScriptUrl=i.plSU),i.plSS&&(this.videoConfig.playerLoaderScriptSnippet=i.plSS),i.plLU&&(this.videoConfig.playerLongitudeScriptUrl=i.plLU),i.plLSS&&(this.videoConfig.playerLongitudeScriptSnippet=i.plLSS),i.plLngtdAttr&&(this.videoConfig.playerLongitudeAttributes=i.plLngtdAttr),this.videoConfig.widget=1,this.standout.logger.log("Widget true"))}this.standout.logger.log("Checking antimatches"),t.length&&!this.videoConfig.widget&&this.standout.logger.recordLogEvent("player-anti",t),this.standout.logger.log("Checked antimatches")}else e.vp?(this.videoConfig=s(this.videoConfig,e.vp),this.videoConfig.widget=1):this.playerEnabledOverride&&(this.videoConfig.widget=1);this.standout.logger.log("Checking product enabled"),(this.productEnabled||this.playerEnabledOverride)&&(this.standout.logger.log("Video enabled"),!window.kso_disablevp&&this.videoConfig.widget&&this.standout.logger.markTime("fabrik_player_match"),this.processVideoPlayer())}processVideoPlayer(){if(this.playerLibOverride&&(this.videoConfig.playerLib=this.playerLibOverride),this.playerScriptOverride){let e=this.playerScriptOverride;/^https?:\/\//.test(e)||(e="https://"+e);try{const t=new URL(e).hostname.toLowerCase();("lngtd.com"===t||"www.lngtd.com"===t||"fabrik.com"===t||t.endsWith(".fabrik.com")||"localhost"===t||"kargovideo.com"===t||t.endsWith(".kargovideo.com"))&&(this.videoConfig.playerScriptUrl=e,this.videoConfig.playerLongitudeScriptUrl=e)}catch(e){this.standout.logger.log("Error loading player script",e+"")}}if(!window.kso_disablevp&&this.videoConfig.widget&&(this.standout.logger.log("About to load video player","FabrikPlayer"),this.loadVideoPlayerScripts(),!this.videoConfig.playerLib||"fvp_v2"===this.videoConfig.playerLib)){const e=this.createVideoPlayerPlaceholder();e&&(this.standout.logger.log("About to invoke video player","FabrikPlayer"),this.invokeVideoPlayer(e))}}loadVideoPlayerScripts(){if(!window.kso_disablevp&&this.videoConfig.widget&&!window._kso_fabrik_scripts_loaded)if(window._kso_fabrik_scripts_loaded=1,this.videoConfig.playerLib&&"fvp_v2"!==this.videoConfig.playerLib)"fvp_v3"===this.videoConfig.playerLib?(this.videoConfig.playerScriptUrl&&d(this.videoConfig.playerScriptUrl,1),this.videoConfig.playerLoaderScriptSnippet&&document.body.appendChild(this.buildInlineScript(this.videoConfig.playerLoaderScriptSnippet)),this.standout.logger.recordLogEvent("load-video-player",{id:this.videoConfig.playerId,type:"fvp_v3"}),this.standout.logger.recordLogEvent("invoke-video-player",{id:this.videoConfig.playerId,type:"fvp_v3"})):"lngtd"===this.videoConfig.playerLib&&(this.videoConfig.playerLongitudeAttributes&&(window.FVP_LNGTD=this.videoConfig.playerLongitudeAttributes),this.videoConfig.playerLongitudeScriptUrl&&d(this.videoConfig.playerLongitudeScriptUrl,1),this.videoConfig.playerLongitudeScriptSnippet&&document.body.appendChild(this.buildInlineScript(this.videoConfig.playerLongitudeScriptSnippet)),this.standout.logger.recordLogEvent("load-video-player",{id:this.videoConfig.playerId,type:"lngtd"}),this.standout.logger.recordLogEvent("invoke-video-player",{id:this.videoConfig.playerId,type:"lngtd"}));else{d(this.videoConfig.hlsJs,1);const t=this.playerPrebidOverride||this.videoConfig.prebidJs;if(t)if(t.includes("/")&&t.toLowerCase().includes("/kvbid"))d(this.htlDom+t,1);else if("kvbid.js"===t.toLowerCase()||"kvbid"===t.toLowerCase())try{var e;const t=((null==(e=window.top)?void 0:e.location.hostname)||window.location.hostname).replace("www.","");d(this.htlDom+t+"/kvbid.js",1)}catch(e){d(this.htlDom+window.location.hostname.replace("www.","")+"/kvbid.js",1)}else d(this.vpDom+a(t),1);this.videoConfig.debug&&(window.KargoPlayerDebug=1),this.standout.logger.markTime("fabrik_player_load");let i=null,s=null;const n=()=>{const e=this.videoConfig.playerJs||"default";if(e.split("/").length>4&&e.split("/")[4].split(".").length>=3){const t=e.split("/")[4].split(".");this.playerVersion=1e4*Number(t[0])+1e3*Number(t[1])+Number(t[2]),i=e.split("/")[4]}else this.playerVersion=44,i=e;s=i};if((()=>{if(!this.playerVersionOverride)return 0;let e;if(this.playerVersionOverride.split(".").length>=3){const t=this.playerVersionOverride.split(".");this.playerVersion=1e4*Number(t[0])+1e3*Number(t[1])+Number(t[2]),e=this.playerVersionOverride}else["default","latest","loader-script"].includes(this.playerVersionOverride)?(this.playerVersion=Number.MAX_SAFE_INTEGER,e=this.playerVersionOverride):(this.playerVersion=44,e="0.0.44");return i=e,s=e,1})()||n(),this.standout.logger.markTime("fabrik_player_inject_script"),i&&d(this.vpDom+i+"/kargo.js",1),this.standout.logger.recordLogEvent("load-video-player",{id:this.videoConfig.playerId,type:"fvp_v2"}),s){const e=document.createElement("link");e.rel="stylesheet",e.href=this.vpDom+s+"/kargo.css",document.getElementsByTagName("head")[0].appendChild(e)}}}createVideoPlayerPlaceholder(){var e,t;if(window.kso_disablevp||!this.videoConfig.widget)return null;const i=document.querySelectorAll('div[id^="scvpc_"]').length;this.videoContainer=document.createElement("div"),this.videoContainer.id="scvpc_"+this.standout.session.pageViewId+"_"+i,this.videoContainer.style.cssText=this.standout.device.mobile&&null!=(e=this.videoConfig.containerStyles)&&e.m?this.videoConfig.containerStyles.m:this.standout.device.mobile?"max-width:500px;max-height:300px;aspect-ratio:838/360;margin-left:auto;margin-right:auto;display:block !important;margin-bottom:20px;":!this.standout.device.mobile&&null!=(t=this.videoConfig.containerStyles)&&t.d?this.videoConfig.containerStyles.d:"max-width:854px;max-height:480px;aspect-ratio:838/360;margin-left:auto;margin-right:auto;display:block !important;margin-bottom:20px;";const s=e=>{try{return document.querySelector(e)}catch(e){return null}};let n=0,o=null;if(this.videoConfig.insertInto&&(o=s(this.videoConfig.insertInto),o&&(o.appendChild(this.videoContainer),n=1)),!n&&(this.videoConfig.insertAfter||this.videoConfig.insertBefore))if(this.videoConfig.insertAfter){const e=s(this.videoConfig.insertAfter.replace(":parent",""));e&&(this.videoConfig.insertAfter.endsWith(":parent")&&e.parentElement?e.parentElement.after(this.videoContainer):e.after(this.videoContainer),n=1)}else if(this.videoConfig.insertBefore){const e=s(this.videoConfig.insertBefore.replace(":parent",""));e&&(this.videoConfig.insertBefore.endsWith(":parent")&&e.parentElement?e.parentElement.before(this.videoContainer):e.before(this.videoContainer),n=1)}if(!n){const e=E(document.body,1);if(e&&(o=e.contentContainer,o&&e.childContainerType)){const t=o.querySelector(":scope > "+e.childContainerType+":nth-of-type(3)");t&&(t.after(this.videoContainer),n=1)}}if(!n)return this.standout.logger.log("FabrikPlayer: could not find a place to insert video player"),null;let a=this.videoContainer;if(this.videoConfig.wrapperElement){const e=g(this.videoConfig.wrapperElement);e.length&&(a=e[0],this.videoContainer.appendChild(a))}this.videoConfig.titleElement&&g(this.videoConfig.titleElement).forEach((e=>a.appendChild(e)));const l=document.createElement("div");return l.id="scvp_"+this.standout.session.pageViewId,this.videoConfig.playerStyles&&(l.style.cssText=this.standout.device.mobile?this.videoConfig.playerStyles.m:this.videoConfig.playerStyles.d||this.videoConfig.playerStyles.m),a.appendChild(l),this.videoConfig.footerElement&&g(this.videoConfig.footerElement).forEach((e=>a.appendChild(e))),l}invokeVideoPlayer(e,t=0,i=0){if(window.kso_disablevp||!this.videoConfig.widget)return;if(!window.KargoVideo)return i>=100?void this.standout.logger.recordLogEvent("invoke-video-player-timeout",{id:this.videoConfig.playerId,attempts:i}):void setTimeout((()=>{t||(this.standout.logger.SDTLog(164),t=1),this.invokeVideoPlayer(e,t,i+1)}),100);const s=G({},this.videoConfig.playerAttrs||{});s.conditionalconfigs&&s.conditionalconfigs.length&&delete s.configbydomain,this.playerTypeOverride&&(s.configbydomain||(s.configbydomain={}),s.configbydomain.type=this.playerTypeOverride),this.playerDomainOverride&&(s.configbydomain||(s.configbydomain={}),s.configbydomain.domain=this.playerDomainOverride),this.standout.logger.markTime("fabrik_player_initialize");const n=new window.KargoVideo.Player({element:e,attrs:s});n.on(this.playerVersion&&this.playerVersion<41?"all":"debug-log",((e,t)=>{this.standout.logger.SDTLogExternal(e,"KargoPlayer",null,t)})),this.standout.logger.markTime("fabrik_player_invoke"),n.activate(),this.invokedVideoPlayer=1,this.standout.logger.recordLogEvent("invoke-video-player",{id:this.videoConfig.playerId,type:"fvp_v2",it:this.standout.logger.timeFor("fabrik_player_invoke"),lt:this.standout.logger.timeBetween("fabrik_player_match","fabrik_player_invoke"),slt:this.standout.logger.timeBetween("fabrik_player_inject_script","fabrik_player_invoke"),fpi:this.standout.logger.timeBetween("fabrik_player_initialize","fabrik_player_invoke")})}buildInlineScript(e){const t=document.createElement("script");return t.text=e,t}}function J(e,t){const i=t;e.standout.logger.SDTLog(50,null,i),e.standout.communications.postKSO("request/hnwp",i,(()=>{}))}Y.productName="FabrikPlayer";class Q extends ${constructor(e){super(e),this.deferredData={},this.lastEventTimestamp=0,this.focusElement=null,this.rhFound={},this.blockTypes=[],this.popDefaults={upper:{overlap:30,height:150,width:320},lower:{overlap:18,height:50,width:320}},this.rhDivClass="rhc"+N(),this.deferForViewability=0,this.doingScan=0,this.doingRescan=0,this.iterations=0,this.ineligiblePosts=0,this.runningQueue=0,this.rhombusAddedAd=0,this.multipleAds=0,this.timeFinishedScan=0,this.requestCount=0,this.dfpUpperFill=null,this.dfpLowerFill=null,this.reportedFill=0,this.rhombusEmbedQueue=[],this.confirmedEmbeds=[],this.winningTargetIds=null,this.rhShowingHN=0,this.hnAutoCollapse=0,this.hnWrapper=null,this.whitelistedCampaigns=null,this.blacklisted=0,this.overrideTargetSegments=null,this.shouldShowHN=0,this.forceHN=0,this.forceHNWidget=-1,this.demoSettings={},this.stickyElements={},this.invertPlacements=0,this.embedUrlWithAd=null,this.rhAdditionalClass=null,this.containerElement=null,this.disableResizing=0,this.recordedFill=0,this.rhSLP=0,this.rhFilledSlots=0,this.disableLower=0,this.requesting=0,this.rhRecordedRequest=0,this.rhDI=0,this.eeObsv=null}activate(){window.SocialCanvas={recordBidRequest(){},recordBidResult(){},disableAds:()=>{this.standout.settings.disableAdRendering=1}},window.socialCanvas=window.SocialCanvas,this.loadSettings(),this.createStyleElements(),this.clearFound(),this.addListeners();let e=0;Number(this.standout.settings.qsGet("rhdelay"))>0?(e=Number(this.standout.settings.qsGet("rhdelay")),this.standout.logger.SDTLog(16,{seconds:e})):Number(this.standout.settings.qsGet("kso_delay"))>0&&(e=Number(this.standout.settings.qsGet("kso_delay")),this.standout.logger.SDTLog(16,{seconds:e})),e>0?setTimeout((()=>{this.doRhombusScan(null)}),1e3*e):this.doRhombusScan(null)}loadSettings(){if(this.standout.settings.qsGet("sc_blocktypes")&&(this.blockTypes=this.standout.settings.qsGet("sc_blocktypes").split(",")),this.standout.settings.qsGet("rhpopmods")&&(this.popDefaults=JSON.parse(this.standout.settings.qsGet("rhpopmods"))),this.standout.settings.qsHas("rhfhn")){this.forceHN=1;const e=Number(this.standout.settings.qsGet("rhfhn"));e>1&&(this.forceHNWidget=e)}const e=this.standout.settings.qsGet("rhots");e&&(this.overrideTargetSegments=e.split(","),this.standout.logger.SDTLog(10,this.overrideTargetSegments))}createStyleElements(){const e=this.rhDivClass,t=`\n.rhi{max-width:100% !important;height:auto !important;}\n.${e} a,.rhi,.${e} img{-webkit-box-shadow:none !important;-moz-box-shadow:none !important;box-shadow:none !important;border-style:none !important;margin:0 0 0 0 !important;padding:0 0 0 0 !important;}\n.${e} a>img{display:block;}\n.${e} .instagram-media-rendered,.${e} .twitter-tweet-rendered{margin:0 0 !important;}\n.${e}{box-sizing:border-box !important;text-align:center;}\n.${e}>div{text-align:center;}\n.${e} div div{max-width:100%;}\n.${e} iframe{position:relative;display:block;}\n.hn-container-left .rna-container{margin:10px 0 !important;}\n.rna-container iframe{position:relative;}\n.rna-container .fb-post{max-width:100% !important;padding-bottom:0;}\n.rna-container .fb-post>span{max-width:100% !important;margin:0 0;max-height: initial !important;}\n@media only screen and (max-width:600px){\n  .${e}{box-sizing:border-box;}\n  .${e} .instagram-media-rendered{width:500px !important;min-width:220px !important;max-width:100% !important;box-sizing:border-box !important;}\n}\n.${e} .rhus { width: 500px; max-width: 100%; }\n.${e} .rhls{margin-top:10px !important;}\n.${e} .rhus .fluid-width-video-wrapper, .${e} .rhls .fluid-width-video-wrapper{display:none !important;}\n.${e}.rhvid .rhus, .${e}.rhvid .rhls{width:100%;max-width:100%;}\n.${e} .rhus div, .${e} .rhls div{margin-left:auto !important;margin-right:auto !important;}\n.${e} .rhus ins, .${e} .rhls ins{max-width:500px !important;}\n.rna-container .vid-container{position:relative;overflow:hidden;height:0 !important;padding-bottom:56.25% !important;}\n.rna-container .vid-container iframe{position:absolute;top:0;left:0;width:100%;height:100%;min-width:auto;min-height:auto;}\n.rna-container .fluid-width-video-wrapper iframe{position:absolute;top:0;left:0;width:100%;height:100%;}\ndiv[data-rhp="1"] > div{margin-left:auto;margin-right:auto;}\n`,i=document.createElement("style");i.textContent=t,document.head.appendChild(i)}doRhombusScan(i){if(this.doingScan)return;this.doingScan=1;let s=0;this.standout.logger.SDTLog(19,null,i),this.iterations++;const n=Array.from(document.querySelectorAll("div[id^='tweet_']"));if(n.length>0&&this.iterations<5&&""===n[0].innerHTML.trim())return setTimeout((()=>{this.doRhombusScan(i)}),1e3),this.doingScan=0,void(this.doingRescan=0);let o=this.standout.serverSettings.siteId||"";this.deferForViewability=0;const a=this.standout.settings.qsGet("rhviewability");if(a&&0===Number(a)&&(this.deferForViewability=0,this.standout.logger.SDTLog(21)),!("rhDidDelay"in document.body)&&o){let e=0;if(["1064941","1074770"].includes(o)?e=1500:["1088606","1116574"].includes(o)&&(e=800),e)return this.standout.logger.SDTLog(22,{delayTime:e}),setTimeout((()=>{this.doRhombusScan(i)}),e),document.body.rhDidDelay=1,this.doingScan=0,void(this.doingRescan=0)}let l=this.focusElement||document;if(this.focusElement=null,i&&i.element&&(l=i.element,l.getElementsByClassName(this.rhDivClass).length>0||i.element.classList.contains("processed-rh-hn")||i.element.classList.contains("processed-rh-embed")))return this.doingScan=0,void(this.doingRescan=0);if(this.llObserver||(this.standout.logger.SDTLog(23),this.llObserver=new MutationObserver((e=>{let t=0;(e||[]).forEach((e=>{Array.from(e.removedNodes||[]).forEach((e=>{e instanceof HTMLElement&&e.classList&&(e.classList.contains("lazy-load-placeholder")||e.classList.contains("lazyload-placeholder")||e.classList.contains("css-obptq2-SocialEmbed-padding"))&&(t=1,this.standout.logger.SDTLog(151))})),Array.from(e.addedNodes||[]).forEach((e=>{if(!(e instanceof HTMLElement))return;if(u(e,".rhus,.rhls,div[data-rhp]"))return;const i=e.parentElement;if(i&&i.hasAttribute("data-external-embed")||e.classList&&e.classList.contains("twitter-tweet"))t=1,this.standout.logger.SDTLog(150,null,e);else if(e instanceof HTMLIFrameElement){const i=e.getAttribute("data-src")||e.src||"";i&&M(i,Q.PLATFORM_PATTERNS)&&(t=1,this.standout.logger.SDTLog(150,null,e))}else e.getAttribute&&e.getAttribute("class")&&(e.getAttribute("class")||"").includes("blogItem_container")&&(t=1,this.standout.logger.SDTLog(150,null,e))}))})),!t||this.doingScan||this.doingRescan||(this.iterations=0,this.standout.logger.SDTLog(24),this.standout.settings.alreadyRan=0,this.doRhombusScan())})),this.llObserver.observe(document.body,{childList:1,subtree:1})),this.forceHN){const e=document.querySelector(".rh-hn-widget");e&&(l=e)}let r=[];if(l&&(r=Array.from(l.querySelectorAll(".twitter-tweet,.instagram-media,[data-class='twitter-tweet'],span.twitter-embed,iframe,.fb-post,.twitter-video,[data-class='twitter-video'],.reddit-card,iframe.embedly-card,.tumblr-post,a[data-pin-do='embedPin'],span[data-pin-href][data-pin-id],iframe[data-src],img[data-lazy-type='iframe'],iframe[data-src*=\"ajax/inset/iframe\"],.single-post-oembed-youtube-wrapper,.ls_video_embed.lazyloaded,.ls_video_embed.lazyload,.mace-youtube[data-mace-video],amp-youtube[data-videoid],amp-twitter[data-tweetid],blockquote.tiktok-embed[cite]"))),r&&r.length?this.standout.logger.SDTLog(25,null,{count:r.length}):this.standout.logger.SDTLog(26),r.forEach((n=>{if(this.checkIfElementProcessed(n))return;let o=1,a=null,l=null,r=null,h=null,c=null,p=null,u=null,b=null,y=null,f=-1,v=null,w=null,S=0;const k=n,T={};let A=0,E=null;if(n.hasAttribute("src")&&"IMG"!=n.tagName)E=n.getAttribute("src"),E&&E.length||!n.hasAttribute("data-src")||(E=n.getAttribute("data-src"));else if(n.hasAttribute("data-src"))E=n.getAttribute("data-src");else if(n.hasAttribute("data-lazy-src")){const e=n.getAttribute("data-lazy-src")||"",t=document.createElement("textarea");t.innerHTML=e;const i=t.value,s=document.createElement("div");s.innerHTML=i;const o=s.children[0];E=(null==o?void 0:o.src)||null}else if(n.classList&&(n.classList.contains("single-post-oembed-youtube-wrapper")||n.hasAttribute("data-pod"))){if(n.hasAttribute("data-pod")){const e=n.getAttribute("data-pod")||"";try{const t=JSON.parse(e);if(t&&t.html&&t.html.length){const e=g(t.html);if(e.length){const t=e[0];t.hasAttribute("src")&&(E=t.src||t.getAttribute("src"))}}}catch(e){}}else if(n.querySelector("iframe")){const e=n.querySelector("iframe");e&&(E=e.src)}}else n.classList.contains("ls_video_embed")&&n.hasAttribute("data-youtube")?E="https://youtube.com/watch?v="+n.getAttribute("data-youtube"):n.classList.contains("mace-youtube")&&n.hasAttribute("data-mace-video")?E=n.getAttribute("data-mace-video"):"AMP-YOUTUBE"==n.tagName&&n.hasAttribute("data-videoid")?E="https://youtube.com/watch?v="+n.getAttribute("data-videoid"):n.hasAttribute("cite")&&(E=n.getAttribute("cite"));if(n.children&&n.children.length>0){const e=n.children[0],t=e.hasAttribute("src"),i=e.getAttribute("src")||"";if(t&&i.includes("ajax/inset/iframe"))return}let C=n.parentElement||{className:""};if("vid-container"==C.className&&(C=C.parentElement||{className:""}),C.className.includes("css-obptq2-SocialEmbed-padding"))return;if(s||n.hasAttribute("data-rh-vid")||n.classList&&n.classList.contains(this.rhDivClass)||C.classList&&C.classList.contains(this.rhDivClass)||(n.className||"").includes("rhc")&&(n.className||"").length>11||(C.className||"").includes("rhc")&&(C.className||"").length>11)return;if(n.parentElement&&n.parentElement.classList.contains("rna-container"))return;if("IFRAME"==n.tagName&&E&&M(E,["googleapis.com/","googlesyndication.com/","javascript:void","taboola.com/","pubmatic.com/","indexww.com/","brealtime.com/"]))return;const I=[];let x=0;if(n.setAttribute("data-rhp","1"),"IFRAME"==n.tagName&&(n.className||"").includes("embedly-card"))try{var L;const e=n.contentDocument||(null==(L=n.contentWindow)?void 0:L.document)||null,t=null==e?void 0:e.querySelector(".card");if(t&&(this.standout.logger.SDTLog(27,{className:t.className},n),t.classList.contains("reddit"))){const t=null==e?void 0:e.querySelector(".reddit-post > a"),i=null==t?void 0:t.href;if(i){const e=m(n,["embedly-card"]),t=document.createElement("BLOCKQUOTE");t.className="reddit-card",t.innerHTML='<p><a href="'+i+'"></a></p>',t.style.visibility="hidden",e&&e.parentNode&&(e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)),n=t}}}catch(e){}if(!n.parentElement||n.className.includes("twitter-follow")||!n.className.includes("twitter-video")&&!n.className.includes("twitter-tweet")&&"twitter-tweet"!==n.getAttribute("data-class")&&"twitter-video"!==n.getAttribute("data-class")&&(!n.className.includes("rm-shortcode")||n.src&&(n.src||"").includes("spotify."))&&"AMP-TWITTER"!==n.tagName){if(n.className.includes("twitter-embed")&&"SPAN"==n.tagName){if(!n.querySelector(".twitter-tweet"))return s=1,n.removeAttribute("data-rhp"),void this.standout.logger.log("Deferring")}else if(n.className.includes("instagram-media")){s=0;let d=n;d.previousSibling&&"IFRAME"===d.previousSibling.tagName&&(d=d.previousSibling);const h=this.evalAdEligibility(d);var D;o=h.eligible,x=h.skipWrapping,I.push(...h.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),x?n.setAttribute("data-rhp","1"):(null==(D=d.parentElement)||D.insertBefore(r,d),r.appendChild(d),setTimeout((()=>{window.instgrm&&window.instgrm.Embeds.process()}),200));const g=t(d.getElementsByTagName("A"));if(0===g.length){if(c=d.innerText,p=d.shadowRoot||d.contentDocument,!p&&d.contentWindow)try{p=d.contentWindow.document}catch(e){}if(p){for(u=p.querySelectorAll("div"),A=0;A<u.length;A++)b=u[A],y=b.getAttribute("data-click-to-open-target"),y&&y.length&&(a=y);if(null==a)for(u=p.querySelectorAll("a.CallToAction"),A=0;A<u.length;A++)b=u[A],y=b.href,y&&y.length&&(a=y)}}if(g.length>0){let t=null,i=null;g.forEach((e=>{const s=e.href;s.includes("/p/")||s.includes("/tv/")?(e.innerText.split(" ").forEach((e=>{e.startsWith("@")?l=e.substr(1):e.startsWith("(@")&&(l=e.substr(2,e.length-3))})),t=s,i=e.innerText):l=s.split("/")[3]})),r.setAttribute("data-embed-url",t||""),r.setAttribute("data-rhp","1"),d.hasAttribute("height")&&r.setAttribute("data-original-height",d.getAttribute("height")||""),d.hasAttribute("width")&&r.setAttribute("data-original-width",d.getAttribute("width")||""),this.sizeTempContainer(r),this.standout.logger.SDTLogAddEmbedDetails(t||"",{element:d,embedType:e.EmbedTypes.Instagram,failure:o?null:"Ineligible: "+I.join(", ")}),l?(o?this.checkForRhombusAds(e.EmbedTypes.Instagram,i||"",t||"",d,((i,s,n)=>{if(r){if(i){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(s.decisions,r,t||"",e.EmbedTypes.Instagram,n),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null");setTimeout((()=>{window.instgrm&&window.instgrm.Embeds.process()}),200)}})):x||this.buildWrappingContainer(r,"ineligible"),T.url=t,T.embedType=e.EmbedTypes.Instagram,T.inHeader=I.includes("HEm"),T.ineligibilityReasons=I,this.rhFound[e.EmbedTypes.Instagram].push(T),!o&&t&&this.postEmbedLoad(t,I)):t?(o?this.checkForEmbedData(t,0,d,((i,s,n)=>{if(r){if(i){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(s.decisions,r,t||"",e.EmbedTypes.Instagram,n),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null");setTimeout((()=>{window.instgrm&&window.instgrm.Embeds.process()}),200)}})):x||this.buildWrappingContainer(r,"ineligible"),this.rhFound[e.EmbedTypes.Instagram].push({url:t,embedType:e.EmbedTypes.Instagram,inHeader:I.includes("HEm"),ineligibilityReasons:I}),o||this.postEmbedLoad(t,I)):x||this.buildWrappingContainer(r,"invalid")}else w=d.getAttribute("src"),w&&w.length||!d.hasAttribute("data-instgrm-permalink")||(w=d.getAttribute("data-instgrm-permalink")),w&&w.length>0?(this.standout.logger.SDTLogAddEmbedDetails(w,{element:d,embedType:e.EmbedTypes.Instagram,failure:o?null:"Ineligible: "+I.join(", ")}),r.setAttribute("data-embed-url",w),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),o?this.checkForEmbedData(w,0,d,((t,i,s)=>{if(r){if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,r,w,e.EmbedTypes.Instagram,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null");setTimeout((()=>{window.instgrm&&window.instgrm.Embeds.process()}),200)}})):x||this.buildWrappingContainer(r,"ineligible"),this.rhFound[e.EmbedTypes.Instagram].push({url:w,embedType:e.EmbedTypes.Instagram,inHeader:I.includes("HEm"),ineligibilityReasons:I}),o||this.postEmbedLoad(w,I)):x||this.buildWrappingContainer(r,"invalid")}else if(n.className.includes("reddit-card")){s=0,h=n,h.previousSibling&&"IFRAME"===h.previousSibling.tagName&&(h=h.previousSibling);const a=this.evalAdEligibility(h);o=a.eligible,x=a.skipWrapping,I.push(...a.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed");const l=t(h.getElementsByTagName("A"))[0];if(l){let t=null;h.previousSibling&&"embedly-card"===h.previousSibling.className?t=h.previousSibling:h.parentElement&&h.parentElement.children[0]===h&&h.parentElement.previousSibling&&"embedly-card"===h.parentElement.previousSibling.className&&(t=h.parentElement.previousSibling),r=document.createElement("div"),!x&&h.parentElement&&(h.parentElement.insertBefore(r,h),t&&t.parentElement?(t.parentElement.removeChild(t),h.removeAttribute("data-rendering"),h.removeAttribute("data-card-created"),r.appendChild(h),d("//embed.redditmedia.com/widgets/platform.js",1),this.standout.logger.SDTLog(32,null,h)):(h.parentElement.insertBefore(r,h),r.appendChild(h))),l.href&&l.href.length>0?(this.standout.logger.SDTLogAddEmbedDetails(l.href,{element:h,embedType:e.EmbedTypes.Reddit,failure:o?null:"Ineligible: "+I.join(", ")}),r.setAttribute("data-embed-url",l.href),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),o?this.checkForEmbedData(l.href,0,h,((t,i,s)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,r,l.href,e.EmbedTypes.Reddit,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):x||this.buildWrappingContainer(r,"ineligible"),(l.href.includes("reddit.com")||l.href.includes("redditmedia.com"))&&this.rhFound[e.EmbedTypes.Reddit].push({url:l.href,embedType:e.EmbedTypes.Reddit,inHeader:I.includes("HEm"),ineligibilityReasons:I}),o||this.postEmbedLoad(l.href,I)):x||this.buildWrappingContainer(r,"invalid")}}else if(n.parentElement&&n.hasAttribute("src")&&(n.getAttribute("src")||n.src||"").includes("ajax/inset/iframe")){if(s=0,n.id.includes("-")){const t=(n.id.split("-")[0]||"").toLowerCase(),s=n.id.substring(n.id.indexOf("-")+1);if(t.length>0){if(t.includes("spotify")?f=e.EmbedTypes.Spotify:t.includes("soundcloud")?f=e.EmbedTypes.Soundcloud:t.includes("youtube")?(f=e.EmbedTypes.Youtube,v="https://youtube.com/watch?v="+s):t.includes("tiktok")?(f=e.EmbedTypes.TikTok,v="https://tiktok.com/embed/v2/"+s):t.includes("megaphone")?(f=e.EmbedTypes.Megaphone,v="https://player.megaphone.fm/"+s):t.includes("giphy")?(f=e.EmbedTypes.Giphy,v="https://giphy.com/embed/"+s):t.includes("imgur")?(f=e.EmbedTypes.Imgur,v="https://imgur.com/"+s+"/embed"):t.includes("vimeo")?(f=e.EmbedTypes.Vimeo,v="https://player.vimeo.com/video/"+s):t.includes("anchor")?f=e.EmbedTypes.Anchor:t.includes("twitch")?(f=e.EmbedTypes.Twitch,v="https://clips.twitch.tv/embed?clip="+s):t.includes("reddit")?f=e.EmbedTypes.Reddit:t.includes("gfycat")?(f=e.EmbedTypes.GfyCat,v="https://gfycat.com/ifr/"+s):t.includes("instagram")?(f=e.EmbedTypes.Instagram,v="https://instagram.com/p/"+s+"/"):t.includes("linkedin")?f=e.EmbedTypes.LinkedIn:t.includes("apple")?f=e.EmbedTypes.AppleMusic:t.includes("tumblr")?f=e.EmbedTypes.Tumblr:t.includes("pinterest")?(f=e.EmbedTypes.Pinterest,v="https://pinterest.com/pin/"+s+"/"):t.includes("twitter")&&(f=e.EmbedTypes.Twitter,v="https://twitter.com/username/status/"+s),!v)return;const a=this.evalAdEligibility(n);o=a.eligible,x=a.skipWrapping,I.push(...a.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),f>=0&&(o?(r=document.createElement("div"),o&&[e.EmbedTypes.Youtube,e.EmbedTypes.Vimeo,e.EmbedTypes.Twitch].includes(f)?(r=n,r.setAttribute("data-yt-skip","1"),r.setAttribute("data-rh-vid","1")):!x&&n.parentElement&&(n.parentElement.insertBefore(r,n),r.appendChild(n)),(v||"").length>0?(r.setAttribute("data-embed-url",v),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),this.standout.logger.SDTLogAddEmbedDetails(v,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")}),o?this.checkForEmbedData(v,0,n,((e,t,i)=>{if(e){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(t.decisions,r,v,f,i),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):x||this.buildWrappingContainer(r,"ineligible"),this.rhFound[f].push({url:v,embedType:f,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")):o||((v||"").length>0&&(this.rhFound[f].push({url:v,embedType:f,skipAdCheck:1,inHeader:I.includes("HEm"),ineligibilityReasons:I}),this.postEmbedLoad(v,I)),this.standout.logger.SDTLogAddEmbedDetails(v,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")})))}}}else if(n.parentElement&&(n.classList.contains("ls_video_embed")||n.classList.contains("mace-youtube")||"AMP-YOUTUBE"==n.tagName)&&(E||"").includes("youtube.com/")){s=0,v=E,f=e.EmbedTypes.Youtube,x=1;const t=this.evalAdEligibility(n);o=t.eligible,x=t.skipWrapping,I.push(...t.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),o?(r=document.createElement("div"),o&&[e.EmbedTypes.Youtube,e.EmbedTypes.Vimeo,e.EmbedTypes.Twitch].includes(f)?(r=n,r.setAttribute("data-yt-skip","1"),r.setAttribute("data-rh-vid","1")):!x&&n.parentElement&&(n.parentElement.insertBefore(r,n),r.appendChild(n)),(v||"").length>0?(r.setAttribute("data-embed-url",v),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),this.standout.logger.SDTLogAddEmbedDetails(v,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")}),o?this.checkForEmbedData(v,0,n,((e,t,i)=>{if(e){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(t.decisions,r,v,f,i),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):x||this.buildWrappingContainer(r,"ineligible"),this.rhFound[f].push({url:v,embedType:f,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")):o||((v||"").length>0&&(this.rhFound[f].push({url:v,embedType:f,skipAdCheck:1,inHeader:I.includes("HEm"),ineligibilityReasons:I}),this.postEmbedLoad(v,I)),this.standout.logger.SDTLogAddEmbedDetails(v,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")}))}else if(n.parentElement&&E&&M(E,Q.PLATFORM_PATTERNS)){if(s=0,w=E,w.includes("embedly.com/widget")){if(!w.includes("?"))return;{const e=new URLSearchParams("?"+w.split("?")[1]).get("src");if(!e)return;w=e}}S=w.includes("youtube.com")||w.includes("youtube-nocookie.com")||w.includes("vimeo.com")||w.includes("twitch.tv")||w.includes("tiktok.com"),E&&E.includes("tiktok.com/")&&window.location.hostname.toLowerCase().includes(".livingly.com")&&(o=0,x=1),n.dataset.originalClientWidth=n.clientWidth+"",n.dataset.originalClientHeight=n.clientHeight+"";const e=this.evalAdEligibility(n);o=e.eligible,x=e.skipWrapping,I.push(...e.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),q(["slate.com","tmz.com"])&&(x=1),f=this.detectEmbedTypeFromSrc(w),f>=0&&(!S||o?(r=document.createElement("div"),S&&o?(r=n,r.setAttribute("data-yt-skip","1"),r.setAttribute("data-rh-vid","1")):q(["slate.com","tmz.com"])?r=n:!x&&n.parentElement&&(n.parentElement.insertBefore(r,n),r.appendChild(n)),(w||"").length>0?(q(["slate.com","tmz.com"])||(r.setAttribute("data-embed-url",w),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r)),this.standout.logger.SDTLogAddEmbedDetails(w,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")}),o?this.checkForEmbedData(w,0,n,((e,t,i)=>{if(e){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(t.decisions,r,(w||"")+"",f,i),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):(x||this.buildWrappingContainer(r,"ineligible"),this.postEmbedLoad(w,I)),this.rhFound[f].push({url:w,embedType:f,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")):S&&!o&&((w||"").length>0&&(f=this.detectEmbedTypeFromSrc(w),f>=0&&(this.rhFound[f].push({url:w,embedType:f,skipAdCheck:1,inHeader:I.includes("HEm"),ineligibilityReasons:I}),o||this.postEmbedLoad(w,I))),this.standout.logger.SDTLogAddEmbedDetails(w,{element:n,embedType:f,failure:o?null:"Ineligible: "+I.join(", ")})))}else if(n.parentElement&&(n.className.includes("fb-post")||n.className.includes("fb-video"))&&n.getAttribute("data-href")&&(n.getAttribute("data-href")||"").length>0&&n.querySelectorAll("blockquote.fb-xfbml-parse-ignore").length>0){s=0;const t=n,a=n,l=t.getAttribute("data-href")||"";if(l.includes("taboola.com/")||l.split("/").filter((e=>e)).length<4)return;const d=Array.from(a.querySelectorAll("blockquote > p"));if(d.length>0&&(c=d[0].innerText),""===(l&&l.split("/")[5]?l.split("/")[5].split("?")[0]:""))return s=1,t.removeAttribute("data-rhp"),void this.standout.logger.log("Deferring");i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),r.setAttribute("data-embed-url",l),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),!x&&t.parentElement?t.parentElement.insertBefore(r,t):S&&(r=t,r.setAttribute("data-yt-skip","1"),r.setAttribute("data-rh-vid","1"));const h=(i,s)=>{this.checkForRhombusAds(e.EmbedTypes.Facebook,i,l,t,((t,i,n)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,s,(l||"")+"",e.EmbedTypes.Facebook,n),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(s,"null")}))};this.standout.logger.SDTLogAddEmbedDetails(l,{element:t,embedType:e.EmbedTypes.Facebook,failure:o?null:"Ineligible: "+I.join(", ")}),x||r.appendChild(t),o?h(c,r):x||this.buildWrappingContainer(r,"ineligible");try{const e=t.XFBML;e&&"function"==typeof e.parse&&e.parse(r)}catch(e){}T.url=l,T.embedType=e.EmbedTypes.Facebook,T.inHeader=I.includes("HEm"),T.ineligibilityReasons=I,l&&l.length>0&&(this.rhFound[e.EmbedTypes.Facebook].push(T),o||this.postEmbedLoad(l,I))}else if(n.parentElement&&(n.className.includes("fb-post")||n.className.includes("fb-video"))&&n.getAttribute("data-href")&&(n.getAttribute("data-href")||"").length>0&&n.querySelectorAll("span>iframe").length>0||"IFRAME"===n.tagName&&(n.getAttribute("src")||"").length>0&&(n.getAttribute("src")||"").includes("facebook.com/")&&!(n.getAttribute("src")||"").includes("facebook.com/plugins/like")&&!(n.getAttribute("src")||"").includes("facebook.com/audiencenetwork/token")&&!(n.getAttribute("src")||"").includes("staticxx.")&&!(n.getAttribute("src")||"").includes("comments.php")){s=0;const t=Array.from(n.querySelectorAll("span>iframe"));let a="";if(a=t.length>0?t[0].getAttribute("src")||"":n.getAttribute("src")||"",a.includes("taboola.com/")||a.split("/").filter((e=>e)).length<4)return;(a.includes("/video.")||a.includes("videos"))&&(S=1,x=1);const l=this.evalAdEligibility(n);o=l.eligible,x=l.skipWrapping,I.push(...l.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),!x&&n.parentElement?(n.parentElement.insertBefore(r,n),r.appendChild(n)):S&&(r=n,r.setAttribute("data-yt-skip","1"),r.setAttribute("data-rh-vid","1")),r.setAttribute("data-embed-url",a),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),(a||"").length>0?(this.standout.logger.SDTLogAddEmbedDetails(a,{element:n,embedType:e.EmbedTypes.Facebook,failure:o?null:"Ineligible: "+I.join(", ")}),o?this.checkForEmbedData(a,0,n,((t,i,s)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,r,(a||"")+"",e.EmbedTypes.Facebook,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):(x||this.buildWrappingContainer(r,"ineligible"),this.postEmbedLoad(a,I)),this.rhFound[e.EmbedTypes.Facebook].push({url:a,embedType:e.EmbedTypes.Facebook,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")}else if("A"==n.tagName&&n.href&&n.href.includes("pinterest.com/pin")){s=0,h=n;const t=this.evalAdEligibility(n);o=t.eligible,x=t.skipWrapping,I.push(...t.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),!x&&h.parentElement&&(h.parentElement.insertBefore(r,h),r.appendChild(h));const a=n.href||"";a.length>0?(this.standout.logger.SDTLogAddEmbedDetails(a,{element:h,embedType:e.EmbedTypes.Pinterest,failure:o?null:"Ineligible: "+I.join(", ")}),r.setAttribute("data-embed-url",a),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),o?this.checkForEmbedData(a,0,n,((t,i,s)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,r,a,e.EmbedTypes.Pinterest,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):(x||this.buildWrappingContainer(r,"ineligible"),this.postEmbedLoad(a,I)),this.rhFound[e.EmbedTypes.Pinterest].push({url:a,embedType:e.EmbedTypes.Pinterest,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")}else if("SPAN"==n.tagName&&n.hasAttribute("data-pin-href")&&null!==n.getAttribute("data-pin-href")&&n.getAttribute("data-pin-href").includes("pinterest.com/pin")&&!n.className.includes("_repin")){s=0;const t=n.getAttribute("data-pin-href")||"";h=n;const a=this.evalAdEligibility(n);o=a.eligible,x=a.skipWrapping,I.push(...a.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),!x&&h.parentElement&&(h.parentElement.insertBefore(r,h),r.appendChild(h)),t.length>0?(this.standout.logger.SDTLogAddEmbedDetails(t,{element:h,embedType:e.EmbedTypes.Pinterest,failure:o?null:"Ineligible: "+I.join(", ")}),r.setAttribute("data-embed-url",t),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),o?this.checkForEmbedData(t,0,h,((i,s,n)=>{if(i){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(s.decisions,r,t,e.EmbedTypes.Pinterest,n),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):(x||this.buildWrappingContainer(r,"ineligible"),this.postEmbedLoad(t,I)),this.rhFound[e.EmbedTypes.Pinterest].push({url:t,embedType:e.EmbedTypes.Pinterest,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")}else if(n.className&&n.className.includes("tumblr-post")&&n.hasAttribute("data-href")){s=0;const t=n.getAttribute("data-href")||"";h=n;const a=this.evalAdEligibility(n);o=a.eligible,x=a.skipWrapping,I.push(...a.reasons),o||(this.ineligiblePosts+=1),i&&i.element&&i.element.classList.add("processed-rh-embed"),r=document.createElement("div"),!x&&h.parentElement&&(h.parentElement.insertBefore(r,h),r.appendChild(h)),t.length>0?(this.standout.logger.SDTLogAddEmbedDetails(t,{element:h,embedType:e.EmbedTypes.Tumblr,failure:o?null:"Ineligible: "+I.join(", ")}),r.setAttribute("data-embed-url",t),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r),o?this.checkForEmbedData(t,0,h,((i,s,n)=>{if(i){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(s.decisions,r,t,e.EmbedTypes.Tumblr,n),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(r,"null")})):(x||this.buildWrappingContainer(r,"ineligible"),this.postEmbedLoad(t,I)),this.rhFound[e.EmbedTypes.Tumblr].push({url:t,embedType:e.EmbedTypes.Tumblr,inHeader:I.includes("HEm"),ineligibilityReasons:I})):x||this.buildWrappingContainer(r,"invalid")}}else{var N;s=0;let l=n,h=n,g="twitter-tweet";if((n.className.includes("twitter-video")||n.getAttribute("data-class")&&"twitter-video"==n.getAttribute("data-class"))&&(g="twitter-video"),"IFRAME"==n.tagName&&n.className.includes("rm-shortcode")&&!n.src){let e=n.shadowRoot||n.contentDocument;if(!e&&n.contentWindow)try{e=n.contentWindow.document}catch(e){}e&&(l=e.querySelectorAll("."+g)[0]),l?h=l:l=n}if("TWITTER-WIDGET"==l.tagName||"TWITTERWIDGET"==l.tagName||"IFRAME"==l.tagName||l.classList&&l.classList.contains("twitter-tweet-rendered")){const e=l.nextSibling;e&&"BLOCKQUOTE"==e.tagName&&e.classList.contains(g)&&e.parentElement&&e.parentElement.removeChild(e)}const m=l.previousSibling;!m||"TWITTERWIDGET"!=m.tagName&&"TWITTER-WIDGET"!=m.tagName&&"IFRAME"!=m.tagName||l.classList.contains("twitter-tweet-error")||(l=m,l.childNodes&&l.childNodes.length>0&&(h=l));const f=l.classList.contains("twitter-tweet-rendered"),v=null!=(N=l.parentElement)&&N.classList.contains("embed-twitter")?l.parentElement:l,w=this.evalAdEligibility(v);if(o=w.eligible,x=w.skipWrapping,I.push(...w.reasons),o||(this.ineligiblePosts+=1),t(h.querySelectorAll("a")).forEach((e=>{(e.href.includes("twitter.com")||e.href.includes("x.com"))&&e.href.includes("/status")&&!e.classList.contains("QuoteTweet-link")&&(a=e.href)})),c=h.innerText||h.textContent,p=h.shadowRoot||h.contentDocument,!p&&h.contentWindow)try{p=h.contentWindow.document}catch(e){}if(null==a&&p)for(u=p.querySelectorAll("div"),A=0;A<u.length;A++)b=u[A],y=b.getAttribute("data-click-to-open-target"),y&&y.length&&!b.classList.contains("QuoteTweet-link")&&!b.classList.contains("QuoteTweet")&&(a=y);let S=null==a?"":a.split("/")[5].split("?")[0];const E=n.getAttribute("data-tweet-id")||"";if(!S&&n.hasAttribute("data-tweet-id")&&E.length>0)S=E,a="https://twitter.com/username/status/"+S;else if(!S&&n.hasAttribute("data-tweetid")){const e=n.getAttribute("data-tweetid")||"";e.length>0&&(S=e,a="https://twitter.com/username/status/"+S)}else if(!S&&n.children&&n.children.length){const e=n.children[0],t=e&&e.getAttribute("data-tweet-id")||"";e&&e.hasAttribute("data-tweet-id")&&t.length>0&&(S=t,a="https://twitter.com/username/status/"+S)}else if(!S&&n.querySelector("iframe")){const e=n.querySelector("iframe"),t=(null==e?void 0:e.src)||"";t&&t.length&&t.includes("&id=")&&(S=t.split("&id=")[1].split("&")[0],S&&(a="https://twitter.com/username/status/"+S))}if(!S){if(this.iterations>3)return;return s=1,n.removeAttribute("data-rhp"),void this.standout.logger.SDTLog(29)}this.standout.logger.SDTLogAddEmbedDetails(a,{element:n,embedType:e.EmbedTypes.Twitter,tweetId:S,failure:o?null:"Ineligible: "+I.join(", ")}),i&&i.element&&i.element.classList.add("processed-rh-embed"),this.standout.logger.SDTLog(30,{address:a},n),r=document.createElement("div"),r.setAttribute("data-embed-url",a),r.setAttribute("data-rhp","1"),this.sizeTempContainer(r);const C=r,L=c,D=a;if(!x&&"IFRAME"==n.tagName&&n.className.includes("rm-shortcode")){n.parentElement&&n.parentElement.insertBefore(C,n);const t=()=>{this.checkForRhombusAds(e.EmbedTypes.Twitter,L,D,n,((t,i,s)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,C,D,e.EmbedTypes.Twitter,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(C,"null")}))};x||C.appendChild(n),o?t():x||this.buildWrappingContainer(C,"ineligible")}else if(x)n.setAttribute("data-rhp","1");else{l.parentElement&&l.parentElement.insertBefore(C,l);const t=()=>{this.checkForRhombusAds(e.EmbedTypes.Twitter,L,D,l,((t,i,s)=>{if(t){if(this.rhombusAddedAd&&!this.multipleAds)return;this.buildRhombusContainer(i.decisions,C,D,e.EmbedTypes.Twitter,s),this.rhombusAddedAd=1}else x||this.buildWrappingContainer(C,"null")}))};if("IFRAME"==l.tagName)l.parentElement&&l.parentElement.removeChild(l),k!=l&&k.parentElement&&k.parentElement.removeChild(k),this.standout.logger.SDTLog(31),void 0!==window.twttr&&window.twttr.widgets.createTweet(S,C).then((()=>{o?t():x||this.buildWrappingContainer(C,"ineligible")}));else{C.appendChild(l),o?t():x||this.buildWrappingContainer(C,"ineligible");try{if(!f){for(let e=0;e<l.attributes.length;e++)if(l.attributes[e].nodeName.includes("twitter-extracted")){l.removeAttribute(l.attributes[e].nodeName);break}if(l.classList.contains(g)||l.classList.add(g),void 0!==window.twttr)this.standout.logger.SDTLog(31),window.twttr.widgets.load(C);else{const e="https://platform.twitter.com/widgets.js";document.querySelector('script[src="'+e+'"]')?setTimeout((()=>{void 0!==window.twttr&&window.twttr.widgets.load(C),this.standout.logger.SDTLog(31)}),500):(d(e,1),this.standout.logger.SDTLog(31))}}}catch(e){}}}T.url=a,T.embedType=e.EmbedTypes.Twitter,T.inHeader=I.includes("HEm"),T.ineligibilityReasons=I,null!=a&&this.rhFound[e.EmbedTypes.Twitter].push(T),o||this.postEmbedLoad(a,I)}})),s&&this.iterations<5)return this.ineligiblePosts=0,setTimeout((()=>{this.doRhombusScan(i)}),2e3),this.doingScan=0,this.doingRescan=0,void this.standout.logger.SDTLog(33);this.timeFinishedScan=(new Date).getTime(),this.doingScan=0,this.doingRescan=0;const h={};h.u=window.location.href,h.pt=document.title,h.hn=window.location.hostname,h.sid=o,h.rid=this.standout.session.pageViewId,h.now=(new Date).getTime();const c=this.foundCount();if(0===c&&document.querySelectorAll(".js-appear-on-expand").length&&window.MutationObserver){const e=new MutationObserver(((e,t)=>{if(e.length>0)for(let i=0;i<e.length;i++)e[i].addedNodes.length&&(t.disconnect(),setTimeout((()=>{this.doRhombusScan()}),200))}));this.standout.logger.SDTLog(34);const t=document.querySelector(".js-appear-on-expand");return t&&e.observe(t,{attributeOldValue:1,childList:1,characterData:0,subtree:1}),this.doingScan=0,void(this.doingRescan=0)}if(this.standout.logger.SDTLog(35,null,{embeds:c,ineligibleEmbeds:this.ineligiblePosts}),!this.rhDI&&(!i||i.final)&&0===this.requestCount){if(this.rhDI=1,i&&i.element){if(M(i.element.classList,["processed-rh-hn","processed-rh-embed","processing-rh"]))return;i.element.classList.add("processing-rh")}const e={};Object.keys(this.rhFound).forEach((t=>{this.rhFound[t].forEach((t=>{(t.ineligibilityReasons||[]).forEach((t=>{e[t]=1}))}))}));const t=Object.keys(e);this.recordRequest(0,t?t.join(","):null)}document.querySelector("iframe.mastodon-embed")&&this.standout.logger.recordLogEvent("embed-view",{type:"mastodon"}),document.querySelector('iframe[src*="threads.net/t"]')&&this.standout.logger.recordLogEvent("embed-view",{type:"threads"}),(document.querySelector('iframe[src*="bsky.link/"]')||document.querySelector('iframe[src*="bsky.app/"]'))&&this.standout.logger.recordLogEvent("embed-view",{type:"bluesky"})}evalAdEligibility(e){let t=1;const i=[];return x(e)&&(t=0,i.push("AS")),this.isEmbedInHeader(e)&&(t=0,i.push("HEm")),{eligible:t,skipWrapping:0,reasons:i}}detectEmbedTypeFromSrc(t){const i=t.toLowerCase();return i.includes("spotify")?e.EmbedTypes.Spotify:i.includes("soundcloud.com")?e.EmbedTypes.Soundcloud:i.includes("youtube.com")||i.includes("youtube-nocookie.com")?e.EmbedTypes.Youtube:i.includes("tiktok.com")?e.EmbedTypes.TikTok:i.includes("megaphone.fm")?e.EmbedTypes.Megaphone:i.includes("giphy.com")?e.EmbedTypes.Giphy:i.includes("imgur.com")?e.EmbedTypes.Imgur:i.includes("vimeo.com")?e.EmbedTypes.Vimeo:i.includes("anchor.fm")?e.EmbedTypes.Anchor:i.includes("twitch.tv")?e.EmbedTypes.Twitch:i.includes("reddit.com")||i.includes("redditmedia.com")?e.EmbedTypes.Reddit:i.includes("gfycat.com")?e.EmbedTypes.GfyCat:i.includes("instagram.com/")?e.EmbedTypes.Instagram:i.includes("linkedin.com/")?e.EmbedTypes.LinkedIn:i.includes("embed.music.apple.com/")?e.EmbedTypes.AppleMusic:i.includes("embed.tumblr.com/")?e.EmbedTypes.Tumblr:-1}checkForRhombusAds(e,t,i,s,n){this.rhombusEmbedQueue.push({id:N(),embedType:e,completion:n,caption:t,element:s,url:i,confirmed:0}),this.runningQueue||this.processNextEmbedQueueItem()}checkForEmbedData(e,t,i,s){this.rhombusEmbedQueue.push({id:N(),url:e,completion:s,element:i,skipAdCheck:t}),this.runningQueue||this.processNextEmbedQueueItem()}processNextEmbedQueueItem(){if(this.runningQueue=1,this.rhombusEmbedQueue.length>0){const e=this.rhombusEmbedQueue.shift();if("confirmed"in e&&0!=e.confirmed){if(!this.forceHN){this.checkForAvailableAds(e);const t={url:e.url,embed:e.element,viewed:0};S(t.embed)&&(t.viewed=1,this.recordEmbedView(t)),this.confirmedEmbeds.push(t)}}else{const t={},i=this.standout.page.getPageDataFor(e.element);if(t.url=i.url,t.pageTitle=i.pageTitle,t.embedUrl=e.url,t.siteId=this.standout.serverSettings.siteId,t.shownAsHN=!!this.rhShowingHN,t.ineligibilityReasons=e.ineligibilityReasons,t.mobile=this.standout.device.mobile,t.dT=this.standout.device.deviceType,t.requestId=this.standout.session.pageViewId,t.ses=this.standout.session.sessionId,this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{url:t.embedUrl,embedType:e.embedType}),!t.url||!t.embedUrl)return e.completion(0,null),void this.processNextEmbedQueueItem();this.standout.logger.SDTLog(55,null,t),t.atc=this.standout.page.checkATC(),this.standout.communications.postKSO("embed/check",t,(i=>{if(""===i)e.completion(0,null),this.standout.logger.SDTLog(61),this.processNextEmbedQueueItem();else if("TIMEOUT"===i)e.completion(0,"Timeout"),this.standout.logger.SDTLog(62),this.processNextEmbedQueueItem();else{let n=null;try{n=JSON.parse(i)}catch(e){n=null}if(this.standout.logger.SDTLog(63,null,n),n&&this.standout.serverSettings.processServerSettings(n),n&&n.embedData&&("title"in n.embedData||"caption"in n.embedData||"contents"in n.embedData||"username"in n.embedData)){var s;this.standout.logger.SDTLog(64,null,n.embedData);const i={};if(i.id=e.id,i.element=e.element,i.url=e.url,i.canonicalEmbedUrl=n.embedData.url||e.url,i.cci=n.cci,i.embedType=n.embedData.embedType,(null==(s=this.rhFound[n.embedData.embedType])?void 0:s.length)>0)for(let t=0;t<this.rhFound[n.embedData.embedType].length;t++){const i=this.rhFound[n.embedData.embedType][t];i.url==e.url&&(this.rhFound[n.embedData.embedType][t]=i)}if(i.targetIds=n.embedData.targetIds,n.psegs&&(i.targetIds=(i.targetIds||[]).concat(n.psegs)),i.geoSegments=n.geoSegments,i.confirmed=1,i.blacklisted="blacklisted"in n?n.blacklisted:0,i.pageBlacklisted="pageBlacklisted"in n?n.pageBlacklisted:0,i.whitelistedCampaigns="whitelistedCampaigns"in n?n.whitelistedCampaigns:null,i.blacklistReason="blacklistReason"in n?n.blacklistReason:-1,this.whitelistedCampaigns=i.whitelistedCampaigns,this.blacklisted=i.blacklisted||i.pageBlacklisted,this.standout.settings.overrideBlocklist&&(i.blacklisted=0,i.pageBlacklisted=0,this.blacklisted=0),this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,i),i.completion=e.completion,i.blacklisted&&(!i.whitelistedCampaigns||0==i.whitelistedCampaigns.length)||this.blacklisted&&(!this.whitelistedCampaigns||0==this.whitelistedCampaigns.length))return this.standout.logger.SDTLog(65,null,n.embedData),!i.blacklisted||2!=i.blacklistReason||i.whitelistedCampaigns&&!i.whitelistedCampaigns.length?!i.blacklisted||i.whitelistedCampaigns&&!i.whitelistedCampaigns.length?!i.pageBlacklisted||this.whitelistedCampaigns&&0!=this.whitelistedCampaigns.length?!this.blacklisted||this.whitelistedCampaigns&&0!=this.whitelistedCampaigns.length||this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{failure:"Other Embed Blocklisted"}):this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{failure:"Page Blocklisted"}):this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{failure:"Embed Blocklisted"}):this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{failure:"Embed Excluded"}),i.completion(0,"Blocklisted"),void this.processNextEmbedQueueItem();if("skipAdCheck"in e&&0!=e.skipAdCheck||this.forceHN)e.completion(0,"Skipped"),this.standout.logger.SDTLog(66),this.processNextEmbedQueueItem();else{this.checkForAvailableAds(i);const s={url:t.embedUrl,embed:e.element,viewed:0};S(s.embed)&&(s.viewed=1,this.recordEmbedView(s)),this.confirmedEmbeds.push(s)}}else e.completion(0,"Unknown"),this.standout.logger.SDTLogAddEmbedDetails(t.embedUrl,{failure:"Embed Not Known"}),this.standout.logger.SDTLog(67),this.processNextEmbedQueueItem()}}))}}else this.runningQueue=0}checkForAvailableAds(e){if(this.rhombusAddedAd&&!this.multipleAds||this.blockTypes&&this.blockTypes.includes(""+e.embedType))this.standout.logger.SDTLog(71),e.completion(0,null),this.processNextEmbedQueueItem();else{const i=this.standout.settings.doDemo;if(i)if(i.startsWith("celtra_"))this.standout.communications.postKSO("demo/ctr",{id:i.split("celtra_")[1]},(t=>{let s={rhu:{contents:[{body:this.standout.renderer.generateCeltraTag(i.split("celtra_")[1])}]},rhl:null};if(this.demoSettings={},t&&"TIMEOUT"!==t)try{const e=JSON.parse(t);e&&e.id&&(s={rhu:{contents:[{body:this.standout.renderer.generateCeltraTag(e.id)}]},rhl:null})}catch(e){}e.completion(1,{decisions:s},e)}));else if(i.startsWith("km_"))this.standout.communications.postKSO("demo/kmr",{id:i.split("km_")[1],cat:1,dev:this.standout.page.kargoDevDemoSite},(t=>{let i={rhu:{contents:[{}]},rhl:null};if(this.demoSettings={},t&&"TIMEOUT"!==t)try{const e=JSON.parse(t);e&&e.snippet&&(i={rhu:{contents:[{body:e.snippet}]},rhl:null})}catch(e){}e.completion(1,{decisions:i},e)}));else if(i.startsWith("dm_"))this.standout.communications.postKSO("demo/dmr",{id:i.split("dm_")[1],cat:1,dev:this.standout.page.kargoDevDemoSite},(t=>{let i={rhu:{contents:[{}]},rhl:null};if(this.demoSettings={},t&&"TIMEOUT"!==t)try{const e=JSON.parse(t);e&&e.snippet&&(i={rhu:{contents:[{body:e.snippet}]},rhl:null})}catch(e){}e.completion(1,{decisions:i},e)}));else if(i.startsWith("db_"))this.standout.communications.postKSO("demo/kmd",{id:i.split("db_")[1],dev:this.standout.page.kargoDevDemoSite},(t=>{let i={rhu:{contents:[{}]},rhl:null};if(this.demoSettings={},t&&"TIMEOUT"!==t)try{const e=JSON.parse(t);e&&e.snippet&&(i={rhu:{contents:[{body:e.snippet}]},rhl:null})}catch(e){}e.completion(1,{decisions:i},e)}));else if(i.startsWith("celtratag_")){let t={rhu:{contents:[{body:this.standout.renderer.generateCeltraTag(i.split("celtratag_")[1])}]},rhl:null};e.completion(1,{decisions:t},e)}else{const t={};t.demo=i,this.demoSettings={},this.standout.logger.SDTLog(56,null,t),this.standout.communications.postKSO("demo/ast",t,(t=>{if(""===t)this.processNextEmbedQueueItem();else if("TIMEOUT"===t)e.completion(0,"Timeout"),this.standout.logger.SDTLog(62),this.processNextEmbedQueueItem();else{var i,s,n,o,a,l,d;let h=null;try{h=JSON.parse(t)}catch(e){h=null}const c=null==(i=h)?void 0:i.upper,p=null==(s=h)?void 0:s.lower;let g={rhu:{contents:[{body:c}]},rhl:null};if(this.demoSettings=(null==(n=h)?void 0:n.settings)||{},p&&p.length&&(g.rhl={contents:[{body:p}]}),null!=(o=h)&&o.overlay&&(g.rho=h.overlay),null!=(a=h)&&a.bg&&(g.rhbg=h.bg),(null!=(l=h)&&l.creativeType||null!=(d=h)&&d.cType)&&(g.ct=h.creativeType||h.cType),g.cci=e.cci,"kraken"===g.ct){let e=r(c,"w.Kargo.ads.push(");e=r(e,"kraken:","})");const t=JSON.parse(e);g={targetIds:null,rhu:{contents:[{body:c}]},rhl:null,cci:null,pb:1,adSlot:"demo",bid:{format:JSON.parse(r(atob(t.adm),'krg_ad_info":',"--\x3e")||"{}").format,bidderCode:"kargo"}},this.deferForViewability=1}e.completion(1,{decisions:g},e),this.standout.logger.SDTLog(69,null,h)}}))}else{var t;if(this.standout.settings.disableAdRendering||!this.standout.serverSettings.productsEnabled.sc)return e.completion(0,null),void this.processNextEmbedQueueItem();this.standout.bidStack.pbEnabled&&null!=(t=(this.standout.settings.requests||{})[this.standout.session.pageViewId])&&t.slotIds?e.blacklisted||e.pageBlacklisted||this.blacklisted?(e.completion(0,"Blocklisted"),this.processNextEmbedQueueItem()):this.standout.bidStack.runPbjs(e):(this.shouldShowHN=1,this.processNextEmbedQueueItem())}}}checkIfElementProcessed(e){let t=0;e&&e.hasAttribute("data-rhp")&&"1"===e.getAttribute("data-rhp")&&(t=1);let i=e;for(;!t&&(i=(null==(s=i)?void 0:s.parentElement)||null);){var s;i&&i.hasAttribute("data-rhp")&&"1"===i.getAttribute("data-rhp")&&(t=1)}return t}isEmbedInHeader(e){const t=this.runIsEmbedInHeaderCheck(e);return t&&this.standout.logger.SDTLog(36,null,e),t}runIsEmbedInHeaderCheck(e){let t=null;if(window.pageYOffset+e.getBoundingClientRect().top<575)return 1;let i=m(e,["c-picture--video"]);if(i&&i.previousElementSibling&&"HEADER"==i.previousElementSibling.tagName)return 1;if(i=m(e,["page-header","content-header","article_hero","article-featured-img","content-topper","c-featured-media","featured-media","wp-caption","entry-header","article__header","article-info","page-precontent","lead-carousel","lead-container","entry-media--lead-video"]),i)return 1;if(i=u(e,"figure.wp-block-embed:first-child"),i&&i.parentElement&&i.parentElement.classList&&i.parentElement.classList.contains("entry-content"))return 1;if(i=((e,t)=>{for(;"HEADER"!=(null==(i=e)?void 0:i.tagName)&&(e=null==(s=e)?void 0:s.parentElement);)var i,s;return e||null})(e),i)return 1;if(i=m(e,["media-display"]),i){const e=b(i);if(e&&e.classList.contains("social-share"))return 1}if(e.parentElement&&!b(e)){if(t=b(e.parentElement),t&&"HEADER"==t.tagName)return 1;if(t=b(t||void 0),t&&"HEADER"==t.tagName)return 1}if(e.parentElement&&e.parentElement.parentElement&&e.parentElement.parentElement.id&&("video-container"==e.parentElement.parentElement.id||"embed-container"==e.parentElement.parentElement.id)){if(t=b(e.parentElement.parentElement),t&&"HEADER"==t.tagName)return 1;if(t=b(t||void 0),t&&"HEADER"==t.tagName)return 1}return 0}sizeTempContainer(e){e.addEventListener("mousedown",(e=>this.didMouseDown(e)));let t="width: 100%",i="max-width: 500px";(window.location.href.toLowerCase().includes(".al.com/")||window.location.href.toLowerCase().includes("//al.com/"))&&(t=""),e.innerHTML.includes("tiktok.com/embed")&&(t="width: 340px",i="max-width: 100%"),e.innerHTML.includes("spotify.com/")&&(t="",i=""),e.outerHTML.includes("youtube.com")||e.outerHTML.includes("youtube-nocookie.com")||(e.style.cssText=i+";"+t+";min-width:220px;margin:10px auto !important;")}buildWrappingContainer(e,t){var i,s;const n=e.firstElementChild;if(((e,t)=>{const i=e.src||e.getAttribute("data-src");for(const t of["youtube.","youtube-nocookie.","vimeo.com/","twitch.tv/","tiktok.com/","embed.music.apple.com/"])if("IFRAME"==e.tagName&&i.includes(t)||e.firstChild&&"IFRAME"==e.firstChild.tagName&&e.firstChild.src.includes(t))return 1;return 0})(e)||n&&null!=(i=n.classList)&&i.contains("tiktok-embed")||null!=(s=e.classList)&&s.contains("single-post-oembed-youtube-wrapper"))t.length&&e.classList.add("rh-"+t);else{if(this.standout.logger.SDTLog(86,null,e),e.children&&e.children.length){const t=e.children[0];t&&t.style&&t.style.setProperty("transform","initial","important")}e.classList.add("rna-container"),t.length&&e.classList.add("rh-"+t),this.sizeTempContainer(e)}}buildRhombusContainer(t,i,s,n,o){if(this.rhombusAddedAd&&!this.multipleAds||this.standout.settings.disableAdRendering)return;this.rhombusAddedAd=1;const a=N(),l="rhic"+a,r="rhus"+a,d="rhls"+a;let h,c=0,p=0,g=null;n!=e.EmbedTypes.Youtube&&n!=e.EmbedTypes.Vimeo&&n!=e.EmbedTypes.Twitch||(c=1),this.observeEmbedSize(i,-40,l);const b=i.parentElement;if(b&&b.classList.contains("fluid-width-video-wrapper"))n!=e.EmbedTypes.Spotify||"initial"==b.style.paddingBottom&&"initial"==window.getComputedStyle(b,null).getPropertyValue("padding-bottom")?n!=e.EmbedTypes.Spotify||"initial"==b.style.paddingTop&&"initial"==window.getComputedStyle(b,null).getPropertyValue("padding-top")||(p=1,g=b.style.paddingTop):(p=1,g=b.style.paddingBottom),b.style.setProperty("padding-top","initial","important");else if(n==e.EmbedTypes.Spotify&&i.children&&1==i.children.length){const e=i.children[0];e&&e.height&&e.width&&(p=1,g=e.clientHeight+"px")}const y=m(i,["InlineVideo__container"]);if(y){y.style.paddingBottom="initial";const e=m(i,["InlineVideo__video-wrapper"]);e&&(e.style.height="initial",e.style.position="initial");const t=m(i,["Video"]);t&&(t.style.background="initial");const s=m(i,["YoutubeVideo"]);s&&(s.style.height="initial")}const f=u(i,"figure");f&&(f.style.marginLeft="auto",f.style.marginRight="auto");const v=u(i,'div[class*="sc-"][class*="-wrapper"]');v&&(v.style.display="block");const w=u(i,"div[data-external-embed]");w&&(w.style.minHeight="auto"),b&&(M(b.classList,["w-youtube","w-video","embed-youtube","youtube-embed","embed-responsive","responsive-container","video-embed","video_embed","video-wrap","video-embed-code","video-container","iframe-content","fr-video","fluid-vids","flex-video","video-wrapper","article-video-lead-youtube-container","video-responsive__wrapper"])||b.className.includes("embedly_player_container")||"video-embed"==b.id||"video_embed"==b.id||"video-container"==b.id||"FIGURE"==b.tagName&&("initial"!=b.style.paddingBottom||"initial"!=window.getComputedStyle(b,null).getPropertyValue("padding-bottom")||"initial"!=b.style.paddingTop||"initial"!=window.getComputedStyle(b,null).getPropertyValue("padding-top"))||c&&("initial"!=b.style.paddingBottom||"initial"!=window.getComputedStyle(b,null).getPropertyValue("padding-bottom")||"initial"!=b.style.paddingTop||"initial"!=window.getComputedStyle(b,null).getPropertyValue("padding-top")))?(!b.classList.contains("video-embed")||"initial"==b.style.paddingBottom&&"initial"==window.getComputedStyle(b,null).getPropertyValue("padding-bottom")&&"initial"==b.style.paddingTop&&"initial"==window.getComputedStyle(b,null).getPropertyValue("padding-top")||(p=1,g=b.style.paddingBottom),b.style.setProperty("padding-top","initial","important"),b.style.setProperty("padding-bottom","initial","important"),b.style.setProperty("margin-left","0","important"),b.style.setProperty("height","initial","important"),q(["floor8.com","12up.com"])&&"FIGURE"==b.tagName&&b.style.setProperty("background-color","initial")):b&&"AMP-YOUTUBE"==b.tagName&&this.fixAmpSpacer(i),this.fixAmpSizing(i);const S=this.standout.serverSettings.siteId||"";b&&b.classList.contains("code")&&"1102732"==S&&b.style.setProperty("width","100%");const k=null==b?void 0:b.parentElement;let T;if(k&&k.classList&&(k.classList.contains("jetpack-video-wrapper")||k.classList.contains("embed-responsive"))&&(k.style.setProperty("padding-top","initial","important"),k.style.setProperty("padding-bottom","initial","important"),k.style.setProperty("height","initial","important"),k.classList.remove("jetpack-video-wrapper")),k&&k.classList&&k.classList.contains("wp-block-embed")&&!k.classList.contains("aligncenter")&&(k.style.setProperty("margin-left","0","important"),k.style.setProperty("margin-right","0","important"),k.style.setProperty("height","initial","important"),k.style.setProperty("padding-bottom","initial","important"),k.style.setProperty("width","initial","important")),b&&(b.classList.contains("cs-embed-responsive")||b.classList.contains("wp-block-embed__wrapper"))&&(T="rh"+N(),b.classList.add(T),b.parentElement)){const e=document.createElement("style");e.innerHTML="."+T+"::before { padding-top:initial !important; }",b.parentElement.insertBefore(e,b)}const A=u(i,".wp-block-embed__wrapper");if(A&&A.parentElement){const e=T||"rh"+N();A.classList.add("wpe"+e);const t=document.createElement("style");t.innerHTML=".wpe"+e+"::before { padding-top:initial !important; }",A.parentElement.insertBefore(t,A)}const E=i.previousElementSibling;E&&""===(E.innerHTML||"").trim()&&E.style.paddingTop&&E.style.paddingBottom&&E.style.setProperty("display","none","important");let C=0,I=null;if((i.hasAttribute("data-yt-skip")||p)&&!i.classList.contains("single-post-oembed-youtube-wrapper")){const e=document.createElement("div");if(b&&b.insertBefore(e,i),e.appendChild(i),I=document.createElement("div"),I.className="vid-container",I.style.marginLeft="auto",I.style.marginRight="auto",g)I.style.setProperty("padding-bottom",g,"important");else if(i.getAttribute("width")&&i.getAttribute("height")&&!(i.getAttribute("height")||"").includes("%")&&!(i.getAttribute("width")||"").includes("%"))h=Number(parseInt(i.getAttribute("height")||"0"))/Number(parseInt(i.getAttribute("width")||"1"))*100,I.style.setProperty("padding-bottom",h+"%","important"),window.location.href.toLowerCase().includes("cracked.com")&&(I.style.setProperty("max-height",(i.getAttribute("height")||"0")+"px","important"),I.style.setProperty("max-width",(i.getAttribute("width")||"0")+"px","important"),C=1);else if(i.getAttribute("data-width")&&i.getAttribute("data-height")){const e=Number(parseInt(i.getAttribute("data-height")||"0"))/Number(parseInt(i.getAttribute("data-width")||"1"))*100;I.style.setProperty("padding-bottom",e+"%","important"),i.style.height="100%",i.style.width="100%"}i.style.setProperty("max-width","100%","important"),i.style.setProperty("max-height","100%","important");const t=i;"IFRAME"==t.tagName&&!t.hasAttribute("src")&&t.hasAttribute("data-src")&&(t.src=t.getAttribute("data-src")),i.dataset.originalClientWidth&&(I.style.width=i.dataset.originalClientWidth+"px",Number(i.dataset.originalClientWidth)<e.clientWidth-40&&(e.style.width=Number(i.dataset.originalClientWidth)+40+"px",C=1)),I.appendChild(i),e.appendChild(I),e.setAttribute("data-embed-url",i.getAttribute("data-embed-url")||""),e.setAttribute("data-rhp","1"),this.sizeTempContainer(e),i=e}if(this.standout.logger.SDTLog(80,null,i),this.watchContainer(i),this.invertPlacements){const e=t.rhu;t.rhu=t.rhl,t.rhl=e}this.embedUrlWithAd=s,this.standout.logger.SDTLogAddEmbedDetails(s,{happeningNow:this.rhShowingHN});const x=document.createElement("div");x.className="rh-spc",x.setAttribute("data-rhc",l),i.nextSibling&&i.parentElement?i.parentElement.insertBefore(x,i.nextSibling):i.parentElement&&i.parentElement.appendChild(x),i.addEventListener("mousedown",(e=>this.didMouseDown(e))),i.dataset.bid=a,i.className=this.rhDivClass;const L=this.rhAdditionalClass;L&&(i.className+=" "+L);let D=500,P="500px",_="100%";(window.location.href.toLowerCase().includes(".al.com/")||window.location.href.toLowerCase().includes("//al.com/"))&&(P="initial"),P="100%",_="500px",i.innerHTML.includes("tiktok.com/embed")?(D=380,P="380px",_="100%",this.standout.logger.SDTLog(82)):!i.hasAttribute("data-rh-vid")&&!i.innerHTML.includes("data-rh-vid=")||C||(P="100%",_="100%",this.standout.logger.SDTLog(81,null,I),i.className+=" rhvid"),i.id=l,this.containerElement=i;let R="#e7ebf0";"1097965"==S?R="#d3d3d3":["1133585","1133584","1133586","1133583","1133588","1133587","1130248"].includes(S)&&(R="#abafa4");let O="3px";n==e.EmbedTypes.Twitter&&(O="18px"),i.style.cssText="width:"+P+";max-width:"+_+";min-width:220px;margin:10px auto !important;border:0 solid "+R+";border-radius:"+O+";",i.style.cssText+="clear:both;",b&&M(b.classList,["w-youtube","w-video","embed-youtube","youtube-embed","video-embed-code","embed-responsive","code"])&&(i.style.cssText+="box-sizing:border-box;");const F=document.createElement("style");F.innerHTML=`\n#${l} {padding:20px 20px !important;}\n#${l}.rh-ear, .rh-w-np #${l} {padding:0 0 !important;}\n#${l} #${r} img, #${l} #${d} img{max-width:100% !important;width:unset !important;height: unset;margin-left:unset !important;position:initial;left:initial;top:initial;}\n#${l} #${r} img.rhi, #${l} #${d} img.rhi{margin-left:auto !important;margin-right:auto !important;}\n#${l} div {margin-bottom:0;margin-top:0;vertical-align: top;}\n#${l} > div {z-index: 1;position:relative;}\n#${l} :not(.rhus):not(.rhls) :not(.single-post-oembed.youtube):not(.vid-container) :not(.vid-container):not(.ls_video_embed) iframe {margin:0 0 !important;max-width: 100% !important;position:relative;}\n#${l} .rhus iframe, #${l} .rhls iframe {margin-left: auto !important;margin-right: auto !important;}\n#${l} .rhus .rh-gam-unit-sizer {margin-bottom:10px;}\n#${l} .rhus .rh-gam-unit-sizer div[id^=google_ads_iframe] {max-width:unset !important;}\n#${l} .instagram-media-rendered,#${l} .twitter-tweet-rendered{margin:0 0 !important;max-width:100% !important;width:100% !important;}\n#${l} .instagram-media-rendered > iframe,#${l} .twitter-tweet-rendered > iframe{margin:0 0 !important;max-width:100% !important;width:100% !important;}\n#${l} .fb-post{max-width:100% !important;padding-bottom:0;}\n#${l} .fb-post>span{max-width:100% !important;margin:0 0;max-height: initial !important;}\n#${l} .vid-container {position: relative; overflow: visible; height: 0 !important;padding-bottom:56.25% !important;min-width:100%;max-width:100%;}\n#${l} .vid-container iframe {position: absolute; top: 0; left: 0; width: 100%; height: 100%;min-width:auto;min-height:auto;margin-top:0;}\n#${l} .vid-container amp-youtube {min-height:initial !important;}\n#${l} .kargo-ad-content {max-width:100% !important;transform:initial;left:initial;overflow:hidden;}\n#${l} .kargo-loader.fade {background-color:initial;}\n#${l} .kargo-branding-mobilized {display: none !important;}\n#${l} .kargo-branding-kargo, #${l} .kargo-branding-advertisement {display: none !important;}\n#${l} .kargo-vpaid-mute, #${l} .kargo-vpaid-progress {transform:translateZ(1px);}\n#${l} .youtube-subscribe-bar {margin-top:0;margin-bottom:0;}\n#${l} > blockquote {padding:0;margin:0;border-top:none;border-bottom:none;}\n#${l} > iframe {max-width:100% !important;margin:0 0;}\n#${l} .rhbk {position:absolute;top:0;bottom:0;left:0;right:0;border-radius:18px;z-index:0;}\n#${l} .rhbk div {border-radius:${O}}\n#${l} .rhfr {position:absolute;top:0;bottom:0;left:0;right:0;border-radius:18px;z-index:15;pointer-events:none;}\n#${l} .rhfr div {border-radius:${O}}\n#${l} .rhus {z-index:5;}\n#${l} .rhls {z-index:5;position:relative;}\n#${l} .rhkad { position:relative; }\n.rh-spc[data-rhc="${l}"] {display: none;}\n@media only screen and (max-width: 767px) {\n.rh-spc[data-rhc="${l}"] {display: block;height:0;}\n#${l}.rh-ka { position: absolute; left: 0; right: 0; background-color: white; padding: 20px 20px !important; border-left: none !important; border-right: none !important; border-radius: 0 !important; }\n#${l}.rh-ka .rhkad { height: initial !important; }\n#${l}.rh-ka .rhkad .rhkcic { position: initial !important; transform: initial !important; }\n}\n.hn-container-left #${l} {margin: 10px 0 !important;}\n.hn-container.collapsed {margin-top:0 !important;margin-bottom:0 !important;}\n`,document.head.appendChild(F);const B=i.children[0];if(B){B.style.setProperty("transform","initial","important"),B.style.setProperty("min-width","initial"),B.classList&&B.classList.contains("single-post-oembed")&&(B.style.maxWidth="100%",B.style.marginLeft="auto",B.style.marginRight="auto"),n!=e.EmbedTypes.Spotify||p||(B.style.setProperty("padding-bottom","initial","important"),B.style.setProperty("height","initial","important"));const t=B;if(t.src&&t.src.includes("gfycat.com"))h=B.clientHeight/B.clientWidth,B.style.position="relative",B.style.height=B.clientWidth*h+"px",B.parentElement&&B.parentElement.parentElement&&(B.parentElement.parentElement.style.paddingBottom="initial"),this.standout.logger.SDTLog(83,{ratio:h,height:B.style.height},B);else if(B.hasAttribute&&B.hasAttribute("height")&&B.hasAttribute("width")&&!(B.getAttribute("height")||"").includes("%")&&!(B.getAttribute("width")||"").includes("%"))t.src&&t.src.includes("ajax/inset/iframe")||(t.src&&(t.src.includes("spotify.com")||t.src.includes("anchor.fm/"))?Number(parseInt(t.width))!=D&&(h=D/Number(parseInt(t.width)),t.width=Number(parseInt(t.width))*h,this.standout.logger.SDTLog(84,{ratio:h,width:t.width},B)):(h=B.clientWidth/Number(parseInt(t.width)),t.dataset.height=h*Number(parseInt(t.height))+"px",t.height=h*Number(parseInt(t.height)),B.style.height=t.height+"px",this.standout.logger.SDTLog(84,{ratio:h,height:t.height},B))),this.protectHeight(B,1);else if(t.src&&t.src.includes("instagram.com/")){if(t.height<=16&&(t.height=714,t.dataset.height="714px",B.style.height=t.height+"px"),B.clientWidth<parseInt(P)){h=parseInt(P)/B.clientWidth;const e=B.clientHeight*h;e<3*t.width&&e&&(t.dataset.width=parseInt(P)+"px",t.dataset.height=e+"px",t.width=parseInt(P),t.height=e,B.style.width=t.width+"px",B.style.height=t.height+"px",this.standout.logger.SDTLog(85,{width:t.width,height:t.height},B))}this.protectHeight(B,1)}else(t.src&&t.src.includes("embed.tumblr.com/embed")||t.src&&t.src.includes("embed.music.apple.com/"))&&(B.style.width="100%")}const H=document.createElement("div");H.className="rhus fitvidsignore",H.id=r,i.insertBefore(H,i.firstChild);const W=document.createElement("div");W.className="rhls fitvidsignore",W.id=d,i.appendChild(W),this.createBanners(t,r,d,s,i,0,o.canonicalEmbedUrl,n,0)}fixAmpSpacer(e){if(e.parentElement){const t=e.parentElement.querySelector("i-amphtml-sizer");t&&(t.style.paddingTop="0")}}fixAmpSizing(e){const t=u(e,'amp-iframe[layout="fixed-height"]');if(t){const i=t.style.height;t.style.height="initial";const s=t.querySelector(".amp-active");s&&(s.style.position="initial");const n=e.querySelector(".i-amphtml-fill-content");n&&(n.style.position="initial",n.style.height="initial",i&&(n.style.height=i))}const i=e.querySelector("amp-twitter");if(i){i.style.marginTop="-10px",i.style.marginBottom="-10px";const e=i.querySelector("iframe");e&&(e.src=e.src+"")}}setPbadSize(e,t){if(this.disableResizing)return;const i=this.containerElement;let s=20;if(window.getComputedStyle&&i){const e=window.getComputedStyle(i).getPropertyValue("padding-left"),t=parseFloat(e);isNaN(t)||(s=t)}let n=t;i&&(n=i.clientWidth-2*s,e.parentElement&&e.parentElement.parentElement&&"0px"==e.parentElement.parentElement.style.borderWidth&&(n-=2));let o=Number(e.dataset.originalWidth);const a=Number(e.dataset.originalHeight);isNaN(o)&&(o=n);let l=e.querySelector(".rhpbcic,.rhkcic");if((300==o&&250==a||o<a)&&o<n){if(a>0&&(e.style.maxHeight=a+"px",e.style.height=a+"px"),e.dataset.originalOverlap){const t=a/(Number(e.dataset.heightBasis)||a)*Number(e.dataset.originalOverlap);e.parentElement&&e.parentElement.classList.contains("rhls")?e.style.marginTop="-"+t+"px":e.style.marginBottom="-"+(t-8)+"px"}l&&(l.style.minWidth=o+"px",l.style.maxWidth=o+"px",l.style.transformOrigin="0 0",l.style.transform="translateX(-50%)",l.style.position="absolute",l.style.left="50%",l.style.setProperty("margin","0 0","important"))}else{let t=n;if(t>1.45*o&&(t=1.4*o),a>0&&(e.style.maxHeight=a*(t/o)+"px",e.style.height=a*(t/o)+"px"),e.dataset.originalOverlap){const i=a*(t/o)/(Number(e.dataset.heightBasis)||a*(t/o))*Number(e.dataset.originalOverlap);e.parentElement&&e.parentElement.classList.contains("rhls")?e.style.marginTop="-"+i+"px":e.style.marginBottom="-"+(i-8)+"px"}if(e.dataset.heightBasis&&l&&(l.style.height=Number(e.dataset.heightBasis)+Number(e.dataset.originalOverlap)+"px"),l){l.style.minWidth=o+"px",l.style.maxWidth=o+"px",l.style.transformOrigin="0 0";const e=t/o;l.querySelector(".kargo-video-player"),l.style.transform="scale("+e+","+e+") translateX(-50%)",l.style.position="relative",l.style.left="50%",l.style.setProperty("margin","0 0","important")}}}createBanners(e,t,i,s,n,o,a,l,r){n.dataset.sc_et=l+"";const d=Math.max(0,n.clientWidth-40);if(this.recordedFill=0,n.hasAttribute("data-at"))return 0;if(this.deferredData[n.id]||(this.deferredData[n.id]={decisionData:e,upperId:t,lowerId:i,embedUrl:s,rhombusContainer:n,iLP:o,canonicalEmbedUrl:a,embedType:l}),(this.deferForViewability||this.standout.bidStack.deferForViewability)&&!r&&!S(n))return this.standout.logger.SDTLog(90),0;if(f(n))return this.standout.logger.SDTLog(91),this.deferForViewability||this.standout.bidStack.deferForViewability||setTimeout((()=>{this.createBanners(e,t,i,s,n,o,a,l,r)}),150),0;if("relative"!=n.style.position&&"absolute"!=n.style.position&&(n.style.position="relative"),Object.keys(this.deferredData).length>1){const e=v(n);let t=0;if(Object.keys(this.deferredData).forEach((i=>{if(i!=n.id&&this.deferredData[i].rendered){const s=v(this.deferredData[i].rhombusContainer);s.bottom<e.top-200||s.top>e.bottom+200||(t=1)}})),t)return 0}if(x(n))return this.removeBorders(n),void this.standout.logger.SDTLog(92);this.standout.logger.SDTLog(93),n.setAttribute("data-at","1"),this.deferredData[n.id].rendered=1,this.deferredData[n.id].filled=0;const p=[];(this.winningTargetIds||[]).forEach((e=>{p.push('"'+e+'"')}));const m=p.join(",");let u,b,y,w,k="",T="",A=[],E=0,C=0,L=0,D=null;const N=/\[(.*?)\], *'gpt-/gi;let P=null;if(e.rhu){const r=e.rhu.contents;if(n.setAttribute("data-et",l+""),e.pb&&(n.setAttribute("data-kas",e.adSlot),this.deferredData[n.id].targetSegments=e.targetIds||null),r&&r.length>0&&(!this.invertPlacements||!this.rhShowingHN||this.rhSLP)&&!o){let o=_(r[0].body);const l=n.querySelector("#"+t);if(!l)return 0;if(o.includes("w.Kargo.ads.push({")){let e="w.Kargo.ads.push({";e=e+="social_canvas_segments: ["+m+"],",e=e+='social_embed_url: "'+a+'",',e=e+='companion_div: "'+i+'_inner",',e=e+='sc_background_div: "'+t+'_rhbk",',e=e+='sc_foreground_div: "'+t+'_rhfr",',o=o.replace("w.Kargo.ads.push({",e)}if(this.standout.logger.SDTLogAddEmbedDetails(s,{upperContents:r}),l.addEventListener("mousedown",I),P=N.exec(o),this.standout.logger.SDTLog(95,null,l),o.includes("definePassback"))this.rhBuildPB(o,l,"upper","gam"),this.standout.logger.recordLogEvent("cb-define-pb");else if(o.includes("googletag.defineSlot")&&P&&P.length>1&&P[1].includes(","))this.standout.logger.recordLogEvent("cb-gt-define-slot"),k=this.setGAMTargeting(o,"upper"),u=l,b=document.createElement("div"),b.className="rhpbad",b.dataset.originalWidth=Number(P[1].split(",")[0])+"",b.dataset.originalHeight=Number(P[1].split(",")[1])+"",l.appendChild(b),y=document.createElement("div"),y.className="rhpbcic",b.appendChild(y),this.fixIframeHeight(y),u=y,this.setPbadSize(b,d),A=g(k||""),A.forEach((e=>{if(e instanceof HTMLElement&&"SCRIPT"===e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&u.appendChild(t)}else c(e),u.appendChild(e)})),w=l.querySelectorAll("a img"),w.length&&(w[0].className="rhi ggnoads",w[0].style.transform="none");else{if(k=this.setGAMTargeting(o,"upper"),u=l,o.includes("Kargo.loadAds")||o.includes("krg_ad_info")||o.includes("celtra-ad")){const i=document.createElement("div");i.className="rhbk",i.id=t+"_rhbk",n.insertBefore(i,n.children[0]);const s=document.createElement("div");if(s.className="rhfr",s.id=t+"_rhfr",n.appendChild(s),new MutationObserver((e=>{if(e)for(let t=0;t<e.length;t++)if(e[t].addedNodes&&e[t].addedNodes.length)for(let i=0;i<e[t].addedNodes.length;i++){const s=e[t].addedNodes[i];if(s.classList&&s.classList.contains("celtra-ad-v3"),"IFRAME"==s.tagName){const e=s;e.addEventListener("load",(()=>{var t;const i=null==(t=e.contentWindow)?void 0:t.creative;i&&(i.unitSizes.banner.width=200,i.unitSizes.banner.height=200,i.units.banner.widthBreakpoints[0].width=200,i.units.banner.widthBreakpoints[0].height=200,i.units.banner.variants[0].layouts[0].designTimeSize.width=200,i.units.banner.variants[0].layouts[0].designTimeSize.height=200,i.units.banner.variants[0].layouts[0].minSize.width=200,i.units.banner.variants[0].layouts[0].minSize.height=200)}))}}})).observe(s,{childList:1,subtree:1}),b=document.createElement("div"),b.className="rhkad",this.demoSettings&&this.demoSettings.upper&&"overlap"==this.demoSettings.upper.style&&(b.dataset.originalOverlap=this.demoSettings.upper.overlap+"",b.dataset.heightBasis=this.demoSettings.upper.height+"",b.dataset.widthBasis=this.demoSettings.upper.width+"",b.style.marginBottom="-"+(this.demoSettings.upper.overlap-8)+"px"),this.demoSettings&&"sticky"==this.demoSettings.effect&&this.stickCreative(b,"top"),l.appendChild(b),this.demoSettings&&this.demoSettings.background&&this.demoSettings.background.source||e.rhbg){let t;t=g(this.demoSettings&&this.demoSettings.background&&this.demoSettings.background.source?this.demoSettings.background.source:e.rhbg),t.forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&i.appendChild(t)}else c(e),i.appendChild(e)}))}if(this.demoSettings&&this.demoSettings.frame&&this.demoSettings.frame.source||e.rho){let t;t=g(this.demoSettings&&this.demoSettings.frame&&this.demoSettings.frame.source?this.demoSettings.frame.source:e.rho),t.forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&s.appendChild(t)}else c(e),s.appendChild(e)}))}y=document.createElement("div"),y.className="rhkcic",y.style.position="absolute",b.appendChild(y),this.fixIframeHeight(y),u=y,C=1,"pop"!=e.ct&&"wrapper-pop"!=e.ct||this.addPopModifiers(n),this.standout.bidStack.pbEnabled&&e.bid&&this.recordPbAdImpressionForContainer(n,e.bid,e.auctionId),this.observeKU(y,l.clientWidth,l.id,"upper",n)}if(e.bid&&"kargo"!=e.bid.bidderCode){var q,M,R,O,F;b=document.createElement("div"),b.className="rhpbad",b.dataset.originalWidth=Number(e.bid.width)+"",b.dataset.originalHeight=Number(e.bid.height)+"",l.appendChild(b),y=document.createElement("div"),y.className="rhpbcic",b.appendChild(y),this.fixIframeHeight(y),u=y,this.setPbadSize(b,d);const t=document.createElement("iframe");t.style.cssText="overflow:hidden;border:none;margin:0 0;box-shadow:none;",t.style.width=e.bid.width+"px",t.style.height=e.bid.height+"px",u.appendChild(t);const i=t.contentWindow;i&&i.document&&i.document.open(),(k||"").includes("<body"),null==i||null==(q=i.document)||q.write(k),null==i||null==(M=i.document)||M.close(),((null==i||null==(R=i.document)?void 0:R.style)||{}).overflow="hidden",(((null==i||null==(O=i.document)?void 0:O.body)||{}).style||{}).margin="0 0",(((null==i||null==(F=i.document)?void 0:F.body)||{}).style||{}).padding="0 0",t.dataset.height=e.bid.height+"px",t.dataset.width=e.bid.width+"px",this.standout.bidStack.pbEnabled&&(this.recordPbAdImpressionForContainer(n,e.bid,e.auctionId),this.containerElement&&this.readdBorders(this.containerElement))}else A=g(k||""),A.forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&u.appendChild(t),C&&!L&&(L=1)}else c(e),u.appendChild(e)}));this.observeGA(l,l.clientWidth,l.id,"upper"),w=l.querySelectorAll("a img"),w.length&&(w[0].className="rhi ggnoads",w[0].style.transform="none")}if(e.bid&&"kargo"!=e.bid.bidderCode)l.style.setProperty("margin-bottom","10px","important");else{const e=document.createElement("img");this.setRhLogo(e);const t=document.createElement("a");t.href="https://kargo.com/privacy",t.setAttribute("target","_blank"),t.style.cssText="z-index:4;position:relative;",t.className="",t.appendChild(e),l.appendChild(t)}this.rhFilledSlots=(this.rhFilledSlots||0)+1}}else if(e.waitForGam){const i=n.querySelector("#"+t);i&&this.standout.bidStack.createGamContainer(i,e.auctionId)}if(e.rhl&&!this.disableLower){const t=e.rhl.contents;if(t.length>0&&(!this.rhShowingHN||this.rhSLP||this.invertPlacements)){this.standout.logger.SDTLogAddEmbedDetails(s,{lowerContents:t});let o=_(t[0].body);if(o.includes("w.Kargo.ads.push({")&&(o=o.replace("w.Kargo.ads.push({","w.Kargo.ads.push({social_canvas_segments: ["+m+'],social_embed_url: "'+a+'",')),D=n.querySelector("#"+i),!D)return 0;D.addEventListener("mousedown",I),this.standout.logger.SDTLog(96,null,D),N.lastIndex=0,P=N.exec(o),o.includes("definePassback")?this.rhBuildPB(o,D,"lower","gam"):o.includes("googletag.defineSlot")&&P&&P.length>1&&P[1].includes(",")?(T=this.setGAMTargeting(o,"lower"),u=D,b=document.createElement("div"),b.className="rhpbad",b.dataset.originalWidth=Number(P[1].split(",")[0])+"",b.dataset.originalHeight=Number(P[1].split(",")[1])+"",D.appendChild(b),y=document.createElement("div"),y.className="rhpbcic",b.appendChild(y),this.fixIframeHeight(y),u=y,this.setPbadSize(b,d),A=g(T||""),E=0,A.forEach((e=>{if("SCRIPT"==e.tagName)E=1;else if(e.childNodes.length>0)for(let t=0;t<e.childNodes.length;t++)if("SCRIPT"==e.childNodes[t].tagName){E=1;break}})),E?setTimeout((()=>{A.forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&u.appendChild(t),C&&!L&&(L=1)}else c(e),u.appendChild(e)}))}),250):A.forEach((e=>{D.appendChild(e)})),w=D.querySelectorAll("a img"),w.length&&(w[0].className="rhi ggnoads",w[0].style.transform="none")):(T=this.setGAMTargeting(o,"lower"),u=D,C=0,L=0,(o.includes("Kargo.loadAds")||o.includes("celtra-ad"))&&(b=document.createElement("div"),b.className="rhkad",this.demoSettings&&this.demoSettings.lower&&"overlap"==this.demoSettings.lower.style&&(b.dataset.originalOverlap=this.demoSettings.lower.overlap+"",b.dataset.heightBasis=this.demoSettings.lower.height+"",b.dataset.widthBasis=this.demoSettings.lower.width+"",b.style.marginTop="-"+this.demoSettings.lower.overlap+"px"),this.demoSettings&&"sticky"==this.demoSettings.effect&&this.stickCreative(b,"bottom"),D.appendChild(b),y=document.createElement("div"),y.className="rhkcic",y.style.position="absolute",b.appendChild(y),u=y,this.fixIframeHeight(y),C=1,"pop"!=e.ct&&"wrapper-pop"!=e.ct||this.addPopModifiers(n),this.observeKU(y,D.clientWidth,D.id,"lower",n)),A=g(T||""),E=0,A.forEach((e=>{if("SCRIPT"==e.tagName)E=1;else if(e.childNodes.length>0)for(let t=0;t<e.childNodes.length;t++)if("SCRIPT"==e.childNodes[t].tagName){E=1;break}})),E?setTimeout((()=>{A.forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&u.appendChild(t),C&&!L&&(L=1)}else c(e),u.appendChild(e)})),this.observeGA(D,D.clientWidth,D.id,"lower")}),2550):A.forEach((e=>{u.appendChild(e)})),w=D.querySelectorAll("a img"),w.length&&(w[0].className="rhi ggnoads",w[0].style.transform="none")),this.rhFilledSlots=(this.rhFilledSlots||0)+1}}else{this.standout.logger.SDTLog(97),D=n.querySelector("#"+i),D&&D.addEventListener("mousedown",I),D&&(D.style.display="none");const e=document.createElement("div");e.className="rhkad",e.dataset.sc_et=l+"",D.appendChild(e);const t=document.createElement("div");t.id=i+"_inner",t.className="rhpbcic",t.style.maxWidth="initial",e.appendChild(t),new MutationObserver((i=>{if(i)for(let s=0;s<i.length;s++)if(i[s].addedNodes&&i[s].addedNodes.length){const n=i[s].addedNodes[0];n.width&&n.height&&(t.style.width=n.width+"px",n.height>0&&(t.style.height=n.height+"px"),i[s].addedNodes.length>1?(e.dataset.originalWidth=i[s].addedNodes[1].width+"",e.dataset.originalHeight=i[s].addedNodes[1].height+""):(e.dataset.originalWidth=n.width+"",e.dataset.originalHeight=n.height+""),this.setPbadSize(e,d)),D.style.display="block"}})).observe(t,{childList:1})}return 1}removeBorders(e){e.style.setProperty("border-width","0"),e.classList.add("rh-ear"),Array.from(e.querySelectorAll(".rh-l")).forEach((e=>{e&&e.style&&(e.style.display="none")}));const t=e.querySelector(".rhus");t&&(t.style.height="auto");const i=e.querySelector(".rhls");i&&(i.style.height="auto")}readdBorders(e){if(e.style.setProperty("border-width","1px"),e.classList.remove("rh-ear"),Array.from(e.querySelectorAll(".rh-l")).forEach((e=>{e&&e.style&&(e.style.display="block")})),this.rhShowingHN&&this.hnAutoCollapse){const e=this.hnWrapper;e&&(e.classList.remove("collapsed"),e.style.visibility="visible",e.style.position="relative",e.style.height="auto")}const t=e.querySelector(".rhus");t&&(t.style.height="auto");const i=e.querySelector(".rhls");i&&(i.style.height="auto")}hideBanner(e){e.style.setProperty("display","none","important"),this.standout.logger.SDTLog(126,{slot:"rhl"==e.className?"lower":"upper"})}reshowBanner(e){e.style.setProperty("display","block","important"),this.standout.logger.SDTLog(127,{slot:"rhl"==e.className?"lower":"upper"})}setRhLogo(t){let i=8,s=115,n=5;this.standout.device.mobile?(s=115,t.src=e.cdnDom+"img/km.png",t.srcset=e.cdnDom+"img/km2x.png 2x,"+e.cdnDom+"img/km.png 1x"):(i=9,s=58,t.src=e.cdnDom+"img/kd.png",t.srcset=e.cdnDom+"img/kd2x.png 2x,"+e.cdnDom+"img/kd.png 1x",n=6),t.height=i,t.width=s,t.style.cssText="margin:6px auto "+n+"px auto !important;display:block;width:"+s+"px !important;height:"+i+"px !important;object-fit: contain;min-height: auto;transform:none;",t.style.setProperty("min-height","auto"),t.className="rh-l",this.standout.bidStack.pbEnabled||(t.style.display="none")}protectHeight(e,t){if(window.MutationObserver){try{const t=e.src;if(e.hasAttribute("src")&&t&&t.includes("ajax/inset/iframe"))return}catch(e){}new MutationObserver((e=>{e.forEach((e=>{const i=e.target;if("height"===e.attributeName){const t=i,s=parseInt(e.oldValue||"0",10);void 0!==t.height&&t.height<=16&&s>16&&(t.height=s)}else if("style"===e.attributeName&&t){if(i.hasAttribute("data-height")){const e=i.getAttribute("data-height")||"";e&&i.style.height!==e&&(i.style.height=e)}if(i.hasAttribute("data-width")){const e=i.getAttribute("data-width")||"";e&&i.style.width!==e&&(i.style.width=e)}}}))})).observe(e,{attributes:1,attributeOldValue:1})}}fixIframeHeight(e){new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{if(e instanceof HTMLElement&&(e.classList&&e.classList.contains("celtra-ad-inline-host")&&new MutationObserver((()=>{const t=e.style.minWidth,i=e.style.minHeight;if(t&&i){const s=e.querySelector("iframe");s&&(s.style.minWidth=t,s.style.minHeight=i)}})).observe(e,{attributes:1,attributeFilter:["style"],childList:0,subtree:0}),"IFRAME"===e.tagName&&!e.id&&e.parentElement&&e.parentElement.parentElement&&e.parentElement.parentElement.classList.contains("celtra-ad-inline-host"))){const t=e.parentElement.parentElement,i=t.style.minWidth,s=t.style.minHeight;if(i&&s){const t=e;t.style.minWidth=i,t.style.minHeight=s}}}))}))})).observe(e,{childList:1,subtree:1})}addPopModifiers(e){const t=e.querySelector(".rhus .rhkad"),i=e.querySelector(".rhls .rhkad");t&&(t.style.zIndex="5"),i&&(i.style.zIndex="5"),t&&!t.dataset.popped&&(t.dataset.popped="1",t.dataset.originalOverlap=this.popDefaults.upper.overlap+"",t.dataset.heightBasis=this.popDefaults.upper.height+"",t.dataset.widthBasis=this.popDefaults.upper.width+"",t.style.marginBottom="-"+(this.popDefaults.upper.overlap-8)+"px"),!i||i.dataset.popped||this.demoSettings.lower&&this.demoSettings.lower.popdisable||(i.dataset.popped="1",i.dataset.originalOverlap=this.popDefaults.lower.overlap+"",i.dataset.heightBasis=this.popDefaults.lower.height+"",i.dataset.widthBasis=this.popDefaults.lower.width+"",i.style.marginTop="-"+this.popDefaults.lower.overlap+"px")}watchContainer(e){window.MutationObserver&&new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{if(!(e instanceof HTMLElement))return;const t=[];if(e.childNodes.length)for(let i=0;i<e.childNodes.length;i++){const s=e.childNodes[i];s instanceof HTMLElement&&t.push(s)}t.push(e),t.forEach((e=>{if("IFRAME"===e.tagName&&!(e.className||"").includes("kargo")){this.standout.logger.SDTLog(140,null,e);const t=e.clientWidth,i=e.width,s=e.height,n=Number(parseInt(""+(null!=i?i:"0"),10));if(!isNaN(t)&&!isNaN(n)&&n>0){const i=t/n;if(i<1){if(e.style.transform="scale("+i+") translateX(-50%)",e.style.transformOrigin="left top",e.style.position="relative",e.style.left="50%",n&&(e.style.width=n+"px"),void 0!==s){const t=Number(parseInt(""+(null!=s?s:"0"),10));!isNaN(t)&&t>0&&(e.style.height=t+"px")}if(e.style.setProperty("max-width","initial","important"),e.setAttribute("data-size-corrected","1"),e.parentElement){const s=e.parentElement.clientHeight*i;e.parentElement.style.maxHeight=s+"px",e.parentElement.style.height=s+"px",e.parentElement.setAttribute("data-size-corrected","1"),this.standout.logger.SDTLog(141,{ratio:i,clientWidth:t,elementWidth:n,maxHeight:e.parentElement.style.maxHeight},e)}else this.standout.logger.SDTLog(141,{ratio:i,clientWidth:t,elementWidth:n},e)}}}}))})),e.removedNodes.forEach((t=>{if(t instanceof HTMLElement&&t.classList&&t.classList.contains("jw-ad-media-container")){const t=e.target;setTimeout((()=>{if(t&&t.children&&t.children.length<=1){const e=m(t,["rhls","rhus"]);e&&(e.style.setProperty("display","none","important"),this.standout.logger.SDTLog(142,{slot:"rhl"==e.className?"lower":"upper"}))}}),250)}}))}))})).observe(e,{childList:1,subtree:1})}observeKU(e,t,i,s,n){if(!("MutationObserver"in window))return;let o=null;this.standout.logger.SDTLog(98,null,e);const a=this.recordFill,l=this,r=()=>!!this.recordedFill;this.standout.bidStack.pbEnabled?this.readdBorders(n):setTimeout((()=>{if(n.querySelector('.rhkcic *[class^="kargo-ad"],.rhkcic *[class^="celtra-ad"]'))this.recordAdImpressionForContainer(n,{}),r()||a(1),this.readdBorders(n);else{const t=m(e,["rhls","rhus"]);this.removeBorders(n),t instanceof HTMLElement&&(this.hideBanner(t),setTimeout((()=>{if(n.querySelector('.rhkcic *[class^="kargo-ad"],.rhkcic *[class^="celtra-ad"]')){const t=m(e,["rhls","rhus"]);t instanceof HTMLElement&&this.reshowBanner(t),this.readdBorders(n),this.recordAdImpressionForContainer(n,{}),r()||a(1)}else l.rhombusAddedAd=0,null==l.processNextEmbedQueueItem||l.processNextEmbedQueueItem()}),1e3))}}),1e3),new MutationObserver((i=>{i.forEach((i=>{i.addedNodes.forEach((i=>{const d=i;if(!(d instanceof HTMLElement))return;if(d.hasAttribute("data-format")&&"KeyArt"===d.getAttribute("data-format")){n.classList.add("rh-ka");const t=document.querySelector('.rh-spc[data-rhc="'+n.id+'"]');if(t&&(t.style.height=n.scrollHeight+"px"),!o){if(!("ResizeObserver"in window))return;o=new window.ResizeObserver((t=>{t.forEach((t=>{if(e.parentElement){const e=document.querySelector('.rh-spc[data-rhc="'+n.id+'"]');e&&(e.style.height=t.contentRect.height+80+"px")}}))})),o.observe(n)}}if(d.hasAttribute("data-format")){if("SocialCanvas"===d.getAttribute("data-format")){const e=window.Kargo;if(e&&e.AdTag&&e.AdTag.adRequests)for(let t=0;t<Object.keys(e.AdTag.adRequests).length;t++){const i=e.AdTag.adRequests[Object.keys(e.AdTag.adRequests)[t]];i.creativeConfig&&"SocialCanvas"==i.creativeConfig.format&&i.creativeConfig.slot==n.dataset.kas&&("pop"!=i.creativeConfig.execution&&"wrapper-pop"!=i.creativeConfig.execution||this.addPopModifiers(n))}}this.standout.logger.SDTLog(72,{format:d.getAttribute("data-format")})}let h=null;if(d.classList&&(d.classList.contains("kargo-creative")||d.classList.contains("celtra-ad-inline-host")))h=d;else if(d.childNodes.length){const e=d.querySelector(".kargo-creative,.celtra-ad-inline-host");e&&(h=e)}const c=d;if(c.height&&d.style.height&&d.style.height.includes("px")&&d.style.height.split("px")[0]!=c.height&&(c.height=d.style.height.split("px")[0]),d.classList&&d.classList.contains("kargo-video-player")){d.style.width=d.style.maxWidth,d.style.minHeight=d.style.height,c.height=(d.style.height||"0").split("px")[0];const i=u(d,".rhkad");i&&(i.dataset.originalWidth=Number((d.style.maxWidth||"0").split("px")[0]),i.dataset.originalHeight=Number((d.style.height||"0").split("px")[0])),e.parentElement&&this.setPbadSize(e.parentElement,t)}if(!h||!e.parentElement)return;const p=m(e,["rhls","rhus"]);if(p instanceof HTMLElement&&p.style&&"none"==p.style.display&&(p.style.setProperty("display","block","important"),this.readdBorders(n),this.recordAdImpressionForContainer(n,{}),r()||a(1)),"IFRAME"===h.tagName){var g;const i=h,n=i.contentDocument||(null==(g=i.contentWindow)?void 0:g.document);if(!n)return;const o=n.body;if(o&&o.innerHTML.includes("RHPB:")){const e=l.rhInsertPB;if("function"==typeof e)try{e(o.innerHTML,n,o,s)}catch(e){}}if(Array.from(o.childNodes).forEach((e=>{e.innerHTML||"null"!=e.wholeText||o.removeChild(e)})),i.width&&i.height){e.parentElement.dataset.originalWidth=l.demoSettings&&l.demoSettings[s]&&l.demoSettings[s].width?l.demoSettings[s].width:i.width+"",e.parentElement.dataset.originalHeight=l.demoSettings&&l.demoSettings[s]&&l.demoSettings[s].height?l.demoSettings[s].height:i.height+"",this.setPbadSize(e.parentElement,t);const n=new MutationObserver((i=>{i.forEach((i=>{const s=i.target;if("attributes"==i.type&&s){const i=Number(s.clientWidth||0),n=Number(s.clientHeight||0);let o=0;e.parentElement.dataset.originalWidth&&i==Number(e.parentElement.dataset.originalWidth)||(e.parentElement.dataset.originalWidth=(s.width||i)+"",o=1),e.parentElement.dataset.originalHeight&&n==Number(e.parentElement.dataset.originalHeight)||(e.parentElement.dataset.originalHeight=(s.height||n)+"",o=1);const a=s.nextSibling;a&&a.classList&&a.classList.contains("celtra-ad-inline-host")&&(e.parentElement.dataset.originalWidth=a.clientWidth+"",e.parentElement.dataset.originalHeight=a.clientHeight+""),o&&this.setPbadSize(e.parentElement,t)}}))}));n.observe(i,{attributes:1,attributeFilter:["width","height","style"]})}new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{if(!(e instanceof HTMLElement))return;const t=e.scrollWidth,s=e.scrollHeight;t>49&&s>49&&(i.style.width=t+"px",i.style.height=s+"px")}));const t=e.target;if("attributes"==e.type&&t){const e=t.scrollWidth,s=t.scrollHeight;e>49&&s>49&&(i.style.width=e+"px",i.style.height=s+"px")}}))})).observe(o,{attributes:1,childList:1,subtree:1,attributeFilter:["width","height","style"]})}}));const d=i.target;if("attributes"==i.type&&d&&d.classList){const i=d;if((i.classList.contains("celtra-ad-v3")||i.classList.contains("celtra-banner"))&&(i.style.minHeight||i.style.minWidth)){const e=u(i,".rhkad");e&&!e.hasAttribute("data-original-width")&&(e.dataset.originalWidth=Number((i.style.minWidth||"").split("px")[0]),e.dataset.originalheight=Number((i.style.minHeight||"").split("px")[0]),this.setPbadSize(e,t))}if(i.classList.contains("celtra-ad-inline-host")&&i.style.width&&i.style.height){const s=(i.style.minWidth||"").split("px")[0],n=(i.style.minHeight||"").split("px")[0];e.parentElement&&(e.parentElement.dataset.originalWidth=s,e.parentElement.dataset.originalHeight=n,this.setPbadSize(e.parentElement,t))}}"attributes"==i.type&&d&&"data-format"==i.attributeName&&"KeyArt"==d.getAttribute("data-format")&&n.classList.add("rh-ka")}))})).observe(e,{childList:1,subtree:1,attributes:1,attributeFilter:["width","height","style","data-format"]})}rhInsertPB(e,t,i,s){let n='.setTargeting("hostname","'+(window.location.hostname||"").replace("www.","")+'")';n+='.setTargeting("siteid","'+(this.standout.serverSettings.siteId||"")+'")',n+='.setTargeting("devcat","'+(this.standout.device.deviceType||"")+'")',n+='.setTargeting("rqid","'+(this.standout.session.pageViewId||"")+'")';let o='googletag.pubads().addEventListener("slotRenderEnded", function(event) { if(parent){ parent.postMessage({messageType:"rhSlotRenderEnded",data:{isEmpty:event.isEmpty,size:event.size,advertiserId:event.advertiserId,campaignId:event.campaignId,creativeId:event.creativeId,lineItemId:event.lineItemId,sourceAgnosticCreativeId:event.sourceAgnosticCreativeId,sourceAgnosticLineItemId:event.sourceAgnosticLineItemId,isBackfill:event.isBackfill,adUnit:event.slot.getAdUnitPath(),slot:"'+s+'"}},"*"); } });';o+='googletag.pubads().addEventListener("slotResponseReceived", function(event) { if(parent){ parent.postMessage({messageType:"rhSlotResponseReceived",data:{}},"*"); } });';const a="window.googletag = window.googletag || {cmd: []};    googletag.cmd.push(function(){       googletag.defineSlot("+e.split("--RHPB:")[1].split("--\x3e")[0]+", 'gpt-passback').addService(googletag.pubads());      googletag.pubads()"+n+";      "+o+"      googletag.enableServices();      googletag.display('gpt-passback');    });",l=t.createElement("script");l.async=1,l.src="https://securepubads.g.doubleclick.net/tag/js/gpt.js",i.appendChild(l);const r=t.createElement("div");r.id="gpt-passback",i.appendChild(r);const d=t.createElement("script");d.textContent=a,r.appendChild(d),this.standout.logger.SDTLog(100,null,r)}rhBuildPB(e,t,i,s=""){var n;this.standout.logger.SDTLog(101,{slot:i},e),e=this.setGAMTargeting(e,i);let o="<html><head>";o+="<script>",o+=""+this.observeGA,o+="//# sourceURL=obsGA.js",o+="<\/script>",o+="<style>",o+="#ad_wrapper div:not(.abgac) { margin-left: auto !important; margin-right: auto !important; display: block !important; } .adroll-block > a > img { margin-top: 0 !important; } #BAP-holder .bap-trigger { margin-top: 1px; }",o+="</style>",o+="</head><body style='overflow:hidden;margin:0 0;padding:0 0;text-align:center;' class='"+s+"'>",o+="<div style='display:inline-block;margin-left:auto;margin-right:auto;' id='ad_wrapper'>",o+="<script>",o+="observeGA(document.getElementById('ad_wrapper'),"+t.clientWidth+",'"+t.id+"','"+i+"');",o+="<\/script>",o+=e,o+="</div>",o+="</body></html>";const a=document.createElement("iframe");a.setAttribute("style","width:100%;height:250px;overflow:hidden;border:none;margin:0 0;box-shadow:none;"),t.appendChild(a);const l=null==(n=a.contentWindow)?void 0:n.document;return l?(l.open(),l.write(o),l.close(),a.setAttribute("data-height","250px"),a.setAttribute("data-width","100%"),this.protectHeight(a,1),this.standout.logger.SDTLog(100,null,a),a):null}setGAMTargeting(e,t){e=l("gpt-passback",e,"rh-"+t+"-gpt-passback");const i=(window.location.hostname||"").replace("www.",""),s=this.standout.serverSettings.siteId||"",n=this.standout.device.deviceType||"",o=this.standout.session.pageViewId||"";let a='.setTargeting("hostname","'+i+'")';a+='.setTargeting("siteid","'+s+'")',a+='.setTargeting("devcat","'+n+'")',a+='.setTargeting("rqid","'+o+'")';const r="rh-"+t+"-gpt-passback";let d='googletag.pubads().addEventListener("slotRenderEnded", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } if(parent){ parent.postMessage({messageType:"rhSlotRenderEnded",data:{isEmpty:event.isEmpty,size:event.size,advertiserId:event.advertiserId,campaignId:event.campaignId,creativeId:event.creativeId,lineItemId:event.lineItemId,sourceAgnosticCreativeId:event.sourceAgnosticCreativeId,sourceAgnosticLineItemId:event.sourceAgnosticLineItemId,isBackfill:event.isBackfill,adUnit:event.slot.getAdUnitPath(),slot:"'+t+'"}},"*"); } });';return d+='googletag.pubads().addEventListener("slotOnloadEvent", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } console.log("RH GPT: Slot Onload",event.slot.getSlotElementId()); });',d+='googletag.pubads().addEventListener("slotRequestedEvent", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } console.log("RH GPT: Slot Requested",event.slot.getSlotElementId()); });',d+='googletag.pubads().addEventListener("slotVisibilityChangedEvent", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } console.log("RH GPT: Slot Visibility Changed",event.slot.getSlotElementId(),"in view percentage",event.inViewPercentage); });',d+='googletag.pubads().addEventListener("impressionViewable", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } console.log("RH GPT: Impression Viewable",event.slot.getSlotElementId()); });',d+='googletag.pubads().addEventListener("slotResponseReceived", function(event) { if(event.slot.getSlotElementId()!="'+r+'"){ return; } if(parent){ parent.postMessage({messageType:"rhSlotResponseReceived",data:{}},"*"); } });',(e=e.replace("googletag.defineSlot","var thisSlot = googletag.defineSlot")).includes(").display(")?e=(e=e.replace(").display(",")"+a+".display(")).replace(").display()",").display();"+d):e.includes(".pubads()")&&(e=e.includes("window.googletag.display(dfpAdId)")?(e=e.replace(".pubads()",".pubads()"+a)).replace("window.googletag.display(dfpAdId)","window.googletag.display(dfpAdId);"+d):e.includes("addService(googletag.pubads());")?e.replace(".pubads());",".pubads()"+a+");"+d):e.replace(".pubads()",".pubads()"+a+";"+d)),e.includes("-passback');")&&(e=e.replace("-passback');","-passback');if(googletag.pubads().isInitialLoadDisabled()){googletag.pubads().refresh([thisSlot]);}")),e.includes("adTag = '")&&(e=e.replace("&description_url=","&t=siteid%3D"+s+"%26devcat%3D"+n+"%26rqid%3D"+o+"%26hostname%3D"+i+"&description_url=")),e}observeGA(e,t,i,s){const n=document;n.hadFill=0,window.MutationObserver&&(new MutationObserver((e=>{e.forEach((e=>{e.addedNodes.forEach((e=>{let o=e;if(("INS"==o.tagName&&o.childNodes.length>0&&o.childNodes[0].childNodes.length>0&&"IFRAME"==o.childNodes[0].childNodes[0].tagName||"DIV"==o.tagName&&o.id&&o.id.startsWith("google_ads_iframe_")&&o.childNodes.length>0&&"IFRAME"==o.childNodes[0].tagName||o.classList&&o.classList.contains("jw-ad")||"IFRAME"==o.tagName&&"none"!=o.style.display)&&(n.hadFill=1,parent)){let e="";o.id&&o.id.startsWith("google_ads_iframe_")?e=o.id.substring(o.id.lastIndexOf("/")+1):o.childNodes.length>0&&o.childNodes[0].id&&o.childNodes[0].id.startsWith("google_ads_iframe_")&&(e=o.childNodes[0].id.substring(o.childNodes[0].id.lastIndexOf("/")+1)),e=e.replace("__container__",""),e&&parent.postMessage({messageType:"got-fill",slot:s,adUnit:e},"*")}if("INS"==o.tagName&&o.childNodes.length>0&&o.childNodes[0].childNodes.length>0&&"IFRAME"==o.childNodes[0].childNodes[0].tagName||"DIV"==o.tagName&&o.id&&o.id.startsWith("google_ads_iframe_")||"IFRAME"==o.tagName&&o.id&&o.id.startsWith("google_ads_iframe_")||"DIV"==o.tagName&&o.classList&&o.classList.contains("celtra-ad-inline-host")||"DIV"==o.tagName&&o.classList&&o.classList.contains("notranslate")||"IFRAME"==o.tagName&&o.parentElement&&o.parentElement.classList&&o.parentElement.classList.contains("notranslate")||"ix"==n.body.className&&"DIV"==o.tagName||"ix"==n.body.className&&"IFRAME"==o.tagName&&"none"!=o.style.display){if("IFRAME"==o.tagName&&o.id&&o.id.startsWith("google_ads_iframe_")&&!o.id.includes("PlanB_Companion")&&(o=o.parentElement),o.hasAttribute("data-size-corrected")||o.children.length>0&&o.children[0].hasAttribute("data-size-corrected"))return;let e="IFRAME"==o.tagName?o:"DIV"==o.tagName&&o.childNodes.length>0?o.childNodes[0]:"DIV"==o.tagName&&0==o.childNodes.length?o:o.childNodes[0].childNodes[0];"ix"==n.body.className&&"DIV"==o.tagName&&o.clientWidth&&(e=o);let s=e.clientWidth,a=e.clientHeight;if((0==s||0==a)&&o.childNodes.length>0){const e=o.childNodes[0];s=e.clientWidth||Number(e.width),a=e.clientHeight||Number(e.height)}"ix"!=n.body.className||"DIV"!=o.tagName||isNaN(a)||(a+=2);let l=s,r=a;if(s>t&&(l=t,r=l*(a/s)),s<l&&(r=l*(a/s)),1==l&&1==r&&"IFRAME"!=e.tagName&&0==e.children.length)return;if("IFRAME"==o.tagName&&o.setAttribute("data-size-corrected","1"),s>0&&a>0)if(parent&&parent.postMessage({messageType:"sizing-report",elementId:i,width:l,height:r},"*"),"DIV"==o.tagName||"IFRAME"==o.tagName){if(s>t){const e=t/s;o.style.transformOrigin="left top",o.style.transform="scale("+e+","+e+") translateX(-50%)",o.style.position="relative",o.style.left="50%"}else o.style.transform="";o.style.width=l+"px",o.style.height=r+"px",o.style.marginLeft="auto",o.style.marginRight="auto"}else{o.style.width=l+"px",o.style.height=r+"px",o.childNodes[0].style.width=l+"px",o.childNodes[0].style.height=r+"px";const t=n.createElement("style");t.innerHTML="#google_image_div amp-img.img_ad, #google_image_div .img_ad img {width:"+l+"px !important;height:"+r+"px !important;}",e.setAttribute("width",l+""),e.setAttribute("height",r+""),e.style.setProperty("width",l+"px","important"),e.style.setProperty("height",r+"px","important");const i=e.contentDocument;i&&i.head&&i.head.appendChild(t)}}}))}))})).observe(e,{childList:1,subtree:1}),new MutationObserver((e=>{let t=null,s=null;e.forEach((e=>{const i=e.target;if(i)if("IFRAME"==i.tagName&&i.id&&i.id.startsWith("google_ads_iframe_")&&"height"==e.attributeName){if(t=Number(i.height),i.parentElement&&i.parentElement.style&&i.parentElement.style.transform){const e=i.parentElement.style.transform;if(e.includes("scale")&&e.includes("(")&&e.includes(",")){const i=e.split("(")[1].split(")")[0].split(",").map(parseFloat);0!=i[1]&&(t*=i[1])}}}else"IFRAME"==i.tagName&&i.id&&i.id.startsWith("google_ads_iframe_")&&"height"==e.attributeName&&(s=Number(i.width))})),parent&&(t&&parent.postMessage({messageType:"height-report",elementId:i,height:t},"*"),s&&parent.postMessage({messageType:"width-report",elementId:i,width:s},"*"))})).observe(e,{attributes:1,attributeFilter:["width","height"],subtree:1}),"ix"==n.body.className||setTimeout((()=>{n.hadFill||parent&&parent.postMessage({messageType:"no-fill",slot:s},"*")}),1200))}newUrl(e,t){if(t){let e=Array.from(t.querySelectorAll("div[data-rhp]"));e.forEach((e=>{e.removeAttribute("data-rhp")})),e=Array.from(t.querySelectorAll(".rna-container")),e.forEach((e=>{e.classList.remove("rna-container")}))}let i=t;this.reset(),this.focusElement=i,this.doRhombusScan()}clearFound(){this.rhFound={},Object.values(e.EmbedTypes).filter((e=>"number"==typeof e)).forEach((e=>{this.rhFound[e]=[]}))}reset(){try{var e;null==(e=this.llObserver)||e.disconnect(),this.llObserver=void 0}catch(e){}try{var t;null==(t=this.eeObsv)||t.disconnect(),this.eeObsv=null}catch(e){}this.clearFound(),this.lastEventTimestamp=0,this.stickyElements={},this.rhShowingHN=0,this.deferForViewability=0,this.runningQueue=0,this.rhombusEmbedQueue=[],this.confirmedEmbeds=[],this.deferredData={},this.rhombusAddedAd=0,this.multipleAds=0,this.containerElement=null,this.requesting=0,this.rhRecordedRequest=0,this.reportedFill=0,this.rhSLP=0,this.rhDI=0,this.requestCount=0,this.rhFilledSlots=0}foundCount(){const e=new Set;return Object.keys(this.rhFound).forEach((t=>{this.rhFound[t].forEach((t=>{null!=t&&t.url&&e.add(t.url)}))})),e.size}addListeners(){this.standout.listeners.subscribeToEvent("scroll",0,(e=>this.scrollAction(e))),this.standout.listeners.subscribeToEvent("message",0,(e=>this.receiveMessage(e)))}didMouseDown(e){const t=e.currentTarget,i=e.target;if(!t)return;if(i===t||i&&"BUTTON"===i.tagName)return;if(this.lastEventTimestamp>0&&e.timeStamp-this.lastEventTimestamp<2e3)return;this.lastEventTimestamp=e.timeStamp;const s={};s.requestId=this.standout.session.pageViewId,s.ses=this.standout.session.sessionId,s.embedUrl=t.getAttribute("data-embed-url"),s.shn=this.rhShowingHN,s.atc=this.standout.page.checkATC(),this.standout.logger.SDTLog(110,null,t),s.requestId&&s.embedUrl&&(this.standout.logger.SDTLog(57,null,s),this.standout.communications.postKSO("embed/click",s,(()=>{})))}scrollAction(e){for(let e=0;e<this.confirmedEmbeds.length;e++)this.confirmedEmbeds[e].viewed||S(this.confirmedEmbeds[e].embed)&&(this.confirmedEmbeds[e].viewed=1,this.recordEmbedView(this.confirmedEmbeds[e]));if((this.deferForViewability||this.standout.bidStack.deferForViewability)&&Object.keys(this.deferredData).length&&Object.keys(this.deferredData).forEach((e=>{const t=this.deferredData[e];!t.rendered&&S(t.rhombusContainer)&&(this.createBanners(t.decisionData,t.upperId,t.lowerId,t.embedUrl,t.rhombusContainer,t.iLP,t.canonicalEmbedUrl,t.embedType,1),this.standout.logger.SDTLog(99))})),Object.keys(this.stickyElements).length&&this.stickyElements.top){const e=this.stickyElements.top.getBoundingClientRect(),t=Math.floor(e.top-Number(this.stickyElements.top.dataset.stickyOffset||"0"));if(t<0)if(this.stickyElements.bottom){const i=this.stickyElements.bottom.getBoundingClientRect();e.bottom-(Number(this.stickyElements.top.dataset.stickyOffset||"0")+t)>i.top||(this.stickyElements.top.dataset.stickyOffset=""+Math.floor(-e.top+Number(this.stickyElements.top.dataset.stickyOffset||"0")),this.stickyElements.top.style.transform="translateY("+-t+"px)")}else this.stickyElements.top.dataset.stickyOffset=""+Math.floor(-e.top+Number(this.stickyElements.top.dataset.stickyOffset||"0")),this.stickyElements.top.style.transform="translateY("+-t+"px)";else this.stickyElements.top.style.transform="none"}}receiveMessage(e){if(!e||!e.data||"object"!=typeof e.data||!("messageType"in e.data))return;const t=document;let i=e.data,s=null,n=null,o=null;const a=this.containerElement||void 0;if("sizing-report"==e.data.messageType){const n=t.querySelectorAll("#"+i.elementId+" > iframe, #"+i.elementId+' > div[id$="-passback"] > div[id^="google_ads_"]');if(s=Array.from(n),s&&s.length>0&&i.height>200){const e=s[0],t=e.src;if(e.hasAttribute&&e.hasAttribute("src")&&t&&t.includes("ajax/inset/iframe"))return;e.setAttribute("data-height",i.height+"px"),e.style.height=i.height+"px"}this.standout.logger.SDTLog(120,{width:i.width,height:i.height},e.data)}if("height-report"==e.data.messageType){const n=t.querySelectorAll("#"+i.elementId+" > iframe, #"+i.elementId+' > div[id$="-passback"] > div[id^="google_ads_"]');if(s=Array.from(n),s&&s.length>0&&i.height>200){const e=s[0],t=e.src;if(e.hasAttribute&&e.hasAttribute("src")&&t&&t.includes("ajax/inset/iframe"))return;e.setAttribute("data-height",i.height+"px"),e.style.height=i.height+"px"}this.standout.logger.SDTLog(121,{height:i.height},e.data)}"no-fill"==e.data.messageType&&(n=i.slot,"upper"==n?(o=a?a.querySelector(".rhus"):t.querySelector(".rhus"),o&&o.style.setProperty("display","none","important"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{upperAdUnit:"No Fill"})):"lower"==n&&(o=a?a.querySelector(".rhls"):t.querySelector(".rhls"),o&&o.style.setProperty("display","none","important"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{lowerAdUnit:"No Fill"})),this.standout.logger.SDTLog(122,null,e.data)),"should-collapse"==e.data.messageType&&(n=i.slot,"upper"==n?(o=a?a.querySelector(".rhus"):t.querySelector(".rhus"),o&&o.style.setProperty("display","none","important")):"lower"==n&&(o=a?a.querySelector(".rhls"):t.querySelector(".rhls"),o&&o.style.setProperty("display","none","important"))),"got-fill"==e.data.messageType&&(n=i.slot,"upper"==n?(o=a?a.querySelector(".rhus"):t.querySelector(".rhus"),o&&o.style.setProperty("display","block"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{upperAdUnit:i.adUnit})):"lower"==n&&(o=a?a.querySelector(".rhls"):t.querySelector(".rhls"),o&&o.style.setProperty("display","block"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{lowerAdUnit:i.adUnit})),this.standout.logger.SDTLog(123,{slot:n,adUnit:i.adUnit},e.data)),"rh-log"==e.data.messageType&&this.standout.logger.SDTLog(i.message,i.data,i.object),"rhSlotRenderEnded"==e.data.messageType&&(i=(e.data||{}).data,n=i.slot,i&&!i.isEmpty?("upper"==i.slot?(this.dfpUpperFill={},this.dfpUpperFill.AdUnit=i.adUnit.split("/")[i.adUnit.split("/").length-1],this.dfpUpperFill.Creative=i.sourceAgnosticCreativeId,this.dfpUpperFill.LineItem=i.sourceAgnosticLineItemId,this.dfpUpperFill.Campaign=i.campaignId,this.dfpUpperFill.Advertiser=i.advertiserId):(this.dfpLowerFill={},this.dfpLowerFill.AdUnit=i.adUnit.split("/")[i.adUnit.split("/").length-1],this.dfpLowerFill.Creative=i.sourceAgnosticCreativeId,this.dfpLowerFill.LineItem=i.sourceAgnosticLineItemId,this.dfpLowerFill.Campaign=i.campaignId,this.dfpLowerFill.Advertiser=i.advertiserId),this.reportedFill||(this.reportedFill=1,setTimeout((()=>{const e={};e.requestId=this.standout.session.pageViewId,this.dfpUpperFill&&(e.upperAdUnit=this.dfpUpperFill.AdUnit,e.upperCreative=this.dfpUpperFill.Creative),this.dfpLowerFill&&(e.lowerAdUnit=this.dfpLowerFill.AdUnit,e.lowerCreative=this.dfpLowerFill.Creative),this.standout.communications.postKSO("request/fill",e,(()=>{this.reportedFill=0}))}),100)),"upper"==n?(o=a?a.querySelector(".rhus"):t.querySelector(".rhus"),o&&(o.dataset.filled="true")):"lower"==n&&(o=a?a.querySelector(".rhls"):t.querySelector(".rhls"),o&&(o.dataset.filled="true"))):i.isEmpty&&("upper"==n?(o=a?a.querySelector(".rhus"):t.querySelector(".rhus"),o&&!o.dataset.filled&&(o.style.setProperty("display","none","important"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{upperAdUnit:"No Fill"}))):"lower"==n&&(o=a?a.querySelector(".rhls"):t.querySelector(".rhls"),o&&!o.dataset.filled&&(o.style.setProperty("display","none","important"),this.standout.logger.SDTLogAddEmbedDetails(this.embedUrlWithAd||"",{lowerAdUnit:"No Fill"})))))}stickCreative(e,t){this.stickyElements[t]=e}observeEmbedSize(e,t,i){if(!("ResizeObserver"in window)||this.eeObsv)return;const s=this.containerElement;this.eeObsv=new window.ResizeObserver((t=>{let n=20;window.getComputedStyle&&s&&(n=parseFloat(window.getComputedStyle(s).getPropertyValue("padding-left"))||20);const o=Math.max(0,e.clientWidth-2*n);document.querySelectorAll("#"+i+" .rhpbad").forEach((e=>{this.setPbadSize(e,o)}))})),this.eeObsv.observe(e)}recordRequest(t,i,s=null){if(this.requesting)return void setTimeout((()=>{this.recordRequest(t,i,s)}),500);if(this.rhRecordedRequest)return;this.requesting=1,this.rhRecordedRequest=1;const n={};n.v=this.standout.version,n.r=Math.random(),n.u=window.location.href,n.pt=document.title,n.hn=window.location.hostname,n.sid=this.standout.serverSettings.siteId,n.ec=this.foundCount(),n.err=i,i&&i.length||!this.blacklisted||(n.err="Blocklisted"),n.m=this.standout.device.mobile,n.dT=this.standout.device.deviceType,n.dC=this.standout.device.deviceCategory,n.rid=this.standout.session.pageViewId,n.ses=this.standout.session.sessionId,n.newSes=this.standout.session.newSession,this.standout.session.newSession=0,n.now=(new Date).getTime(),n.rf=document.referrer,n.lsc=this.timeFinishedScan-(this.standout.settings.timeStart||0);const o=this.standout.getProductByType(e.ProductType.Spotlight);n.inE=!(!o||!o.interstitialEnabled),n.cmp=this.standout.page.hasCMP(),n.cmpus=this.standout.page.hasUSCMP();let a=0;try{o&&"function"==typeof o.interstitialTimingEligible?a=[0,1,2].some((e=>{try{return!!o.interstitialTimingEligible(e,1)}catch(e){return 0}})):(this.interstitialTimingEligible||this.interstitialTentativelyEligible)&&(a=1)}catch(e){}a&&(n.scie=1),this.standout.logger.SDTLog(53,null,n),n.t_kl=window.krg_so.kso_load,n.atc=this.standout.page.checkATC(),n.tg=1,n.fpl=this.standout.session.initialLoad,this.requestCount+=1,this.standout.communications.postKSO("request",n,(e=>{if(this.requesting=0,e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);"sid"in t&&(this.standout.serverSettings.siteId=t.sid,this.standout.logger.SDTLog(60,null,{siteId:this.standout.serverSettings.siteId})),"kmId"in t&&(this.standout.serverSettings.kmPid=t.kmId),"kmPubId"in t&&(this.standout.serverSettings.kmPub=t.kmPubId),"sset"in t&&this.standout.serverSettings.processScriptSettings(t.sset),"hnW"in t&&t.hnW.length>0&&this.processHNWidgets(t.hnW),"iu"in t&&this.standout.serverSettings.processUM(t.iu)}catch(e){}}))}postEmbedLoad(e,t){const i={};i.url=window.location.href,i.embedUrl=e,i.siteId=this.standout.serverSettings.siteId,i.shownAsHN=this.rhShowingHN,i.ineligibilityReasons=t,i.mobile=this.standout.device.mobile,i.requestId=this.standout.session.pageViewId,i.url&&i.embedUrl&&(this.standout.logger.SDTLog(54,null,i),this.standout.communications.postKSO("embed/load",i,(e=>{})))}recordEmbedView(e){this.standout.logger.log("Recording embed view",e);const t=this.standout.page.getPageDataFor(e.embed),i={};i.url=null==t?void 0:t.url,i.pageTitle=null==t?void 0:t.pageTitle,i.embedUrl=null==e?void 0:e.url,i.siteId=this.standout.serverSettings.siteId,i.shownAsHN=!!this.rhShowingHN,i.mobile=this.standout.device.mobile,i.requestId=this.standout.session.pageViewId,i.url&&i.embedUrl&&this.standout.communications.postKSO("embed/view",i,(()=>{}))}recordPbAdImpressionForContainer(e,t,i){const s=this.deferredData[e.id]||{};if(s&&s.filled)return;this.deferredData[e.id].filled=1;const n=e.getAttribute("data-kas"),o={};o.ads=n,o.cid=e.id,o.eu=s.canonicalEmbedUrl,o.et=s.embedType,o.bd=t.bidderCode,o.cpm=t.cpm,o.sz=t.size,o.cId=t.creativeId,o.dId=t.dealId,o.aId=t.adId||t.aId,o.src=t.source,o.kId=t.kadId,o.aTy=t.auctionType,o.cf=t.format,o.ce=t.execution,o.auId=i,o.kScImp=t.kScImp,o.kScSeat=t.kScSeat,o.cfId=t.cfId,o.mT=t.mT,o.rT=t.rT,this.standout.bidStack.recordAdImpression(o)}recordAdImpressionForContainer(e,t){const i=this.deferredData[e.id]||{};if(i&&i.filled)return;e.id&&(this.deferredData[e.id].filled=1);const s=this;this.standout.bidStack.recordAdImpressionForContainer(e,t,i,(t=>{"Ok"==t&&e.id&&s.deferredData[e.id]&&(s.deferredData[e.id].filled=1)}))}recordHNWidget(e){J(this,e)}recordFill(e=0){this.standout.bidStack.adSlotFill=1,!this.recordedFill&&e&&(this.standout.logger.SDTLog(128),this.processNextEmbedQueueItem(),this.recordedFill=1)}processHNWidgets(e,t){((e,t,i)=>{e.forceHN=0;const s=document;let n=null,o=null,a=null;if(!e.standout.settings.disableAdRendering&&e.standout.serverSettings.productsEnabled.sc){e.standout.logger.SDTLog(40,{widgets:t.length},t);for(let i=0;i<t.length;i++){if(e.forceHNWidget&&e.forceHNWidget>0&&t[i].id==e.forceHNWidget){n=t[i];break}if(!(e.forceHNWidget&&e.forceHNWidget>0)&&0==t[i].hnType){if(!("mQ"in t[i])||!t[i].mQ){n=t[i],e.standout.logger.SDTLog(42,null,n);break}if(window.matchMedia(t[i].mQ).matches){n=t[i],e.standout.logger.SDTLog(41,null,n);break}}}if(n)if("iPl"in n&&1==n.iPl&&(e.invertPlacements=1,e.standout.logger.SDTLog(43)),"em"in n&&"cSel"in n&&0==n.hnType){let t,l=[];if(n.cSel&&(l=Array.from(s.querySelectorAll(n.cSel))),0==n.wL?t=Array.from(l.length?l[0].querySelectorAll(n.ibSel):s.querySelectorAll(n.ibSel)):2==n.wL&&l.length&&(n.ibSel&&n.ibSel.length?(o=l[0].querySelectorAll(n.ibSel),o.length&&(a=parseInt(o.length/2+"")+1,t=Array.from(l[0].querySelectorAll(n.ibSel+":nth-of-type("+a+")")))):(o=l[0].children,o.length&&(a=parseInt(o.length/2+"")+1,t=Array.from(l[0].querySelectorAll(":nth-child("+a+")"))))),!l.length&&t&&t.length){const e=t[0].parentElement;e&&l.push(e)}"aCl"in n&&n.aCl&&n.aCl.length>0&&(e.rhAdditionalClass=n.aCl);const r="wEl"in n?n.wEl:null,d=n.em,c=n.tEl;"sLPl"in n&&(e.rhSLP=!!n.sLPl);const p=n.fEl||"";if((!l||0==l.length)&&t&&t.length&&t[0].parentElement&&(l=[t[0].parentElement]),l&&l.length>0){const o=r?g(r):null;let a=null,m=null,u=null;if(t&&t.length){for(let e=0;e<t.length;e++)t[e].parentElement==l[0]&&(u=t[e]);if(!u){u=t[0];for(let e=0;e<t.length;e++)if(l[0].contains(t[e])){u=t[e];break}}}if(e.standout.logger.SDTLog(44,null,l[0]),o&&o.length?a=o[0]:(a=s.createElement("div"),a.className="hn-container",a.style.clear="both"),m=a,u&&l[0].contains(u)?l[0].insertBefore(m,u):l[0].insertBefore(m,null),m.children.length&&(m=m.children[0]),g(c||"").forEach((e=>{const t=e;if(t.classList&&t.classList.add("rh-hn-title"),"SCRIPT"===t.tagName){const e=h(t);m?a&&a.children.length&&e?a.insertBefore(e,a.children[0]):a&&e&&a.appendChild(e):e&&l[0].insertBefore(e,u)}else a?a.children.length?a.insertBefore(t,a.children[0]):a.appendChild(t):l[0].insertBefore(t,u)})),0==n.hnType&&g(d||"").forEach((e=>{const t=e;if("SCRIPT"===t.tagName){const e=h(t);m?e&&m.appendChild(e):e&&l[0].insertBefore(e,u)}else m?m.appendChild(t):l[0].insertBefore(t,u)})),p&&p.length>0&&g(p).forEach((e=>{var t;const i=e;null==(t=i.classList)||t.add("rh-hn-footer"),m?m.appendChild(i):l[0].insertBefore(i,u)})),n.css){const e=s.createElement("style");e.innerHTML=n.css,m?m.appendChild(e):l[0].insertBefore(e,u)}e.rhShowingHN=1,e.hnAutoCollapse=!!n.aCo,e.hnWrapper=a,e.hnAutoCollapse&&e.hnWrapper&&(e.hnWrapper.classList.add("collapsed"),e.hnWrapper.style.visibility="hidden",e.hnWrapper.style.height="0",e.hnWrapper.style.overflow="hidden"),J(e,{wid:n.id}),e.runningQueue=0,(m||l[0]).classList.add("rh-hn-widget"),e.deferForViewability=1,2!=n.hnType&&(i&&i.element?e.doRhombusScan({element:i.element}):e.hnWrapper&&e.doRhombusScan({element:e.hnWrapper}))}else e.standout.logger.SDTLog(45)}else e.standout.logger.SDTLog(46,null,n)}})(this,e,t)}buildViewImage(e=null,t=0){if((this.rhFilledSlots>0||t)&&void 0!==window.rhombusOOPViewUrl){const t=document.createElement("img");t.src=window.rhombusOOPViewUrl,t.style.display="none",e?e.appendChild(t):document.body.appendChild(t)}}}Q.productName="SocialCanvas",Q.PLATFORM_PATTERNS=["embed.spotify","instagram.com/","spotify.com/embed","soundcloud.com/player","w.soundcloud.com","youtube.com/embed","youtube-nocookie.com/embed","tiktok.com/","twitch.tv/","anchor.fm/","player.vimeo.com/","imgur.com/","megaphone.fm/","giphy.com/","reddit.com/","redditmedia.com/","gfycat.com/","linkedin.com/embed","embed.music.apple.com/","embed.tumblr.com/embed",["embedly.com/widget","reddit"],["embedly.com/widget","youtube.com"],["embedly.com/widget","youtube-nocookie.com"],["embedly.com/widget","tiktok.com"]];const X=["overlayCheckForSuppression","mastheadActivateParallax","mastheadUpdateParallax","mastheadCheckForSuppression","inarticleCheckForSuppression","inarticleFindInsertionPoint"],Z=new class{constructor(){this.handlers=new Map}add(e,t){if("function"!=typeof t)return;const i=this.handlers.get(e);i?i.push(t):this.handlers.set(e,[t])}fire(e,t){const i=this.handlers.get(e);if(!i||0===i.length)return[];const s=[];for(const n of i)try{s.push(n(...t))}catch(t){console.error("[KSO] handler error for",e,t)}return s}getHandlers(){return this.handlers}};function ee(e,...t){return Z.fire(e,t)}function te(e,...t){return ee(e,...t).some((e=>1==e))}class ie extends ${constructor(t){super(t),this.adFilledTime=0,this.forceEnable=0,this.demoKey=null,this.demoAdType="Demo Creative",this.triggers={external:0,interArticleLinks:0,refocus:0,idleTime:0,scrollToTop:0,mouseLeave:0,fastScroll:0,manual:1,reactivate:0,externalLinks:0,endOfArticle:0},this.forceTiming=0,this.disableFillCheck=0,this.countdownTime=15,this.overrideSettings=0,this.spotlightOverlayAllowed=0,this.spotlightInarticleAllowed=0,this.spotlightMastheadAllowed=0,this.spotlightInarticleAvailable=0,this.spotlightOverlayAvailable=0,this.spotlightMastheadAvailable=0,this.deviceTypes=0,this.minIdleTime=20,this.mastheadNavSelector=null,this.articleContentSelector=null,this.demoSuppressConfigButton=0,this.triggerElementConfig={},this.triggerElementSeen=0,this.overlayBackground="rgba(0,0,0,0.7)",this.overlayForeground="#ffffff",this.overlayCloseButtonStyle=3,this.overlayCloseButtonScale=70,this.overlayZIndex=e.zIndexMax-10,this.showSpotlightImmediately=0,this.didSetUp=0,this.overrideMaxWidth=null,this.mhFullWidth=0,this.inarticleSticky=2,this.waitingForSticky=0,this.disableSpotlight=0,this.forceSpotlight=0,this.mastheadMode=1,this.frequencyCapOverlay=3600,this.frequencyCapGeneral=20,this.frequencyCapInarticle=0,this.frequencyCapMasthead=0,this.mastheadAutoscrollThreshold=.05,this.overlayClickBlockerDelay=1500,this.placements={overlay:{enabled:0},masthead:{enabled:0},inarticle:{enabled:0}},this.overlayShownTime=0,this.recordedInarticleEligibility=0,this.recordedOverlayEligibility=0,this.recordedMastheadEligibility=0,this.demoData=null,this.windowClickListener=null,this.overlayMouseDownListener=null,this.documentVisibilityListener=null,this.windowFocusListener=null,this.windowWheelListener=null,this.navigationListener=null,this.showingOverlay=0,this.showingInarticle=0,this.showingMasthead=0,this.showingMastheadElement=null,this.showingMastheadNavElement=null,this.spotlightFill=0,this.spotlightEventListeners=[],this.spotlightSettings={},this.spotlightEnabled=0,this.mocking=0,this.lastInidleTime=Date.now(),this.lastShownTs={overlay:0,inarticle:0,masthead:0},this.idleIntervalId=null,this.refocusListenersAdded=0,this.lastServerSettings=null,this.executedConfigScripts=new Set,this.lastBlurTimestamp=null,this.skipNextFocusRefocus=0,this.wasDocumentHidden=0,this.recordedOverlaySuppression=0,this.googleVignetteShown=0,this.lastTriggerLogAt={},this.suppressionLogTs={},this.lastSuppressionReason=null,this.svPrevPosition=null,this.svCurPosition=null,this.svTimer=null,this.svChange=null,this.furthestScrolled=0,this.lastScroll=null,this.pendingDelay=0,this.scrolledDownOverlay=0,this.scrolledDownMasthead=0,this.previousHeight=0,this.previousScrollRest=0,this.previousScrollTime=null,this.previousScrollTop=0,this.naFurthestScrolled=0,this.naTimer=null,this.naLog=[],this.naLogDebug=0,this.touchDown=0,this.lastTouchTime=null,this.mastheadLastScrollY=-999,this.mastheadParallaxElement=null,this.mastheadNavElement=null,this.mastheadNavElements=[],this.mastheadAutoNavElements=[],this.stickyPlayer=null,this.stickyThirdPartyPlayer=null,this.specialCaseElements=null,this.mastheadScrollToTopScrollDownThreshold=.5,this.overlayScrollToTopScrollDownThreshold=.5,this.overlayAdjustedElements=[],this.overlayAdjustmentCheck=null,this.inarticleScrollPositionTick=0,this.productEnabled=1}activate(){this.loadSettings(),this.addListeners(),window.kargoSpotlight={displaySpotlight:this.triggerSpotlightManually.bind(this),getSpotlightFill:this.getSpotlightFill.bind(this),disableRendering(){this.disableAdRendering=1},addEventListener(e){e&&this.spotlightEventListeners.push(e)},version:this.standout.version};const e=()=>{const t=()=>{this.checkAuctionRerequestInterval(),e()};"requestIdleCallback"in window?requestIdleCallback(t,{timeout:2e3}):setTimeout(t,2e3)};e()}loadSettings(){const e=e=>this.standout.settings.qsGet(e),t=e=>this.standout.settings.qsBool(e),i=e=>this.standout.settings.qsHas(e);if((e("sci_demo")&&"0"!=e("sci_demo")||e("sci_demo_celtra"))&&(this.forceEnable=1,e("sci_demo_celtra")?this.demoKey="celtra_"+e("sci_demo_celtra"):"1"!=e("sci_demo")&&(this.demoKey=e("sci_demo")||null),this.demoAdType="Demo Creative",this.triggers.external=1,this.triggers.interArticleLinks=1,this.triggers.refocus=1,this.triggers.idleTime=1,this.triggers.scrollToTop=1,this.triggers.mouseLeave=1,this.triggers.fastScroll=1,this.triggers.manual=1,this.forceTiming=1,this.disableFillCheck=1,this.countdownTime=500),e("ksl_demo")){const t=(e("ksl_demo")||"").split(",");if(t.length>3){this.overrideSettings=1,this.forceEnable=1,this.spotlightOverlayAllowed=0,this.spotlightInarticleAllowed=0,this.spotlightMastheadAllowed=0;const e=t[0].toLowerCase();"overlay"==e?this.spotlightOverlayAllowed=1:"masthead"==e?this.spotlightMastheadAllowed=1:"inarticle"==e||"infeed"==e?this.spotlightInarticleAllowed=1:(3==e.length&&(this.spotlightOverlayAllowed="1"==e.substring(0,1),this.spotlightInarticleAllowed="1"==e.substring(1,2),this.spotlightMastheadAllowed="1"==e.substring(2,3)),e.includes("o")&&(this.spotlightOverlayAllowed=1),e.includes("i")&&(this.spotlightInarticleAllowed=1),e.includes("m")&&(this.spotlightMastheadAllowed=1)),this.deviceTypes="mobile"==t[1]?1:"desktop"==t[1]?2:0,this.demoKey=t[2]||null;const i=t[3];this.triggers.idleTime=i.includes("i")?1:0,this.triggers.refocus=i.includes("r")?1:0,this.triggers.reactivate=i.includes("v")?1:0,this.triggers.scrollToTop=i.includes("s")?1:0,this.triggers.mouseLeave=i.includes("n")?1:0,this.triggers.fastScroll=i.includes("f")?1:0,this.triggers.interArticleLinks=i.includes("l")?1:0,this.triggers.externalLinks=i.includes("x")?1:0,this.triggers.endOfArticle=i.includes("e")?1:0,this.triggers.manual=i.includes("m")?1:0,this.forceTiming=1,window.sessionStorage.setItem("ksl-ifc","1"),t.length>4&&t[4].length&&(this.minIdleTime=Number(t[4])),t.length>5&&(this.mastheadNavSelector||(this.mastheadNavSelector=t[5])),t.length>6&&(this.articleContentSelector=t[6]),t.length>7&&(this.demoSuppressConfigButton="1"==t[7]),t.length>8&&(this.triggerElementConfig.selector=t[8]),this.demoAdType="Demo Creative",this.disableFillCheck=1}}if(e("sci_settings")||e("ksl_settings")){const t=(e("sci_settings")||e("ksl_settings")||"").split(",");t.length>0&&(this.overrideSettings=1,this.forceEnable="1"==t[0],t.length>2&&(this.triggers.interArticleLinks="1"==t[2]),t.length>3&&(this.triggers.externalLinks="1"==t[3]),t.length>4&&(this.triggers.endOfArticle="1"==t[4]),t.length>5&&(this.triggers.idleTime="1"==t[5]),t.length>6&&(this.triggers.refocus="1"==t[6]),t.length>7&&(this.triggers.reactivate="1"==t[7]),t.length>8&&(this.triggers.scrollToTop="1"==t[8]),t.length>9&&(this.triggers.mouseLeave="1"==t[9]),t.length>10&&(this.forceTiming="1"==t[10],window.sessionStorage.setItem("ksl-ifc",this.forceTiming?"1":"0")),t.length>11&&(this.frequencyCapOverlay=t[11]),t.length>12&&(this.minIdleTime=Number(t[12])),t.length>13&&(this.countdownTime=Number(t[13])),t.length>14&&(this.demoAdType="1"==t[14]?"Demo Creative":"Ad Slot"),t.length>15&&(this.demoKey=t[15]),t.length>16&&(this.spotlightOverlayAllowed="1"==t[16]),t.length>17&&(this.spotlightInarticleAllowed="1"==t[17]),t.length>18&&(this.spotlightMastheadAllowed="1"==t[18]),t.length>19&&(this.mastheadMode=t[19]),t.length>20&&(this.mastheadNavSelector||(this.mastheadNavSelector=t[20])),t.length>21&&(this.triggers.fastScroll="1"==t[21]),this.deviceTypes=t.length>22?Number(t[22]):0,this.demoSuppressConfigButton=t.length>24?"1"==t[24]:0,t.length>25&&t[25].length&&(this.articleContentSelector=t[25]),this.disableFillCheck=1)}t("ksl_tr_interarticle")&&(this.triggers.interArticleLinks=1,window.sessionStorage.setItem("ksl-tr-interarticle","1")),t("ksl_tr_external")&&(this.triggers.externalLinks=1),t("ksl_tr_element")&&(this.triggers.endOfArticle=1),t("ksl_tr_idletime")&&(this.triggers.idleTime=1),t("ksl_tr_refocus")&&(this.triggers.refocus=1),t("ksl_tr_reactivate")&&(this.triggers.reactivate=1),t("ksl_tr_scrolltotop")&&(this.triggers.scrollToTop=1),t("ksl_tr_mouseleave")&&(this.triggers.mouseLeave=1),t("ksl_tr_fastscroll")&&(this.triggers.fastScroll=1),t("ksl_tr_manual")&&(this.triggers.manual=1),e("ksl_min_idletime")&&(this.minIdleTime=Number(e("ksl_min_idletime"))),e("ksl_platforms")&&(this.deviceTypes=Number(e("ksl_platforms"))),t("ksl_noconfig")&&(this.demoSuppressConfigButton=1),t("ksl_force")&&(this.forceSpotlight=1,this.overrideSettings=1,this.forceTiming=1,this.spotlightInarticleAllowed=1,this.spotlightOverlayAllowed=1,this.spotlightMastheadAllowed=1),t("ksl_overlaydemo")&&(this.forceSpotlight=1,this.overrideSettings=1,this.forceTiming=1,this.spotlightOverlayAllowed=1),t("ksl_inarticledemo")&&(this.forceSpotlight=1,this.overrideSettings=1,this.forceTiming=1,this.spotlightInarticleAllowed=1),t("ksl_mastheaddemo")&&(this.forceSpotlight=1,this.overrideSettings=1,this.forceTiming=1,this.spotlightMastheadAllowed=1),e("rhdifc")&&(this.disableFillCheck=1),(this.standout.page.kargoDemoSite||e("rhsii")||t("ksl_immediate"))&&(this.showSpotlightImmediately=1),(t("rhift")||t("ksl_ifc"))&&(this.forceTiming=1),(e("scidemokey")||e("ksl_demokey"))&&(this.disableFillCheck=1,this.demoAdType="Demo Creative",this.demoKey=e("scidemokey")||e("ksl_demokey")||null),this.demoKey&&(this.spotlightInarticleAvailable=1,this.spotlightOverlayAvailable=1,this.spotlightMastheadAvailable=1),e("ksl_closestyle")&&(this.overlayCloseButtonStyle=Number(e("ksl_closestyle"))||0,e("ksl_closescale")&&(this.overlayCloseButtonScale=Number(e("ksl_closescale"))||100)),i("ksl_maxwidth")&&(this.overrideMaxWidth=Number(e("ksl_maxwidth"))),i("ksl_mhfullwidth")&&(this.mhFullWidth=t("ksl_mhfullwidth")),i("ksl_inarticlesticky")&&(this.inarticleSticky=Number(e("ksl_inarticlesticky"))),this.inarticleSticky=2,(t("sci_disable")||t("ksl_disable"))&&(this.disableSpotlight=1),this.forceEnable&&this.demoKey&&this.setUp(0,{})}addListeners(){this.standout.listeners.subscribeToEvent("mousemove",0,this.unidleAction.bind(this)),this.standout.listeners.subscribeToEvent("mouseout",9,this.mouseoutAction.bind(this)),this.standout.listeners.subscribeToEvent("blur",0,this.blurAction.bind(this)),requestAnimationFrame(this.navAccessTimer.bind(this)),this.standout.device.mobile&&!this.standout.device.ua.includes("android")&&(this.standout.device.ua.includes("crios")||this.standout.device.ua.includes("chrome"))||this.standout.listeners.subscribeToEvent("resize",0,this.chromeResizeAction.bind(this)),this.standout.listeners.subscribeToEvent("touchstart",0,this.touchStartAction.bind(this)),this.standout.listeners.subscribeToEvent("touchmove",0,this.touchMoveAction.bind(this)),this.standout.listeners.subscribeToEvent("touchend",0,this.touchEndAction.bind(this)),this.standout.listeners.subscribeToEvent("touchcancel",0,this.touchCancelAction.bind(this)),this.standout.listeners.subscribeToEvent("scroll",0,this.scrollAction.bind(this)),!this.navigationListener&&"navigation"in window&&(this.navigationListener=e=>this.navigateAction(e),window.navigation.addEventListener("navigate",this.navigationListener));const e=()=>{const t=()=>{this.checkAdExpiration(),e()};"requestIdleCallback"in window?requestIdleCallback(t,{timeout:2e3}):setTimeout(t,2e3)};e();let t=0;const i=e=>{e-t>=500&&(this.checkGoogleVignette(),t=e),requestAnimationFrame(i)};requestAnimationFrame(i)}loadServerSettings(e){if(this.lastServerSettings=e?s({},e):null,this.forceEnable)e.prdef&&e.prdef.masthead&&e.prdef.masthead.navSelector&&!this.mastheadNavSelector&&(this.mastheadNavSelector=e.prdef.masthead.navSelector),e.prdef&&e.prdef.infeed&&e.prdef.infeed.articleSelector&&!this.articleContentSelector&&(this.articleContentSelector=e.prdef.infeed.articleSelector),(e.prdef&&e.prdef.masthead&&e.prdef.masthead.enabled||this.spotlightMastheadAllowed)&&(this.placements.masthead.configScript=e.prdef.masthead.configScript,this.executeConfigScript("masthead")),(e.prdef&&e.prdef.infeed&&e.prdef.infeed.enabled||this.spotlightInarticleAllowed)&&(this.placements.inarticle.configScript=e.prdef.infeed.configScript,this.executeConfigScript("inarticle")),(e.prdef&&e.prdef.overlay&&e.prdef.overlay.enabled||this.spotlightOverlayAllowed)&&(this.placements.overlay.configScript=e.prdef.overlay.configScript,this.executeConfigScript("overlay"));else{const t=e.prdef||{};this.setUp(!(1==(t.infeed||{}).enabled||1==(t.masthead||{}).enabled||1==(t.overlay||{}).enabled),e)}}setUpPlacements(e){if(this.forceEnable)return this.spotlightInarticleAllowed&&(this.placements.inarticle.enabled=1,this.setUpInarticleContainer()),this.spotlightOverlayAllowed&&(this.placements.overlay.enabled=1,this.setUpOverlayContainer()),this.spotlightMastheadAllowed&&(this.placements.masthead.enabled=1,this.setUpMastheadContainer()),void(this.showSpotlightImmediately&&this.showSpotlight(null,0,1,1,1,"demo"));if(!e.prdef)return;const t=this.clientOverrides();!e.prdef.infeed||"enabled"in t.slots.inArticle&&!t.slots.inArticle.enabled?this.spotlightInarticleAllowed=0:("frequencyCap"in e.prdef.infeed&&(this.frequencyCapInarticle=Number(e.prdef.infeed.frequencyCap)),"frequencyCap"in t.slots.inArticle&&(this.frequencyCapInarticle=Number(t.slots.inArticle.frequencyCap)),this.frequencyCapInarticle<1e3&&(this.frequencyCapInarticle=60*this.frequencyCapInarticle),(e.prdef.infeed.enabled||this.spotlightInarticleAllowed)&&(this.spotlightInarticleAllowed=1,this.placements.inarticle=e.prdef.infeed,this.executeConfigScript("inarticle"),this.placements.inarticle.enabled=1,this.recordedInarticleEligibility||(this.recordedInarticleEligibility=1,this.setUpInarticleContainer()),e.prdef.infeed.triggers&&e.prdef.infeed.triggers.idleTriggerTime&&(this.minIdleTime=Number(e.prdef.infeed.triggers.idleTriggerTime)),e.prdef.infeed.triggers.endOfArticleElement&&(this.triggerElementConfig.selector=e.prdef.infeed.triggers.endOfArticleElement))),!e.prdef.overlay||"enabled"in t.slots.overlay&&!t.slots.overlay.enabled?this.spotlightOverlayAllowed=0:("frequencyCap"in e.prdef.overlay&&(this.frequencyCapOverlay=Number(e.prdef.overlay.frequencyCap)),"frequencyCap"in t.slots.overlay&&(this.frequencyCapOverlay=Number(t.slots.overlay.frequencyCap)),this.frequencyCapOverlay<1e3&&(this.frequencyCapOverlay=60*this.frequencyCapOverlay),(e.prdef.overlay.enabled||this.spotlightOverlayAllowed)&&(this.spotlightOverlayAllowed=1,this.placements.overlay=e.prdef.overlay,this.executeConfigScript("overlay"),this.placements.overlay.enabled=1,this.recordedOverlayEligibility||(this.recordedOverlayEligibility=1,this.setUpOverlayContainer()),e.prdef.overlay.triggers&&e.prdef.overlay.triggers.idleTriggerTime&&(this.minIdleTime=Number(e.prdef.overlay.triggers.idleTriggerTime)),e.prdef.overlay.triggers&&e.prdef.overlay.triggers.scrollToTopThreshold&&(this.overlayScrollToTopScrollDownThreshold=Number(e.prdef.overlay.triggers.scrollToTopThreshold)),"1"===window.sessionStorage.getItem("ksl-tr-interarticle")&&this.setPlacementTriggerValue(this.placements.overlay,"interArticleLinks",1),e.prdef.overlay.triggers.endOfArticleElement&&(this.triggerElementConfig.selector=e.prdef.overlay.triggers.endOfArticleElement))),!e.prdef.masthead||"enabled"in t.slots.masthead&&!t.slots.masthead.enabled?this.spotlightMastheadAllowed=0:("frequencyCap"in e.prdef.masthead&&(this.frequencyCapMasthead=Number(e.prdef.masthead.frequencyCap)),"frequencyCap"in t.slots.masthead&&(this.frequencyCapMasthead=Number(t.slots.masthead.frequencyCap)),this.frequencyCapMasthead<1e3&&(this.frequencyCapMasthead=60*this.frequencyCapMasthead),"autoscrollThreshold"in e.prdef.masthead&&(this.mastheadAutoscrollThreshold=Number(e.prdef.masthead.autoscrollThreshold)),(e.prdef.masthead.enabled||this.spotlightMastheadAllowed)&&(this.spotlightMastheadAllowed=1,this.placements.masthead=e.prdef.masthead,this.executeConfigScript("masthead"),this.placements.masthead.enabled=1,this.recordedMastheadEligibility||(this.recordedMastheadEligibility=1,this.setUpMastheadContainer()),e.prdef.masthead.triggers&&e.prdef.masthead.triggers.idleTriggerTime&&(this.minIdleTime=Number(e.prdef.masthead.triggers.idleTriggerTime)),e.prdef.masthead.triggers&&e.prdef.masthead.triggers.scrollToTopThreshold&&(this.mastheadScrollToTopScrollDownThreshold=Number(e.prdef.masthead.triggers.scrollToTopThreshold)),e.prdef&&e.prdef.masthead&&e.prdef.masthead.navSelector&&!this.mastheadNavSelector&&(this.mastheadNavSelector=e.prdef.masthead.navSelector),e.prdef.masthead.triggers.endOfArticleElement&&(this.triggerElementConfig.selector=e.prdef.masthead.triggers.endOfArticleElement)))}fillOverlayDemo(e,t,i,s=0){if(!this.spotlightOverlayAllowed)return;const n=e.fo;if(!s&&((e.ex||"").toLowerCase().includes("video")||(n||"").toLowerCase().includes("video")))return;(e.composer||this.isCoreCreative(e.fo,e.ex)||"FabrikOutstream"==e.fo)&&(i.style.width="100%"),e.composer&&(i.style.backgroundColor="white");let o=e.upper;e.cType&&t.classList.add(e.cType),!this.standout.page.kargoDemoSite||window==window.top||e.fo&&"FabrikOutstream"==e.fo||(o=this.celtraFrameHack(o)),o&&o.includes("creative_source=composer")?this.wrapAndAppendComposerCreative(o,i):g(o).forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&i.appendChild(t)}else c(e),i.appendChild(e)}))}processDemoCreativeString(e){if(e&&e.includes("'maxWidth':")&&e.includes("/KAP.")){const t=e.split("'maxWidth':")[1].split(",")[0];t&&Number(t)&&(e='<div style="max-width:100%;width:'+t+'px;">'+e+"</div>")}return e}setDemoCreativeLabel(e){const t=document.querySelector("#ksl-demo-summary");if(!t)return;let i=t.querySelector("#ksl-creative-summary");i||(i=p("span",null,null,"display:block"),i.id="ksl-creative-summary",t.appendChild(i)),i.innerText=e}fetchSpotlightDemoData(t=null,i=null){if(this.demoData)return;const s=this.standout.settings.doDemo,n=this.demoAdType;let o=this.demoKey||null;if(!o&&s&&(o=s),!("Demo Creative"===n&&o||s))return;try{const e=window.top&&window.top.location?window.top.location.href:"";o&&e.startsWith("https://demo.kargo.com/dm/")?o="dm_"+o.split("_")[1]:o&&e.startsWith("https://demo.kargo.com/preview/")&&(o="km_"+o.split("_")[1])}catch(e){}const a=this.standout.communications,l=this.standout.renderer,r=this.standout.logger,d=()=>{this.demoData&&(this.spotlightOverlayAvailable=1,this.spotlightMastheadAvailable=1,this.spotlightInarticleAvailable=1,t&&i&&this.fillOverlayDemo(this.demoData,t,i),this.placements.masthead.container&&this.fillMastheadDemo(this.demoData,this.placements.masthead.container,this.placements.masthead.bodyElement))},h=window.self!==window.top?1:0,c=this.standout.page.kargoDevDemoSite;if(o&&o.startsWith("celtra_")){this.demoData={waiting:1};const t=o.split("celtra_")[1];return void a.post(e.apiDom+"v2/demo/ctr",{id:t,iniframe:h},(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);t&&t.id&&(this.demoData={upper:l.generateCeltraTag(t.id),lower:null,overlay:null,bg:null,cType:"spotlight",settings:{},composer:t.composer,fo:t.fo,ex:t.ex},this.setDemoCreativeLabel(this.standout.settings.debugMode?`KM Creative ${t.id} (${t.fo} | ${t.ex})`:`KM Creative (${t.fo} | ${t.ex})`),d())}catch(e){}else this.demoData={upper:l.generateCeltraTag(t),lower:null,overlay:null,bg:null,cType:"spotlight",settings:{}},this.setDemoCreativeLabel("Celtra Creative "+t),d()}))}if(o&&o.startsWith("km_")){this.demoData={waiting:1};const t=o.split("km_")[1];return void a.post(e.apiDom+"v2/demo/kmr",{id:t,cat:1,dev:c,iniframe:h},(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);t&&t.snippet&&(this.demoData={upper:this.processDemoCreativeString(t.snippet),lower:null,overlay:null,bg:null,cType:"kmr",settings:{},composer:t.composer,fo:t.fo,ex:t.ex},this.setDemoCreativeLabel(this.standout.settings.debugMode?`KM Creative ${t.id} (${t.fo} | ${t.ex})`:`KM Creative (${t.fo} | ${t.ex})`),l.preloadCeltraAssets(t.snippet),d())}catch(e){}else this.demoData={upper:null,lower:null,overlay:null,bg:null,cType:"kmr",settings:{}},d()}))}if(o&&o.startsWith("db_")){this.demoData={waiting:1};const t=o.split("db_")[1];return void a.post(e.apiDom+"v2/demo/kmd",{id:t,dev:c,iniframe:h},(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);t&&t.snippet&&(this.demoData={upper:this.processDemoCreativeString(t.snippet),lower:null,overlay:null,bg:null,cType:"kmd",settings:{},composer:t.composer,fo:t.fo,ex:t.ex},this.setDemoCreativeLabel(this.standout.settings.debugMode?`KM Demo ${t.id} (${t.fo} | ${t.ex})`:`KM Demo (${t.fo} | ${t.ex})`),l.preloadCeltraAssets(t.snippet),d())}catch(e){}else this.demoData={upper:null,lower:null,overlay:null,bg:null,cType:"kmd",settings:{}},d()}))}if(o&&o.startsWith("dm_")){this.demoData={waiting:1};const t=o.split("dm_")[1];return void a.post(e.apiDom+"v2/demo/dmr",{id:t,cat:1,dev:c,iniframe:h},(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);t&&t.snippet&&(this.demoData={upper:this.processDemoCreativeString(t.snippet),lower:null,overlay:null,bg:null,cType:"dmr",settings:{},composer:t.composer,fo:t.fo,ex:t.ex},this.setDemoCreativeLabel(this.standout.settings.debugMode?`DM Creative ${t.id} (${t.fo} | ${t.ex})`:`DM Creative (${t.fo} | ${t.ex})`),l.preloadCeltraAssets(t.snippet),d())}catch(e){}else this.demoData={upper:null,lower:null,overlay:null,bg:null,cType:"dmr",settings:{}},d()}))}if(o&&o.startsWith("celtratag_")){r.log("Doing celtra tag demo");const e=o.split("celtratag_")[1];return this.demoData={upper:l.generateCeltraTag(e),lower:null,overlay:null,bg:null,cType:"spotlight",settings:{}},this.setDemoCreativeLabel(this.standout.settings.debugMode?"Celtra Creative "+e:"Celtra Creative"),void d()}this.standout.logger.SDTLog(56,null,{demo:"Demo Creative"===n?o:s}),this.demoData={waiting:1};const p={};p.demo="Demo Creative"===n?o:s,a.post(e.apiDom+"v2/demo/ast",p,(e=>{if(e&&"TIMEOUT"!==e)try{const t=JSON.parse(e);this.demoData=t,this.setDemoCreativeLabel("ESP Demo "+(o||"")),t&&t.upper&&l.preloadCeltraAssets(t.upper),d()}catch(e){}else this.demoData=null}))}setUpOverlayContainer(){if(this.placements.overlay.container)return;const t=document,i=t.createElement("DIV");if(i.className="ksc-in-con",i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.right="0",i.style.bottom="0",i.style.backgroundColor=this.overlayBackground||"#fff",i.style.zIndex=(this.overlayZIndex||999999)+"",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.height="initial",!this.standout.device.mobile&&this.standout.page.kargoDemoSite){i.style.top="50px",i.style.zIndex="100";const e=t.querySelector('button[class*="LeftNavigationComponents_toggle"]');if(e){if(e.className.includes("toggleOpen")){const e=t.querySelector('div[class*="MuiDrawer-docked"]');e&&(i.style.left=e.clientWidth+"px")}else i.style.left="0";new MutationObserver((e=>{e.forEach((e=>{if("attributes"===e.type&&"class"==e.attributeName)if(e.target.className.includes("toggleOpen")){const e=t.querySelector('div[class*="MuiDrawer-docked"]');e&&(i.style.left=e.clientWidth+"px")}else i.style.left="0"}))})).observe(e,{attributes:1,attributeFilter:["class"]})}}this.overlayMouseDownListener||(this.overlayMouseDownListener=e=>this.overlayMousedown(e)),i.addEventListener("mousedown",this.overlayMouseDownListener);const s=t.createElement("style");s.innerHTML+=".ksc-in-con .celtra-ad-inline-host { height: 100% !important; min-height: initial !important; }",s.innerHTML+=".ksc-in-con { min-height: initial !important; }",s.innerHTML+=".ksc-in-con .rhi-ab { min-height: initial !important; }",s.innerHTML+=".ksc-container { min-height: initial !important; }",s.innerHTML+=".ksc-container .ksc-ia-ab { min-height: initial !important; }",s.innerHTML+=".ksc-container .celtra-ad-inline-host { min-height: initial !important; }",s.innerHTML+=".ksl_overlay_displayed { height: 100%; overflow: hidden; }",s.innerHTML+=".ksc-in-con.fullscreen .rhi-ab {height:100%;width:100%;max-height:100%;max-width:100%;}",s.innerHTML+=".ksc-in-con.fullscreen #ksc-in-x {right:5px !important;top:5px !important;}",s.innerHTML+=".ksc-ia-ab .celtra-ad-inline-host .notranslate,.ksc-masthead-ab .celtra-ad-inline-host .notranslate,.rhi-ab .celtra-ad-inline-host .notranslate {max-width: initial !important;max-height: initial !important;position: initial !important;}",s.innerHTML+=".ksc-container.fullscreen > div {height:100%;width:100%;}",s.innerHTML+=".ksc-in-con div[data-embed-url], .ksc-in-con .twitter-tweet-rendered {padding:0 35px;}",s.innerHTML+=".krg-at-container {width:100% !important}",s.innerHTML+=".st-adunit,#inScreen.st-placement .st-reset {z-index:"+e.zIndexMax+" !important;}",s.innerHTML+='.rhi-ab div[data-format="FabrikOutstream"] .kargo-banner-optout.show { position:absolute !important;top:-34px !important;left:50% !important;transform:translateX(-50%);}',t.head.appendChild(s);const n=t.createElement("DIV");n.style.cssText="position:absolute;top:0;left:0;z-index:1;",i.appendChild(n);const o=t.createElement("DIV");o.className="rhi-ab",i.appendChild(o);const a=t.createElement("DIV");a.style.cssText="padding:12px 0 15px 0;text-align:center;position:absolute;bottom:0;right:0;",i.appendChild(a);const l=t.createElement("DIV");l.style.zIndex=e.zIndexMax+"",l.style.top="0",l.style.left="0",l.style.right="0",l.style.bottom="0",l.style.backgroundColor="transparent",l.style.opacity="0",o.appendChild(l),this.fetchSpotlightDemoData(i,o);const r=t.createElement("a");r.id="ksc-in-ct",r.innerText=""+this.countdownTime,r.href="#",r.style.color=this.overlayForeground,r.style.textShadow="0 0 4px rgba(0,0,0,0.7)",r.style.padding="12px 12px",a.appendChild(r);const d=t.createElement("img"),h=this.overlayCloseButtonScale/100;let c;0==this.overlayCloseButtonStyle?(d.src=e.cdnDom+"img/nclose.png",c=this.standout.device.mobile?"position: absolute;bottom:-54px;left:50%;z-index:50;":"position:absolute;right:-4px;top:-59px;z-index:999999999;padding-left:40px;padding-bottom:40px;",d.style.width=32*h+"px"):1==this.overlayCloseButtonStyle?this.standout.device.mobile?(d.src=e.cdnDom+"img/close-btn-mobile.svg",c="position: absolute;bottom:-"+(92-(72-72*h))+"px;left:50%;z-index:"+(this.overlayZIndex+1)+";",d.style.minWidth=this.overlayCloseButtonScale/100*72+"px"):(d.src=e.cdnDom+"img/close-btn-desktop.svg",c="position:absolute;right:-1px;top:-"+(59-(34-34*h))+"px;z-index:999999999;padding-left:40px;padding-bottom:40px;",d.style.minHeight=34*h+"px",d.style.minWidth=108.6*h+"px"):2==this.overlayCloseButtonStyle?this.standout.device.mobile?(d.src=e.cdnDom+"img/close-btn-mobile-shadows.svg",c="position: absolute;bottom:-"+(92-(72-72*h))+"px;left:50%;z-index:"+(this.overlayZIndex+1)+";",d.style.minWidth=this.overlayCloseButtonScale/100*72+"px"):(d.src=e.cdnDom+"img/close-btn-desktop-shadows.svg#svgView(viewBox(0,-6,159,68))",c="position:absolute;right:-"+(11-(11-10*h))+"px;top:-"+(66-(45-45*h))+"px;z-index:999999999;padding-left:40px;padding-bottom:40px;",d.style.minHeight=this.overlayCloseButtonScale/100*45+"px"):3==this.overlayCloseButtonStyle?this.standout.device.mobile?(d.src=e.cdnDom+"img/close-btn-desktop.svg",c="padding-top:20px;padding-bottom:40px;padding-left:8px;padding-right:8px;position: absolute;bottom:-"+(88-(0-0*h))+"px;left:50%;z-index:"+(this.overlayZIndex+1)+";",d.style.minHeight=38*h+"px",d.style.minWidth=121.4*h+"px"):(d.src=e.cdnDom+"img/close-btn-desktop.svg",c="position:absolute;right:-1px;top:-"+(54-(34-34*h))+"px;z-index:999999999;padding-left:40px;padding-bottom:20px;",d.style.minHeight=this.overlayCloseButtonScale/100*34+"px",d.style.minWidth=108.6*h+"px"):4==this.overlayCloseButtonStyle&&(this.standout.device.mobile?(d.src=e.cdnDom+"img/close-btn-desktop-shadows.svg#svgView(viewBox(0,-6,159,68))",c="position: absolute;bottom:-"+(64-(50-50*h))+"px;left:50%;z-index:"+(this.overlayZIndex+1)+";",d.style.minHeight=this.overlayCloseButtonScale/100*50+"px"):(d.src=e.cdnDom+"img/close-btn-desktop-shadows.svg#svgView(viewBox(0,-6,159,68))",c="position:absolute;right:-"+(11-(11-10*h))+"px;top:-"+(66-(45-45*h))+"px;z-index:999999999;padding-left:40px;padding-bottom:40px;",d.style.minHeight=this.overlayCloseButtonScale/100*45+"px")),d.style.height=d.style.minHeight,d.style.width=d.style.minWidth,d.style.display="block";const p=t.createElement("a");p.id="ksc-in-x",p.href="#",this.standout.device.mobile?(p.setAttribute("style",c||""),p.className="ksc-in-x-bc",p.dataset.position="bottom-center"):(p.setAttribute("style",c||""),p.className="ksc-in-x-tr",p.dataset.position="top-right"),p.appendChild(d),o.appendChild(p);const g=t.createElement("div");g.className="ksl-adv-lbl",q(["dailymail.co.uk"])?(g.dataset.position="top-left",g.style.cssText="position: absolute;left: -1px;top: -18px;z-index: 999999999;color: #bababa;font-size: 11px;transform-origin: left bottom;",this.standout.device.mobile&&(g.style.left="5px"),g.innerText="ADVERTISEMENT"):(g.dataset.position="bottom-center",g.role="img",g.setAttribute("aria-label","Advertisement"),g.style.backgroundImage="url("+e.cdnDom+"img/advlblw.png)",g.style.backgroundRepeat="no-repeat",g.style.backgroundSize="contain",g.style.position="absolute",g.style.left="50%",g.style.transform="translateX(-50%)",g.style.height="9px",g.style.width="110px",g.style.opacity="0.6",g.style.zIndex=this.overlayZIndex+"",this.standout.device.mobile?g.style.top="-20px":g.style.bottom="-14px"),q(["dailymail.co.uk"])||this.standout.serverSettings.showAdvLabel||(g.style.display="none"),o.appendChild(g),this.placements.overlay.container=i,this.placements.overlay.bodyElement=o,this.placements.overlay.closeLink=p,this.placements.overlay.continueLink=r,this.placements.overlay.clickBlocker=l,this.placements.overlay.advLabel=g,i.style.opacity="0",i.style.visibility="hidden",t.body?t.body.appendChild(i):t.documentElement&&t.documentElement.appendChild(i)}celtraFrameHack(e){if(e)return(e=e.replace("params = {","params = {'purpose':'preview',")).replace("web.js","preview.js")}fillMastheadDemo(e,t,i,s=0){const n=e.fo;if(!s&&((e.ex||"").toLowerCase().includes("video")||(n||"").toLowerCase().includes("video")))return;(e.composer||this.isCoreCreative(e.fo,e.ex))&&(i.style.width="100%",t.style.width="100%");let o=e.upper;e.cType&&t.classList.add(e.cType),!this.standout.page.kargoDemoSite||window==window.top||e.fo&&"FabrikOutstream"==e.fo||(o=this.celtraFrameHack(o)),o&&o.includes("creative_source=composer")||g(o).forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&i.appendChild(t)}else c(e),i.appendChild(e)}))}setUpMastheadContainer(){const t=document,i=t.createElement("div");i.style.cssText="display:flex;flex-direction:column;align-items:center;justify-content:center",i.className="ksc-container ksc-ia";const s=t.createElement("div");s.className="ksc-masthead-ab",i.appendChild(s),i.classList.add("ksc-masthead");let n=t.createElement("div");if(0==this.mastheadMode){const e=t.createElement("div");e.style.cssText="position: fixed;top: 0;left: 0;right: 0;z-index: "+this.overlayZIndex+";background-color: white;transition: all 300ms;transform:translateY(-100%);max-height:30vh;overflow:hidden;display:flex;justify-content:center;",e.className="sci-topsticky",e.appendChild(i),e.style.display="none",t.body.appendChild(e),this.placements.masthead.stickyElement=e,n=e}else if(1==this.mastheadMode){if(i.style.position="fixed",i.style.willChange="height",i.style.overflow="hidden",i.style.left="50%",i.style.transform="translateX(-50%)",n=t.createElement("div"),this.standout.page.kargoDemoSite&&this.standout.settings.qsBool("ksl_mastheadcolor")?n.style.cssText=this.standout.device.mobile?"top: 0;left: 0;right: 0;background-color: #e5e5e5;max-height:100vh;height:40vh;overflow:hidden;":"top: 0;left: 0;right: 0;background-color: #e5e5e5;max-height:40vh;height:40vh;overflow:hidden;":(n.style.cssText=this.standout.device.mobile?"top: 0;left: 0;right: 0;background-color: black;max-height:100vh;height:40vh;overflow:hidden;":"top: 0;left: 0;right: 0;background-color: black;max-height:40vh;height:40vh;overflow:hidden;",n.style.backgroundColor="white",this.placements.masthead.background&&(n.style.backgroundColor=this.placements.masthead.background)),!this.standout.device.mobile&&this.standout.serverSettings.showAdvLabel){const i=t.createElement("div");i.className="ksl-adv-lbl",i.dataset.position="top-center",i.role="img",i.setAttribute("aria-label","Advertisement"),i.style.backgroundImage="url("+e.cdnDom+"img/advlbl.png)",i.style.backgroundRepeat="no-repeat",i.style.backgroundSize="contain",i.style.position="absolute",i.style.left="50%",i.style.transform="translateX(-50%)",i.style.height="7px",i.style.width="80px",i.style.opacity="0.6",i.style.zIndex=this.overlayZIndex+"",i.style.top="12px",s.appendChild(i),s.style.paddingTop="22px"}else if(this.standout.device.mobile&&this.standout.serverSettings.showAdvLabel){const i=t.createElement("a");i.className="ksl-adv-icon",i.dataset.position="top-left",i.href="https://www.kargo.com/privacy",i.target="_blank",i.role="img",i.setAttribute("aria-label","Advertisement"),i.style.backgroundImage="url("+e.cdnDom+"img/bolt.png)",i.style.backgroundRepeat="no-repeat",i.style.backgroundSize="contain",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.height="19px",i.style.width="19px",i.style.zIndex=this.overlayZIndex+"",s.appendChild(i)}const o=t.querySelector("*[class*=Header_header__]");this.standout.page.kargoDemoSite&&o&&!this.standout.device.mobile&&(n.style.top=o.clientHeight+"px"),n.style.position="absolute",n.className="sci-topbanner";const a=t.querySelector("html");if(a){const e=(getComputedStyle(a).marginTop||"").split("px")[0].trim(),t=Number(e);Number.isNaN(t)||(n.style.marginTop=-t+"px",n.style.marginBottom=t+"px");const i=(getComputedStyle(a).paddingTop||"").split("px")[0].trim(),s=Number(i);Number.isNaN(s)||(n.style.paddingTop=-s+"px",n.style.paddingBottom=s+"px")}n.style.visibility="hidden",n.style.opacity="0",n.appendChild(i),this.standout.page.kargoDemoSite&&t.querySelector(".krg-preview")?(n.style.top="0",t.querySelector(".krg-preview").insertBefore(n,t.querySelector(".krg-preview").firstChild)):t.body.insertBefore(n,t.body.firstChild)}this.placements.masthead.bodyElement=s,this.placements.masthead.container=i,this.placements.masthead.parallaxElement=n,this.fetchSpotlightDemoData()}setUpInarticleContainer(){const t=document,i=t.createElement("div");i.style.cssText="display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:max-content;position:relative;overflow-y:clip;visibility:hidden;",i.className="ksc-container ksc-ia",i.style.maxHeight="0";const s=t.createElement("div");s.className="ksc-ia-ab",this.standout.device.mobile&&(s.style.width="100%"),i.appendChild(s);const n=t.createElement("div");n.className="ksl-adv-lbl",q(["dailymail.co.uk"])?(n.dataset.position="top-left",n.style.cssText="position:absolute;top:0px;left:-1px;text-align:left;color:gray;font-size:10px;",this.standout.device.mobile&&(n.style.left="5px"),n.innerText="ADVERTISEMENT"):(n.dataset.position="bottom-center",n.role="img",n.setAttribute("aria-label","Advertisement"),n.style.backgroundImage="url("+e.cdnDom+"img/advlbl.png)",n.style.backgroundRepeat="no-repeat",n.style.backgroundSize="contain",n.style.position="absolute",n.style.left="50%",n.style.transform="translateX(-50%)",n.style.height="7px",n.style.width="88px",n.style.opacity="0.6",n.style.zIndex=this.overlayZIndex+"",n.style.top="-0px"),q(["dailymail.co.uk"])||this.standout.serverSettings.showAdvLabel?(s.style.position="relative",s.style.paddingTop="18px"):n.style.display="none",s.appendChild(n),this.placements.inarticle.bodyElement=s,this.placements.inarticle.container=i,this.placements.inarticle.advLabel=n,this.fetchSpotlightDemoData()}setUpAuctions(e,t=0){if(!e.bdef||!e.bdef.display||this.forceEnable)return;if(!t&&!this.standout.page.checkKargoPresent())return void setTimeout((()=>{this.setUpAuctions(e,1)}),1e3);const i=[],s=[],n=[];let o=null,a=null,l=null,r=0;const h=this.standout.device.mobile,c=(e.bdef.display.prebid||{}).bidders||[];for(let t=0;t<c.length;t++){const d=c[t];(d.enabled||this.forceSpotlight)&&("kargo"!=d.bidder&&this.standout.page.checkForBTO()||(!this.placements.overlay.enabled||"overlay"!=d.products&&"all"!=d.products||("kargo"==d.bidder?o=h?d.mobileSlot:d.desktopSlot:"amazon"==d.bidder&&(d.enabled&&(e.bdef.display.amazon||{}).enabled||this.forceSpotlight)?(this.placements.overlay.amazonAdUnit=h?d.mobileAdUnitPath:d.desktopAdUnitPath,r=1):"gam"==d.bidder&&(this.placements.overlay.gamEnabled=1),(d.enabled||this.forceSpotlight)&&i.push(d)),!this.placements.masthead.enabled||"masthead"!=d.products&&"all"!=d.products||("kargo"==d.bidder?l=h?d.mobileSlot:d.desktopSlot:"amazon"==d.bidder&&(d.enabled&&(e.bdef.display.amazon||{}).enabled||this.forceSpotlight)?(this.placements.masthead.amazonAdUnit=h?d.mobileAdUnitPath:d.desktopAdUnitPath,r=1):"gam"==d.bidder&&(this.placements.masthead.gamEnabled=1),(d.enabled||this.forceSpotlight)&&s.push(d)),!this.placements.inarticle.enabled||"infeed"!=d.products&&"inarticle"!=d.products&&"all"!=d.products||("kargo"==d.bidder?a=h?d.mobileSlot:d.desktopSlot:"amazon"==d.bidder&&(d.enabled&&(e.bdef.display.amazon||{}).enabled||this.forceSpotlight)?(this.placements.inarticle.amazonAdUnit=h?d.mobileAdUnitPath:d.desktopAdUnitPath,r=1):"gam"==d.bidder&&(this.placements.inarticle.gamEnabled=1),(d.enabled||this.forceSpotlight)&&n.push(d))))}r&&("apstag"in window||(d("https://c.amazon-adsystem.com/aax2/apstag.js",1),this.standout.bidStack.initializeApsTag(e))),i.length&&(this.placements.overlay.auctionConfig={id:"ei_overlay",type:"spotlight",placement:"overlay",adSlot:o,bidders:i,amazonAdUnit:this.placements.overlay.amazonAdUnit,amazon:r,completion:(e,t)=>{e&&(this.placements.overlay.auctionId=t.decisions.auctionId,this.placements.overlay.fill=t.decisions,this.placements.overlay.adSlotId=o,t.decisions.waitForGam?this.standout.bidStack.createGamContainer(this.placements.overlay.bodyElement,t.decisions.auctionId):(this.spotlightOverlayAvailable=1,this.adFilledTime=Date.now()))}},this.spotlightAuctionTimingEligible(0)?this.standout.bidStack.runPbjs(this.placements.overlay.auctionConfig):this.placements.overlay.waitingForEligibility=1),s.length&&(this.placements.masthead.auctionConfig={id:"ei_masthead",type:"spotlight",placement:"masthead",bidders:s,adSlot:l,amazonAdUnit:this.placements.masthead.amazonAdUnit,amazon:r,completion:(e,t)=>{e&&(this.placements.masthead.auctionId=t.decisions.auctionId,this.placements.masthead.fill=t.decisions,this.placements.masthead.adSlotId=l,t.decisions.waitForGam?this.standout.bidStack.createGamContainer(this.placements.masthead.bodyElement,t.decisions.auctionId):(this.spotlightMastheadAvailable=1,this.adFilledTime=Date.now()))}},this.spotlightAuctionTimingEligible(2)?this.standout.bidStack.runPbjs(this.placements.masthead.auctionConfig):this.placements.masthead.waitingForEligibility=1),n.length&&(this.placements.inarticle.auctionConfig={id:"ei_inarticle",type:"spotlight",placement:"inarticle",bidders:n,adSlot:a,amazonAdUnit:this.placements.inarticle.amazonAdUnit,amazon:r,completion:(e,t)=>{e&&(this.placements.inarticle.auctionId=t.decisions.auctionId,this.placements.inarticle.fill=t.decisions,this.placements.inarticle.adSlotId=a,t.decisions.waitForGam?this.standout.bidStack.createGamContainer(this.placements.inarticle.bodyElement,t.decisions.auctionId):(this.spotlightInarticleAvailable=1,this.adFilledTime=Date.now()))}},this.spotlightAuctionTimingEligible(1)?this.standout.bidStack.runPbjs(this.placements.inarticle.auctionConfig):this.placements.inarticle.waitingForEligibility=1)}checkAuctionRerequestInterval(){this.placements.overlay.auctionConfig&&this.placements.overlay.waitingForEligibility&&this.spotlightAuctionTimingEligible(0)&&(this.standout.logger.log("Overlay has become eligible"),this.placements.overlay.waitingForEligibility=0,this.standout.bidStack.runPbjs(this.placements.overlay.auctionConfig)),this.placements.inarticle.auctionConfig&&this.placements.inarticle.waitingForEligibility&&this.spotlightAuctionTimingEligible(1)&&(this.standout.logger.log("In-Article has become eligible"),this.placements.inarticle.waitingForEligibility=0,this.standout.bidStack.runPbjs(this.placements.inarticle.auctionConfig)),this.placements.masthead.auctionConfig&&this.placements.masthead.waitingForEligibility&&this.spotlightAuctionTimingEligible(2)&&(this.standout.logger.log("Masthead has become eligible"),this.placements.masthead.waitingForEligibility=0,this.standout.bidStack.runPbjs(this.placements.masthead.auctionConfig))}setUp(e,t){if(this.disableSpotlight)return;if(this.didSetUp)return;this.didSetUp=1,this.standout.logger.SDTLog(158,null,(null==t?void 0:t.interstitial)||{}),this.spotlightSettings=(null==t?void 0:t.interstitial)||{},this.spotlightSettings.adTags=(null==t?void 0:t.inAdTags)||[],this.spotlightEnabled=1,this.setUpPlacements(t),this.setUpAuctions(t),e&&(this.mocking=1,this.spotlightOverlayAvailable=1,this.spotlightInarticleAvailable=1,this.spotlightMastheadAvailable=1),this.setUpOverlayContainer(),this.windowClickListener||(this.windowClickListener=t=>{if(this.unidleAction(t),this.showingOverlay)return;let i=t.target,s=null;for(;i&&i!==document.body&&!s;)"A"===i.tagName&&(s=i),i=i.parentElement;if(!s)return;const n=s.href||"";if(!n||n.startsWith("#")||n.startsWith(window.location.href+"#"))return;const o=(s.hostname||"").toLowerCase()!==window.location.hostname.toLowerCase(),a=this.triggersAvailable();if(o&&a.overlay.external){if(!this.forceTiming&&!this.timingEligible(0))return;if(!this.spotlightOverlayAvailable)return void this.recordSpotlightNoFillAvail(1,0,0,"externallink");e?this.mockShowSpotlight(1,0,0,"externallink"):(t.preventDefault(),this.showSpotlight(n,0,1,0,0,"externallink"))}},document.addEventListener("click",this.windowClickListener,1));const i=this.triggersAvailable();if(!this.refocusListenersAdded&&(i.overlay.refocus||i.inarticle.refocus||i.masthead.refocus)){const t=()=>{if("visible"!==document.visibilityState)return;if(this.showingOverlay)return;const t=this.nextPlacement(1);(this.forceTiming||this.timingEligible(t))&&(this.spotlightOverlayAvailable||this.spotlightInarticleAvailable||this.spotlightMastheadAvailable?e?this.mockShowSpotlight(1,1,1,"refocus"):this.showSpotlight(null,0,1,1,1,"refocus"):this.recordSpotlightNoFillAvail(1,1,1,"refocus"))},i=e=>{const i=document.visibilityState;if(this.standout.logger.log("Refocus event triggered: "+e.type,"Tab visibility "+i),e.target&&e.target!==window)return;if("hidden"===i)return void(this.wasDocumentHidden=1);if("visible"!==i)return;const s=this.wasDocumentHidden;if(s&&(this.wasDocumentHidden=0),"visibilitychange"===e.type){if(!s)return;return this.skipNextFocusRefocus=1,void t()}if("focus"===e.type){if(this.skipNextFocusRefocus)return void(this.skipNextFocusRefocus=0);if(!s){const e=Date.now();var n;if(!this.lastBlurTimestamp||e-this.lastBlurTimestamp<3e3)return void this.standout.logger.log("Refocus blocked: focus fired "+(e-(null!=(n=this.lastBlurTimestamp)?n:0))+"ms after blur")}t()}};this.documentVisibilityListener=i,this.windowFocusListener=i,document.addEventListener("visibilitychange",this.documentVisibilityListener,1),window.addEventListener("focus",this.windowFocusListener,1),this.refocusListenersAdded=1}if(!this.idleIntervalId&&(i.overlay.idleTime||i.inarticle.idleTime||i.masthead.idleTime)){let t=Date.now();const i=()=>{const s=Date.now();if(s-t<500)return void requestAnimationFrame(i);if(t=s,"visible"!==document.visibilityState)return void requestAnimationFrame(i);if(s-this.lastInidleTime<1e3*this.minIdleTime)return void requestAnimationFrame(i);if(this.showingOverlay)return void requestAnimationFrame(i);const n=this.nextPlacement(1);if(!this.forceTiming&&!this.timingEligible(n))return this.lastInidleTime=s,void requestAnimationFrame(i);this.spotlightOverlayAvailable||this.spotlightInarticleAvailable||this.spotlightMastheadAvailable?(e?this.mockShowSpotlight(1,1,1,"idletime"):this.showSpotlight(null,0,1,1,1,"idletime"),requestAnimationFrame(i)):requestAnimationFrame(i)};requestAnimationFrame(i),this.idleIntervalId=1}}executeConfigScript(e){var t;const i=null==(t=this.placements)?void 0:t[e];if(!i)return;const s=i.configScript||i.configscript;if("string"!=typeof s||0===s.trim().length)return;const n=e+":"+s;if(this.executedConfigScripts.has(n))return;this.executedConfigScripts.add(n);const o=document.createElement("script");o.type="text/javascript",o.text=s,o.dataset.ksoConfig=e,(document.head||document.documentElement).appendChild(o)}setPlacementTriggerValue(e,t,i){if(!e)return;const s=this.getPlacementTriggerTargets(e);for(const e of s)e[t]=i}getPlacementTriggerTargets(e){if(!e)return[];const t=[];return e.triggers&&t.push(e.triggers),e.mobileTriggers&&t.push(e.mobileTriggers),e.desktopTriggers&&t.push(e.desktopTriggers),t.length||(e.triggers={},t.push(e.triggers)),t}getPlacementTriggersForDevice(e){if(!e)return{};const t=e.triggers?i(e.triggers):{},n=this.standout.device.mobile?e.mobileTriggers:e.desktopTriggers;return n?s(t,n,0)||{}:t}clientOverrides(){return s({slots:{overlay:{},inArticle:{},masthead:{}}},window.spotlightConfig||{})}logExternally(e,t){const i=this.clientOverrides().eventListener;i&&i(e,t),this.spotlightEventListeners&&this.spotlightEventListeners.forEach((i=>{"cpm"in t&&delete t.cpm,i(e,t)}))}isCoreCreative(e,t){const i=(e||"").toLowerCase(),s=(t||"").toLowerCase();return s&&"core"==s.toLowerCase()||i&&"videoventi"==i?1:0}triggersAvailable(){const e={overlay:i(this.triggers),inarticle:i(this.triggers),masthead:i(this.triggers)};if(this.placements.overlay.enabled){const t=this.getPlacementTriggersForDevice(this.placements.overlay);e.overlay=this.supplementTriggers(s(e.overlay,t||{},0))}if(this.placements.inarticle.enabled){const t=this.getPlacementTriggersForDevice(this.placements.inarticle);e.inarticle=this.supplementTriggers(s(e.inarticle,t||{},1))}if(this.placements.masthead.enabled){const t=this.getPlacementTriggersForDevice(this.placements.masthead);e.masthead=this.supplementTriggers(s(e.masthead,t||{},1))}return e}supplementTriggers(e){return e&&(e.backbutton=e.backButton,e.idletime=e.idleTime,e.externallink=e.external,e.interarticle=e.interArticleLinks,e.mouseleave=e.mouseLeave,e.navaccess=e.mouseLeave,e.fastscroll=e.fastScroll,e.scrolltotop=e.scrollToTop),e}nextPlacement(e=1){return this.spotlightOverlayAvailable?0:this.spotlightInarticleAvailable?1:e&&this.spotlightMastheadAvailable?2:this.placements.overlay.enabled?0:this.placements.inarticle.enabled?1:this.placements.masthead.enabled&&e?2:-1}spotlightAuctionTimingEligible(e){if(this.forceTiming)return 1;const t=document.timeline.currentTime;if("number"==typeof t&&t-window.krg_so.kso_load<4e3&&t<8e3)return 0;const i=window.localStorage.getItem("ksocan-int-lastshown"),s=window.localStorage.getItem("ksocan-int-lastshown-"+e);if(!i)return 1;if(0==e){if((new Date).getTime()<Number(s)+1e3*this.frequencyCapOverlay-6e3)return 0}else if(1==e){if((new Date).getTime()<Number(s)+1e3*this.frequencyCapInarticle-6e3)return 0}else if(2==e&&(new Date).getTime()<Number(s)+1e3*this.frequencyCapMasthead-6e3)return 0;return(new Date).getTime()>Number(i)+1e3*this.frequencyCapGeneral-6e3}timingEligible(e,t=0){if(this.forceTiming)return 1;if(!this.spotlightEnabled||-1==e)return 0;const i=document.timeline.currentTime;if("number"==typeof i&&i-window.krg_so.kso_load<1e4&&i<15e3)return 0;const s=window.localStorage.getItem("ksocan-int-lastshown"),n=window.localStorage.getItem("ksocan-int-lastshown-0"),o=window.localStorage.getItem("ksocan-int-lastshown-1"),a=window.localStorage.getItem("ksocan-int-lastshown-2"),l=window.localStorage.getItem("ksocan-int-lastshown-vignette");if(!s)return 1;let r=1,d=1,h=1;return(new Date).getTime()<Number(n)+1e3*this.frequencyCapOverlay&&(r=0),(new Date).getTime()<Number(l)+3e5&&(r=0),(new Date).getTime()<Number(o)+1e3*this.frequencyCapInarticle&&(d=0),(new Date).getTime()<Number(a)+1e3*this.frequencyCapMasthead&&(h=0),(new Date).getTime()>Number(s)+1e3*this.frequencyCapGeneral&&(r&&this.spotlightOverlayAvailable&&(0==e||!t)||d&&this.spotlightInarticleAvailable&&(1==e||!t)||h&&this.spotlightMastheadAvailable&&(2==e||!t))?1:0}mockShowSpotlight(e,t,i,s,n=0){if(!(this.showingOverlay||this.showingInarticle||this.showingMasthead)){if(e&&this.spotlightOverlayAvailable)return window.localStorage.setItem("ksocan-int-lastshown-0",""+(new Date).getTime()),n||(this.spotlightOverlayAvailable=0,window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),this.showingOverlay=1,setTimeout((()=>{this.showingOverlay=0}),1e3*this.countdownTime)),this.recordSpotlightAvail("overlay",s),1;if(t&&this.spotlightInarticleAvailable||i&&this.spotlightMastheadAvailable){if(this.showingInarticle||this.showingMasthead)return 0;if(t&&this.spotlightInarticleAvailable)return this.showingInarticle=1,this.spotlightInarticleAvailable=0,window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),window.localStorage.setItem("ksocan-int-lastshown-1",""+(new Date).getTime()),this.recordSpotlightAvail("inarticle",s),1;if(i&&this.spotlightMastheadAvailable)return this.showingMasthead=1,this.spotlightMastheadAvailable=0,window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),window.localStorage.setItem("ksocan-int-lastshown-2",""+(new Date).getTime()),this.recordSpotlightAvail("masthead",s),1}}}markSpotlightTiming(e,t,i){const s=window.localStorage.getItem("ksocan-int-lastshown");window.localStorage.setItem("ksocan-int-lastshown-prev",s||"0"),window.localStorage.setItem("ksocan-int-lastshown-0-prev",window.localStorage.getItem("ksocan-int-lastshown-0")||"0"),window.localStorage.setItem("ksocan-int-lastshown-1-prev",window.localStorage.getItem("ksocan-int-lastshown-1")||"0"),window.localStorage.setItem("ksocan-int-lastshown-2-prev",window.localStorage.getItem("ksocan-int-lastshown-2")||"0"),window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),e&&window.localStorage.setItem("ksocan-int-lastshown-0",""+(new Date).getTime()),t&&window.localStorage.setItem("ksocan-int-lastshown-1",""+(new Date).getTime()),i&&window.localStorage.setItem("ksocan-int-lastshown-2",""+(new Date).getTime())}handleGamFallback(e){var t;if("inarticle"!==e)return;const i=null==(t=this.placements)?void 0:t.inarticle;if(!i||!i.fill||!i.fill.rhu)return;this.standout.logger.log("Re-displaying in-article with Prebid fallback after empty GAM response"),this.showingInarticle=0,this.spotlightInarticleAvailable=1,i.waitingForGam=0,i.gamRendered=0;const s=i.container;s&&(s.style.display="flex"),window.setTimeout((()=>{i.gamFallbackCall()}),0)}showSpotlight(e,t,i,s,n,o,a=0){const l=document;try{const e={overlay:this.triggersAvailable().overlay[o]&&(a||this.timingEligible(0,1)),inarticle:this.triggersAvailable().inarticle[o]&&(a||this.timingEligible(1,1)),masthead:this.triggersAvailable().masthead[o]&&(a||this.timingEligible(2,1))};this.logTriggerActivatedOncePerWindow(o,"none",{cand:{ov:i,ia:s,mh:n},elig:e})}catch(e){}const r={overlay:[],inarticle:[],masthead:[]};this.triggersAvailable().overlay[o]&&!this.googleVignetteShown||(i=0,this.triggersAvailable().overlay[o]||r.overlay.push("trigger-unavailable"),this.googleVignetteShown&&(this.standout.logger.recordLogEventOnce("vignette-suppressed-overlay"),r.overlay.push("google-vignette"))),this.triggersAvailable().inarticle[o]||(s=0,r.inarticle.push("trigger-unavailable")),this.triggersAvailable().masthead[o]||(n=0,r.masthead.push("trigger-unavailable")),"scrolltotop"==o||this.shouldAutoscroll(o)||(n=0,r.masthead.push("autoscroll-block"));const d=this.clientOverrides();if(d&&d.slots.inArticle&&"enabled"in d.slots.inArticle&&!d.slots.inArticle.enabled&&(s=0,r.inarticle.push("client-override-disabled")),d&&d.slots.overlay&&"enabled"in d.slots.overlay&&!d.slots.overlay.enabled&&(i=0,r.overlay.push("client-override-disabled")),d&&d.slots.masthead&&"enabled"in d.slots.masthead&&!d.slots.masthead.enabled&&(n=0,r.masthead.push("client-override-disabled")),this.timingEligible(0,1)||this.placements.overlay.waitingForGam||a||(i=0,r.overlay.push("timing-ineligible")),this.timingEligible(1,1)||this.placements.inarticle.waitingForGam||a||(s=0,r.inarticle.push("timing-ineligible")),this.timingEligible(2,1)||this.placements.masthead.waitingForGam||a||(n=0,r.masthead.push("timing-ineligible")),!i&&!s&&!n){try{this.logSuppressed("none",o,"all-disallowed",{allow:{ov:i,ia:s,mh:n},trigAvail:this.triggersAvailable(),inv:r})}catch(e){}return}if(!i&&this.placements.overlay.waitingForGam)return;if(!s&&this.placements.inarticle.waitingForGam)return;if(!n&&this.placements.masthead.waitingForGam)return;const p=this.checkForSpotlightPlacementTargeting();p.overlay||(i=0,r.overlay.push("placement-targeting")),p.inArticle||(s=0,r.inarticle.push("placement-targeting")),p.masthead||(n=0,r.masthead.push("placement-targeting"));const m=this.checkForSpotlightSuppressions(o);if(m){try{const e=Object.assign({rsn:m.reason},m.meta||{});this.standout.logger.SDTLog(177,this.buildSpotlightLogData("none",o,e))}catch(e){}return void this.recordSpotlightSuppressionEvents(o,m.reason,m.meta||null,{overlay:i,inarticle:s,masthead:n})}const b=this.standout.device.mobile;if(i&&te("overlayCheckForSuppression",o,b)){i=0;try{this.standout.logger.SDTLog(177,this.buildSpotlightLogData("overlay",o,{rsn:"overlay-suppression-event"}))}catch(e){}}if(s&&te("inarticleCheckForSuppression",o,b)){s=0;try{this.standout.logger.SDTLog(177,this.buildSpotlightLogData("inarticle",o,{rsn:"inarticle-suppression-event"}))}catch(e){}}if(n&&te("mastheadCheckForSuppression",o,b)){n=0;try{this.standout.logger.SDTLog(177,this.buildSpotlightLogData("masthead",o,{rsn:"masthead-suppression-event"}))}catch(e){}}if("googletag"in window&&window,i&&this.placements.overlay.deferredGamSlot)return this.markSpotlightTiming(1,0,0),this.standout.logger.log("Calling gtag pubads refresh for overlay"),this.placements.overlay.gamTrigger=o,this.standout.bidStack.displayAndRefreshGPTSlot(this.placements.overlay.deferredGamSlot),this.standout.logger.recordLogEvent("gtag-refresh",{pl:"overlay",gS:this.placements.overlay.deferredGamSlot.getAdUnitPath(),auId:this.placements.overlay.auctionId,adS:this.placements.overlay.adSlotId}),this.placements.overlay.deferredGamSlot=null,this.placements.overlay.waitingForGam=1,void setTimeout((()=>{this.showSpotlight(e,t,i,s,n,o,1)}),50);if(i&&this.placements.overlay.waitingForGam)return void setTimeout((()=>{this.showSpotlight(e,t,i,s,n,o,1)}),50);s&&this.placements.inarticle.deferredGamSlot&&(this.spotlightInarticleAvailable=1);const v=i&&this.spotlightOverlayAvailable&&this.spotlightOverlayAllowed&&!this.showingOverlay,w=s&&this.spotlightInarticleAvailable&&this.spotlightInarticleAllowed&&!this.showingInarticle;if(n&&this.placements.masthead.deferredGamSlot){if(!(v||w&&"scrolltotop"!==o))return this.markSpotlightTiming(0,0,1),this.standout.logger.log("Calling gtag pubads refresh for masthead"),this.placements.masthead.gamTrigger=o,this.standout.logger.recordLogEvent("gtag-refresh",{pl:"masthead",gS:this.placements.masthead.deferredGamSlot.getAdUnitPath(),auId:this.placements.masthead.auctionId,adS:this.placements.masthead.adSlotId}),this.standout.bidStack.displayAndRefreshGPTSlot(this.placements.masthead.deferredGamSlot),this.placements.masthead.deferredGamSlot=null,this.placements.masthead.waitingForGam=1,void setTimeout((()=>{this.showSpotlight(e,t,i,s,n,o,1)}),50);n=0}else if(n&&this.placements.masthead.waitingForGam){if(!(v||w&&"scrolltotop"!==o))return void setTimeout((()=>{this.showSpotlight(e,t,i,s,n,o,1)}),50);n=0}if(!(this.standout.bidStack.pbEnabled&&this.spotlightFill||this.placements.overlay.fill||this.placements.inarticle.fill||this.placements.masthead.fill||this.demoData||this.disableFillCheck))return;if(1==this.deviceTypes&&!this.standout.device.mobile||2==this.deviceTypes&&this.standout.device.mobile){try{this.logSuppressed("none",o,"device-ineligible",{dt:this.deviceTypes,isMobile:this.standout.device.mobile})}catch(e){}return}if(this.demoData&&this.demoData.waiting)return this.standout.logger.log("Waiting for demo data"),void setTimeout((()=>{this.showSpotlight(e,t,i,s,n,o)}),200);let S=null,k=null,T=null;if(i&&this.spotlightOverlayAvailable&&this.spotlightOverlayAllowed&&!this.showingOverlay){this.showingOverlay=1,this.adFilledTime=0,this.spotlightOverlayAvailable=0;const i=this.placements.overlay.container;let s=this.placements.overlay.continueLink,n=this.placements.overlay.closeLink;if(this.overlayShownTime=(new Date).getTime(),this.standout.logger.SDTLog(160),s||(s=i.querySelector("#ksc-in-ct")),n||(n=i.querySelector("#ksc-in-x")),!s||!n)return void(this.showingOverlay=0);s.style.visibility="visible",this.recordSpotlightAvail("overlay",o,{f:1}),window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),window.localStorage.setItem("ksocan-int-lastshown-0",""+(new Date).getTime());const a=i.querySelector(".rhi-ab");var A;if(this.standout.bidStack.pbEnabled&&this.placements.overlay.fill&&this.placements.overlay.fill.rhu&&this.placements.overlay.fill.rhu.contents?(this.placements.overlay.fill.bid&&(k=this.placements.overlay.fill.bid.execution&&this.placements.overlay.fill.bid.execution.type?this.placements.overlay.fill.bid.execution.type:this.placements.overlay.fill.bid.execution,T=this.placements.overlay.fill.bid.format),(this.placements.overlay.fill.auctionType||this.placements.overlay.fill.aType)&&(S=this.placements.overlay.fill.auctionType||this.placements.overlay.fill.aType),this.placements.overlay.fill.bid&&this.placements.overlay.fill.bid.execution&&this.isCoreCreative(this.placements.overlay.fill.bid.format,this.placements.overlay.fill.bid.execution.type||this.placements.overlay.fill.bid.execution)&&(a.style.width="100%"),g(_(this.placements.overlay.fill.rhu.contents[0].body)).forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&a.appendChild(t)}else c(e),a.appendChild(e)})),this.placements.overlay.recordedImpression||(this.placements.overlay.fill.bid?this.standout.bidStack.recordPbAdImpression(this.placements.overlay.fill.adSlot,null==(A=this.placements)||null==(A=A.overlay)||null==(A=A.fill)?void 0:A.bid,this.placements.overlay.auctionId,"overlay"):this.standout.bidStack.recordAdImpression({ads:this.placements.overlay.fill.adSlot,auId:this.placements.overlay.auctionId}),this.placements.overlay.recordedImpression=1)):this.demoData&&(S="demo",this.standout.bidStack.girEnabled&&this.standout.bidStack.reportGIRImpression("overlay-demo",this.standout.bidStack.girDemoCpm,null),this.logExternally("spotlight-impression",{slotType:"overlay",impressionTime:(new Date).getTime(),cpm:0}),k=this.demoData.ex,T=this.demoData.fo,((k||"").toLowerCase().includes("video")||(T||"").toLowerCase().includes("video"))&&this.fillOverlayDemo(this.demoData,i,a,1)),i.style.opacity="0",this.placements.overlay.gamRendered&&(i.style.opacity="1",i.style.visibility="visible",this.placements.overlay.showedAd=1,setTimeout((()=>{this.placements.overlay.clickBlocker&&(this.placements.overlay.clickBlocker.style.display="none")}),this.overlayClickBlockerDelay),this.disableScrolling()),this.observeSpotlightCreative(a,a.parentElement,0,S,T,k,(this.placements.overlay.fill||{}).bid),this.demoData&&this.standout.renderer.isIvo(a.innerHTML)&&(a.style.width="initial",a.parentElement&&(a.parentElement.style.opacity="1",a.parentElement.style.visibility="visible")),this.initiateOverlayAdjustmentCheck(i),i.style.display="flex",e&&"back"!=e){const t=t=>{t.preventDefault(),this.recordOverlayClose(n.dataset.position||""),window.location.href=e,this.enableScrolling()};s.onclick=t,n.onclick=t}else if("back"==e){const e=e=>{e.preventDefault(),this.recordOverlayClose(n.dataset.position||""),history.back(),this.showingOverlay=0,this.enableScrolling()};s.onclick=e,n.onclick=e}else{const e=e=>{e.preventDefault(),this.recordOverlayClose(n.dataset.position||""),i.style.display="none",this.cancelOverlayAdjustmentCheck(),this.showingOverlay=0,this.enableScrolling()};s.onclick=e,n.onclick=e}if(s.innerText=this.countdownTime+"",t){const t=(s,o)=>{"none"!=i.style.display&&(s.innerText=o/1e3+"",o<=0?(this.standout.logger.recordLogEvent("interstitial-countdown-close",{ot:(new Date).getTime()-this.overlayShownTime,pos:n.dataset.position}),i.style.display="none",this.showingOverlay=0,e&&"back"!=e?window.location.href=e:"back"==e&&history.back()):setTimeout((()=>t(s,o-1e3)),1e3))};setTimeout((()=>t(s,1e3*(this.countdownTime-1))),1e3)}else s.style.visibility="hidden"}else if(s&&this.spotlightInarticleAvailable&&this.spotlightInarticleAllowed||n&&this.spotlightMastheadAvailable&&this.spotlightMastheadAllowed){if(this.showingOverlay)return;let a,r,d=null;if(s&&this.spotlightInarticleAvailable&&this.spotlightInarticleAllowed)a=this.placements.inarticle.container,r=a.querySelector(".ksc-ia-ab");else{if(!(n&&this.spotlightMastheadAvailable&&this.spotlightMastheadAllowed))return;a=this.placements.masthead.container,r=a.querySelector(".ksc-masthead-ab")}if(this.demoData&&this.standout.logger.log("Demo data",this.demoData),s&&this.spotlightInarticleAvailable&&this.spotlightInarticleAllowed&&!this.showingInarticle){var C,I;this.showingInarticle=1,this.adFilledTime=0,this.spotlightInarticleAvailable=0;let s=null;if(this.standout.page.kargoDemoSite&&(s=l.querySelectorAll(".krg-preview,*[class*=Crossplatform_middleHeading],*[class*=Crossplatform_middleContent],*[class^=bbc_body-text-card__text] > div,.content-lock-content,#Paginator,#Paginator section,div[data-testid*=main-contentxxx],div[data-testid=atom-body],div[class*=a-content],div[class*=articleContainer__content],.article-body")),!s||0===s.length){if(this.articleContentSelector&&(s=l.querySelectorAll(this.articleContentSelector)),s&&0!==s.length||!this.placements.inarticle.articleSelector||(s=l.querySelectorAll(this.placements.inarticle.articleSelector)),!s||0===s.length){const e=E(l.body);s=e?[e.contentContainer]:[]}s&&0!==s.length||(s=[l.querySelector(".entry-content")])}let p=null,m=null;const b=ee("inarticleFindInsertionPoint",this.standout.device.mobile);if(b&&b.length)for(const e of b)if(e instanceof Element&&e.parentElement&&e.isConnected){p=e,m=e.getBoundingClientRect();break}for(let e=0;e<s.length&&!p;e++){const t=s[e];if(!t)continue;const i=t.getBoundingClientRect();for(let e=0;e<t.children.length;e++){const s=t.children[e];if(m=s.getBoundingClientRect(),m.bottom>100&&(m.bottom<window.innerHeight||m.height<1e3&&this.showSpotlightImmediately)&&m.bottom-i.top>100&&!(L(s)||f(s)||y(s)||x(s,0,1,1)||this.checkForAdjacentInarticleIneligible(s))){p=s;break}}if(p)break}const v=(null==(C=this.placements.inarticle.fill)||null==(C=C.bid)?void 0:C.height)||300;if(!p||!m||m.bottom+.7*v>window.innerHeight&&!this.showSpotlightImmediately)return this.showingInarticle=0,this.spotlightInarticleAvailable=1,void this.showSpotlight(e,t,i,0,n,o);if(this.placements.inarticle.fill&&this.placements.inarticle.fill.rhu){let e=_(this.placements.inarticle.fill.rhu.contents[0].body);!this.standout.page.kargoDemoSite||window==window.top||this.placements.inarticle.fill.bid&&"FabrikOutstream"==this.placements.inarticle.fill.bid.format||(e=this.celtraFrameHack(e||"")),g(e||"").forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&r.appendChild(t)}else c(e),r.appendChild(e)})),d=e||null,this.placements.inarticle.recordedImpression||(this.placements.inarticle.fill.bid?this.standout.bidStack.recordPbAdImpression(this.placements.inarticle.fill.adSlot,this.placements.inarticle.fill.bid,this.placements.inarticle.auctionId,"inArticle"):this.standout.bidStack.recordAdImpression({ads:this.placements.inarticle.fill.adSlot,auId:this.placements.inarticle.auctionId}),this.placements.inarticle.recordedImpression=1),this.recordSpotlightAvail("inarticle",o,{f:1}),this.placements.inarticle.fill.bid&&(k=this.placements.inarticle.fill.bid.execution&&this.placements.inarticle.fill.bid.execution.type?this.placements.inarticle.fill.bid.execution.type:this.placements.inarticle.fill.bid.execution,T=this.placements.inarticle.fill.bid.format),(this.placements.inarticle.fill.auctionType||this.placements.inarticle.fill.aType)&&(S=this.placements.inarticle.fill.auctionType||this.placements.inarticle.fill.aType)}else this.demoData?(this.fillMastheadDemo(this.demoData,a,r,1),this.standout.bidStack.girEnabled&&this.standout.bidStack.reportGIRImpression("inarticle-demo",this.standout.bidStack.girDemoCpm,null),this.logExternally("spotlight-impression",{slotType:"inArticle",impressionTime:(new Date).getTime(),cpm:0}),S="demo",k=this.demoData.ex,T=this.demoData.fo):this.placements.inarticle.gamRendered&&this.recordSpotlightAvail("inarticle",o,{f:1});p.parentElement&&"grid"==window.getComputedStyle(p.parentElement).display&&!q(["elitedaily.com/"])&&p.children.length&&(p=p.children[p.children.length-1]);const w=Number(window.getComputedStyle(p).marginBottom.split("px")[0]);let A=0;p.nextElementSibling&&(A=Number(window.getComputedStyle(p.nextElementSibling).marginTop.split("px")[0]));let D=0,N=0;if(w>0&&0==A&&(N=w),A>0&&0==w&&(D=A),0==w&&0==A&&(D=20,N=20),0==D&&0==N&&(D=A,N=w),a.dataset.iaMarginTop=D+"px",a.dataset.iaMarginBottom=N+"px",null==(I=p.parentElement)||I.insertBefore(a,p.nextElementSibling),this.standout.device.mobile){const e=a.getBoundingClientRect();e.left>0&&(a.style.marginLeft="-"+e.left+"px"),e.width<window.innerWidth&&(a.style.width=window.innerWidth+"px"),a.style.maxWidth="initial"}d&&d.includes("creative_source=composer")?this.wrapAndAppendComposerCreative(d,r):this.demoData&&this.demoData.upper&&this.demoData.upper.includes("creative_source=composer")&&this.wrapAndAppendComposerCreative(this.demoData.upper,r);const P=u(a,'div[class^="Expander_expander"]');P&&P.style.maxHeight&&(P.style.maxHeight=""),this.markSpotlightTiming(0,1,0),this.placements.inarticle.deferredGamSlot&&(this.standout.logger.log("Calling gtag pubads refresh for inarticle"),this.standout.logger.recordLogEvent("gtag-refresh",{pl:"inarticle",gS:this.placements.inarticle.deferredGamSlot.getAdUnitPath(),auId:this.placements.inarticle.auctionId,adS:this.placements.inarticle.adSlotId}),this.placements.inarticle.gamTrigger=o,this.standout.bidStack.displayAndRefreshGPTSlot(this.placements.inarticle.deferredGamSlot),this.placements.inarticle.deferredGamSlot=null,this.placements.inarticle.waitingForGam=1,this.placements.inarticle.gamFallbackCall=()=>{this.showSpotlight(e,t,i,1,n,o,1)}),this.observeInarticleCreative(r,a,S,T,k),this.showSpotlightImmediately&&a.scrollIntoView({behavior:"smooth",block:"center"})}else if(n&&this.spotlightMastheadAvailable&&this.spotlightMastheadAllowed&&!this.showingMasthead){if(this.showingMasthead=1,this.adFilledTime=0,this.spotlightMastheadAvailable=0,this.placements.masthead.fill&&this.placements.masthead.fill.rhu&&this.placements.masthead.fill.rhu.contents){this.placements.masthead.fill.bid&&this.placements.masthead.fill.bid.execution&&this.isCoreCreative(this.placements.masthead.fill.bid.format,this.placements.masthead.fill.bid.execution.type||this.placements.masthead.fill.bid.execution)&&(r.style.width="100%",a.style.width="100%");const e=_(this.placements.masthead.fill.rhu.contents[0].body);g(e).forEach((e=>{if("SCRIPT"==e.tagName){const t=h(e);e.parentElement&&e.parentElement.removeChild(e),t&&r.appendChild(t)}else c(e),r.appendChild(e)})),d=e,this.placements.masthead.recordedImpression||(this.placements.masthead.fill.bid?this.standout.bidStack.recordPbAdImpression(this.placements.masthead.fill.adSlot,this.placements.masthead.fill.bid,this.placements.masthead.auctionId,"masthead"):this.standout.bidStack.recordAdImpression({ads:this.placements.masthead.fill.adSlot,auId:this.placements.masthead.auctionId}),this.placements.masthead.recordedImpression=1),this.recordSpotlightAvail("masthead",o,{f:1}),this.placements.masthead.fill.bid&&(k=this.placements.masthead.fill.bid.execution&&this.placements.masthead.fill.bid.execution.type?this.placements.masthead.fill.bid.execution.type:this.placements.masthead.fill.bid.execution,T=this.placements.masthead.fill.bid.format),(this.placements.masthead.fill.auctionType||this.placements.masthead.fill.aType)&&(S=this.placements.masthead.fill.auctionType||this.placements.masthead.fill.aType)}else this.demoData?(this.standout.bidStack.girEnabled&&this.standout.bidStack.reportGIRImpression("masthead-demo",this.standout.bidStack.girDemoCpm,null),this.logExternally("spotlight-impression",{slotType:"masthead",impressionTime:(new Date).getTime(),cpm:0}),S="demo",k=this.demoData.ex,T=this.demoData.fo,((k||"").toLowerCase().includes("video")||(T||"").toLowerCase().includes("video"))&&this.fillMastheadDemo(this.demoData,a,r,1)):this.placements.masthead.gamRendered&&this.recordSpotlightAvail("masthead",o,{f:1});if(0==this.mastheadMode){const e=this.placements.masthead.stickyElement;e.style.display="flex",d&&d.includes("creative_source=composer")?this.wrapAndAppendComposerCreative(d,r):this.demoData&&this.demoData.upper&&this.demoData.upper.includes("creative_source=composer")&&this.wrapAndAppendComposerCreative(this.demoData.upper,r),setTimeout((()=>{e.style.transform="translateY(0)"}),350)}else if(1==this.mastheadMode){const e=this.placements.masthead.parallaxElement;e.dataset.originalStyle=e.style.cssText,e.style.display="block",e.style.opacity="1",e.style.position="relative",d&&d.includes("creative_source=composer")?this.wrapAndAppendComposerCreative(d,r):this.demoData&&this.demoData.upper&&this.demoData.upper.includes("creative_source=composer")&&this.wrapAndAppendComposerCreative(this.demoData.upper,r),this.clearBillboards(),this.activateMastheadParallax(e),this.showingMastheadElement=e,(this.showSpotlightImmediately||this.shouldAutoscroll(o,e.clientHeight))&&setTimeout((()=>{this.checkMastheadScrollPosition(null,1),window.scroll({top:0,left:0,behavior:"smooth"})}),200)}this.observeSpotlightCreative(r,a,1,S,T,k,(this.placements.masthead.fill||{}).bid),window.localStorage.setItem("ksocan-int-lastshown",""+(new Date).getTime()),window.localStorage.setItem("ksocan-int-lastshown-2",""+(new Date).getTime())}}}checkForSpotlightPlacementTargeting(){const e={overlay:1,inArticle:1,masthead:1};return q(["parade.com/shopping","athlonsports.com/deals","autoblog.com/deals","trending.thespun.com/deals","pethelpful.com/shopping","mensjournal.com/shopping","paradehomeandgarden.com/shopping","mensfitness.com/gear"])&&(e.inArticle=0),e}checkForSpotlightSuppressions(e){if(window.location.href.includes("#google_vignette"))return{reason:"google-vignette"};const t=document.querySelector("#versus-outer-iframe");if(t&&!f(t)&&(e=>{if(0===e.clientHeight)return 0;const t=e.getBoundingClientRect();return(Math.min(window.innerHeight||document.documentElement.clientHeight,t.bottom)-Math.max(0,t.top))/e.clientHeight})(t)>.65)return{reason:"versus-widget-visible"};const i=document.querySelector('[id^="bx-shroud-"],[id^="bx-close-inside-"],[id^="bx-close-outside-"],.bx-client-overlay-ios');if(i&&!f(i))return{reason:"wk-overlay-visible"};const s=document.querySelector('div[id^="piano"] > div.is-open,.tp-modal,*[data-vignette-loaded],.stuff-oli-ad-container.active');if(s&&!f(s))return{reason:"paywall-overlay-visible"};if(document.querySelector('div[class*="overlayContainer"].open'))return{reason:"arena-paywall-visible"};if(document.querySelector("#CookMode"))return{reason:"cook-mode-open"};if(this.standout.settings.disableAdRendering||document.body.kso_disablerendering||window.kso_disablerendering)return{reason:"ad-rendering-disabled"};const n=document.querySelector("voltax-player");if(n&&n.shadowRoot)try{const e=n.shadowRoot.querySelector("video"),t=n.querySelector("#ad-container"),i=n.shadowRoot.querySelector("#ad-container");if(e&&!e.paused&&!e.muted&&e.volume>0)return{reason:"voltax-video-playing"};if(t&&"flex"==t.style.display&&e&&!e.muted&&e.volume>0)return{reason:"voltax-video-ad-running"};if(i&&"flex"==i.style.display&&e&&!e.muted&&e.volume>0)return{reason:"voltax-video-ad-running"}}catch(e){}if("idletime"==e){const e=document.querySelector(".VideoEmbed");if(e)try{const t=e.querySelector("video"),i=e.querySelector('div[data-role="adContainer"]');if(t&&!t.paused&&!t.muted&&t.volume>0)return{reason:"cbs-video-playing"};if(i&&"none"!=i.style.display)return{reason:"cbs-video-ad-visible"}}catch(e){}if(q(["thekitchn.com","apartmenttherapy.com"],1)){const e=document.querySelector('div[id^="jw-player-in-post"]');if(e&&w(e))return{reason:"jwplayer-visible"}}else{const e=document.querySelector("cnx");if(e)try{const t=e.querySelector("video");if(t&&!t.paused&&!t.muted&&t.volume>0)return{reason:"connatix-video-playing"};if(e.querySelector(".cnx-hide-video"))return{reason:"connatix-overlay-visible"}}catch(e){}}}const o=this.detectVisibleFullscreenCover();if(o){const e=o.element,t="string"==typeof e.className?e.className.trim().split(/\s+/).filter(Boolean).slice(0,3).join(" "):"";return{reason:"fullscreen-overlay-detected",meta:{tag:e.tagName,id:e.id||null,cls:t.length?t:null,cov:Number(o.coverage.toFixed(2)),z:o.zIndex}}}return null}detectVisibleFullscreenCover(){const e=document.body,t=document.documentElement;if(!e||!t)return null;const i=window.innerWidth||t.clientWidth||0,s=window.innerHeight||t.clientHeight||0;if(!i||!s)return null;const n=e.querySelectorAll("div,section,article,aside,main,header,footer,nav,form,iframe,dialog"),o=this.getSpotlightSuppressionIgnoreRoots();let a=0;for(const l of Array.from(n)){if(a++>=1e3)break;if(!(l instanceof HTMLElement))continue;if(l===e||l===t)continue;if(o.some((e=>e&&(l===e||e.contains(l)))))continue;if(f(l))continue;const n=l.getBoundingClientRect();if(!this.rectLooksFullscreen(n,i,s))continue;const r=window.getComputedStyle(l);if(!this.overlayCandidateByPosition(r))continue;const d=parseFloat(r.opacity||"1");if(!isNaN(d)&&d<=.05)continue;const h=this.extractAlphaFromColor(r.backgroundColor)>=.15||"none"!==r.backdropFilter||"none"!==r.backgroundImage;if(!h&&"none"===r.pointerEvents)continue;const c=this.parseZIndex(r.zIndex);if("absolute"===r.position&&!h&&c<500)continue;if(c<5)continue;const p=Math.min(n.right,i)-Math.max(n.left,0),g=Math.min(n.bottom,s)-Math.max(n.top,0),m=Math.max(0,Math.min(p,i))/i*(Math.max(0,Math.min(g,s))/s);if(!(m<.9))return{element:l,coverage:m,zIndex:c}}return null}overlayCandidateByPosition(e){const t=e.position;return"fixed"===t||"sticky"===t?1:"absolute"===t?this.parseZIndex(e.zIndex)>=100:"relative"===t?this.parseZIndex(e.zIndex)>=2e3:0}rectLooksFullscreen(e,t,i){return e.width<=0||e.height<=0?0:(e.width>=.9*t||e.left<=.05*t&&e.right>=.95*t)&&(e.height>=.85*i||e.top<=.05*i&&e.bottom>=.9*i)&&e.bottom>0&&e.top<i&&e.right>0&&e.left<t}extractAlphaFromColor(e){if(!e||"transparent"===e)return 0;const t=e.match(/rgba?\(([^)]+)\)/i);if(t){const e=t[1].split(",").map((e=>e.trim()));if(4!==e.length)return 1;{const t=parseFloat(e[3]);if(!isNaN(t))return Math.max(0,Math.min(1,t))}}const i=e.match(/hsla\([^,]+,[^,]+,[^,]+,([^)]+)\)/i);if(i){const e=parseFloat(i[1]);if(!isNaN(e))return Math.max(0,Math.min(1,e))}return 1}parseZIndex(e){const t=parseInt(e,10);return isNaN(t)?0:t}getSpotlightSuppressionIgnoreRoots(){const e=[];return["overlay","inarticle","masthead"].forEach((t=>{const i=this.placements&&this.placements[t]&&this.placements[t].container;i instanceof HTMLElement&&e.push(i)})),this.showingMastheadElement&&this.showingMastheadElement instanceof HTMLElement&&e.push(this.showingMastheadElement),e}suppressOverlay(){this.showingOverlay&&this.placements.overlay.container?(this.recordOverlayClose("vignette"),this.placements.overlay.container.style.display="none",this.cancelOverlayAdjustmentCheck(),this.showingOverlay=0,this.enableScrolling()):this.recordedOverlaySuppression||window.localStorage.setItem("ksocan-int-lastshown-vignette",""+(new Date).getTime()),this.recordedOverlaySuppression=1}buildSpotlightLogData(e,t,i){const s="none"===e?null:this.placements[e]||{},n={pl:e,tr:t,auId:(null==s?void 0:s.auctionId)||null,adS:(null==s?void 0:s.adSlotId)||null,ts:(new Date).getTime()};return i&&"object"==typeof i&&Object.assign(n,i),n}logTriggerActivatedOncePerWindow(e,t,i){const s=Date.now(),n=""+e;s-(this.lastTriggerLogAt[n]||0)<1e3*this.frequencyCapGeneral||(this.lastTriggerLogAt[n]=s,this.standout.logger.SDTLog(178,this.buildSpotlightLogData(t,e,i)))}logSuppressed(e,t,i,s){const n=Date.now(),o=`${e}|${t}|${i}`;if(n-(this.suppressionLogTs[o]||0)<1e3*this.frequencyCapGeneral)return;this.suppressionLogTs[o]=n,this.lastSuppressionReason=i;const a=this.buildSpotlightLogData(e,t,Object.assign({rsn:i},s||{}));this.standout.logger.SDTLog(177,a)}recordSpotlightSuppressionEvents(e,t,i,s){["overlay","inarticle","masthead"].forEach((n=>{if(!s[n])return;const o=Object.assign({placement:n,trigger:e,reason:t},i||{});this.standout.logger.recordLogEventOnce("spotlight-suppression-"+n,o)}))}clearBillboards(){const e=document.querySelector("div[class*=sticky-top-ad_container],.header-wrapper #ad-header");e&&(e.style.display="none");const t=document.querySelector(".stuff-header .header-ads-block");t&&(t.style.visibility="hidden")}checkForAdjacentInarticleIneligible(e){return e&&"classList"in e&&(M(e.classList,["PublishByline","Post__headline","Post__heading","RecipePostIntro__image","RecipePostIntro","RecipeActions","Post__affiliate-slot","Post__item--first","Post__kickerTags","Post__ratingsContainer","Post__jumpToRecipe"])||e.className&&e.className.length&&e.className.includes("SitePostActions")||e.className&&e.className.length&&e.className.includes("RecipePostIntro"))?1:0}checkElementForOverlayOverlap(e,t){if(e!==t&&!t.contains(e)){const i=window.getComputedStyle(e).zIndex,s=Number(i)||0,n=this.overlayZIndex||999999,o=e;s>=n&&"svg"!==o.tagName.toLowerCase()&&!o.classList.contains("celtra-expanded-ad")&&!(o.className||"").includes("celtraCloseButtonBackground")&&!u(o,".celtra-expanded-ad")&&(o.querySelector(".animated")||(o.style.setProperty("z-index",n-100+"","important"),o.dataset&&(o.dataset.originalZIndex=s+"",this.overlayAdjustedElements=this.overlayAdjustedElements||[],this.overlayAdjustedElements.push(o))));const a=e.shadowRoot||null;a&&a.querySelectorAll("*").forEach((e=>{this.checkElementForOverlayOverlap(e,t)}))}}initiateOverlayAdjustmentCheck(t){this.overlayAdjustmentCheck&&(cancelAnimationFrame(this.overlayAdjustmentCheck),this.overlayAdjustmentCheck=null);const i=this.standout.page.kargoDemoSite,s=this.standout.device.mobile;let n=0;const o=a=>{if(a-n<100)return void(this.overlayAdjustmentCheck=requestAnimationFrame(o));if(n=a,!s&&i)return void(this.overlayAdjustmentCheck=requestAnimationFrame(o));const l=this.standout.getProductByType(e.ProductType.FabrikPlayer).videoContainer;l&&(l.style.opacity="0.99");try{const e=document.querySelectorAll("div,header,video,img,footer");for(let i=0;i<e.length;i++)this.checkElementForOverlayOverlap(e[i],t)}catch(e){this.standout.logger.log("Error during overlay adjustment check: "+e.message)}this.overlayAdjustmentCheck=requestAnimationFrame(o)};this.overlayAdjustmentCheck=requestAnimationFrame(o)}cancelOverlayAdjustmentCheck(){const t=this.standout.getProductByType(e.ProductType.FabrikPlayer).videoContainer;t&&(t.style.opacity="1"),this.overlayAdjustmentCheck&&(cancelAnimationFrame(this.overlayAdjustmentCheck),this.overlayAdjustmentCheck=null);const i=this.overlayAdjustedElements||[],s=this.overlayZIndex||999999;for(let e=0;e<i.length;e++){const t=i[e],n=t.dataset&&t.dataset.originalZIndex?Number(t.dataset.originalZIndex):NaN;t.style.zIndex=isNaN(n)?s+"":n+""}this.overlayAdjustedElements=[]}activateMastheadParallax(t){var i;const s=this.standout.getProductByType(e.ProductType.FabrikPlayer),n=document,o=this.standout.device.mobile,a=this.standout.page.kargoDemoSite,l=this.specialCaseElements||{},r=this.placements;this.mastheadParallaxElement=t,this.windowWheelListener||(this.windowWheelListener=e=>{var t;const i=null==(t=this.mastheadParallaxElement)?void 0:t.firstElementChild;i&&0===window.scrollY&&e.deltaY<0&&(i.style.position="absolute")},window.addEventListener("wheel",this.windowWheelListener,{passive:1}));let d=null,h=[];if(this.mastheadNavElements=[],this.mastheadAutoNavElements=[],this.mastheadNavSelector){const e=()=>{let e=0;const t=this.mastheadNavSelector,i=t.includes(",")?t.split(","):t.split("|");for(e=0;e<i.length;e++){d=null;const t=i[e];o?t.startsWith("desktoponly:")||(d=n.querySelector(t.replace("mobileonly:",""))):t.startsWith("mobileonly:")||(d=n.querySelector(t.replace("desktoponly:",""))),d&&!this.mastheadNavElements.includes(d)&&this.mastheadNavElements.push(d)}if(t.includes("autodetect"))for(h=C(a)||[],e=0;e<h.length;e++){const t=h[e];t instanceof HTMLElement&&!this.mastheadAutoNavElements.includes(t)&&this.mastheadAutoNavElements.push(t)}};e(),new MutationObserver((t=>{t.forEach((t=>{t.addedNodes&&e()}))})).observe(document.body,{childList:1,subtree:1})}else{h=C(a)||[];for(let e=0;e<h.length;e++){const t=h[e];t instanceof HTMLElement&&!this.mastheadAutoNavElements.includes(t)&&this.mastheadAutoNavElements.push(t)}}if(q("stuff.co.nz")&&(d=null,o&&(d=n.querySelector(".stuff-web-header")),d&&this.mastheadNavElements.push(d)),this.mastheadNavElements.length){const e=getComputedStyle(n.body).paddingTop;e&&Number(e.split("px")[0]||0)>0&&(t.style.marginBottom=e,n.body.style.paddingTop="0")}if(window.location.hostname.includes("ladbible.com")){const e=n.createElement("style");e.innerHTML=".animated-header{display:block !important;}",n.head.appendChild(e)}else if(q("thegistsports.com",1)){const e=n.querySelector("header");e&&"fixed"==window.getComputedStyle(e).position&&(e.style.top="0")}else if(q("swimmingworldmagazine.com",1)){const e=n.querySelector(".header-main");e&&(e.style.position="relative")}else if(q("dailybeast.com",1)){const e=n.querySelector(".header.article");l.db=e}else if(q("wonderwall.com",1)){const e=n.querySelector("header#masthead");l.ww=e}else if(q("athlonsports.com",1))l.aths=n.querySelector(".l-sticky-navbar");else if(q("bolasport.com")){const e=n.createElement("style");e.innerHTML="header {background:none !important;padding-bottom:0px !important;}",n.head.appendChild(e),l.bolaHeader=n.querySelector("header.fixed")}else if(q("u.gg",1)){const e=n.querySelector("#side-nav-container");l.uggSidebar=e,e&&(e.dataset.originalMarginTop=window.getComputedStyle(e).marginTop)}else q("icy-veins.com",1)&&(l.ivHeader=n.querySelector("#header"),l.ivNav=n.querySelector("#nav"),l.ivPadding=n.querySelector("#padding_for_minified_menu"));if(s.invokedVideoPlayer){let e=this.stickyPlayer||null;if(e=n.querySelector(".krg-floating-player"),!e){const t=n.querySelector("div[id^=scvp_]");t&&t.shadowRoot&&(e=t.shadowRoot.querySelector(".krg-floating-player"))}this.stickyPlayer=e}this.stickyThirdPartyPlayer=n.querySelector('div[id*="primis_player"][style*="fixed"],div[id^="video-container-"][style*="fixed"],div[id="lngtd-outstream"][style*="fixed"]'),this.stickyThirdPartyPlayer&&(this.stickyThirdPartyPlayer.style.transition="none"),this.stickyThirdPartyPlayer||new MutationObserver((e=>{e.forEach((e=>{e.addedNodes&&e.addedNodes.forEach((e=>{const t=e;t.classList&&(t.classList.contains("lngtd-outstream")||t.id&&(t.id.startsWith("video-container-")||t.id.startsWith("primis_player")))&&(this.stickyThirdPartyPlayer=t,this.stickyThirdPartyPlayer&&(this.stickyThirdPartyPlayer.style.transition="none"))}))}))})).observe(document.body,{childList:1,subtree:1}),this.mastheadLastScrollY=-999,a&&n.querySelector("#krg_mobile_header");const c=(null==(i=this.mastheadParallaxElement)?void 0:i.clientHeight)||0;if(window.scroll({left:0,top:window.scrollY+c,behavior:"instant"}),q("sportingnews.com")&&!o){const e=n.querySelector(".tsn-primary-menu:not(.tsn-primary-menu__fixed)");e&&(r.masthead.snMovingHeader=e);const t=n.querySelector(".tsn-primary-menu__fixed");t&&(r.masthead.snFixedHeader=t);const i=n.querySelector("header .region-header");r.masthead.headerAnchor=i;const s=n.createElement("style");n.head.appendChild(s),r.masthead.snStyleElement=s}ee("mastheadActivateParallax",t),requestAnimationFrame((e=>this.checkMastheadScrollPosition(e,0)))}checkMastheadScrollPosition(t,i=0){var s,n,o;const a=this.standout.getProductByType(e.ProductType.FabrikPlayer),l=document,r=this.standout.device.mobile,d=this.standout.page.kargoDemoSite,h=this.specialCaseElements||{},c=this.placements,p=this.mastheadParallaxElement;if(!p)return;const g="number"==typeof window.scrollY?window.scrollY:(null==(s=document.documentElement)?void 0:s.scrollTop)||0,m=p.firstElementChild;var u;if(g>1&&m&&"absolute"===m.style.position&&(m.style.position="fixed"),d&&!r)if(l.querySelector('button[class*="LeftNavigationComponents_toggleOpen"]'))if(null==(u=p.parentElement)||!u.classList.contains("krg-preview")||m&&"fixed"==m.style.position){const e=l.querySelector('div[class*="MuiDrawer-docked"]');e&&m&&(m.style.marginLeft=e.clientWidth/2+"px")}else m&&(m.style.marginLeft="0");else m&&(m.style.marginLeft="0");const b=p.clientHeight,y=Math.max(b-Math.max(g,0),0);if(g!=this.mastheadLastScrollY&&m&&"1"==m.dataset.sizeSet||i){m&&(m.style.height=y+"px"),y>0&&"hidden"==p.style.visibility&&(p.style.visibility="visible",m&&(m.dataset.parallax="1")),ee("mastheadUpdateParallax",g,this.mastheadLastScrollY,b,y>0);let e=0;if(this.mastheadNavElements.length)for(e=0;e<this.mastheadNavElements.length;e++){const t=this.mastheadNavElements[e];t&&(t.style.marginTop=g>=b?"0":b-window.scrollY+"px")}if(this.mastheadAutoNavElements.length)for(e=0;e<this.mastheadAutoNavElements.length;e++){const t=this.mastheadAutoNavElements[e];if(t){const e=getComputedStyle(t);"sticky"!=e.position&&"fixed"!=e.position||(t.style.marginTop=g>=b?"0":b-window.scrollY+"px")}}this.mastheadLastScrollY=g,h.db&&(y>0?(h.db.style.transition="none",h.db.style.transform="none"):(h.db.style.removeProperty("transition"),h.db.style.removeProperty("transform"))),h.aths&&(g<b+30?h.aths.style.opacity="0":h.aths.style.removeProperty("opacity"))}else"hidden"==p.style.visibility&&g<p.clientHeight&&(p.style.visibility="visible",h.db&&h.db.style.transform&&(h.db.style.removeProperty("transition"),h.db.style.removeProperty("transform")),h.aths&&h.aths.style.opacity&&h.aths.style.removeProperty("opacity"));if(h.ww){const e=h.ww,t=window.getComputedStyle(e).position;g<=b+e.clientHeight&&"fixed"!=t?(e.style.transition="none",e.style.marginTop=(g>b?b+(g-b):b)+"px",e.style.removeProperty("top")):y>0&&"fixed"!=t?(e.style.transition="none",e.style.marginTop=b+"px",e.style.removeProperty("top")):y>0&&"fixed"==t?(e.style.transition="none",e.style.top=y+"px"):(e.style.removeProperty("transition"),e.style.removeProperty("margin-top"),e.style.removeProperty("top"))}if(h.bolaHeader&&(h.bolaHeader.style.top=g>b?"0px":b-g+"px"),h.uggSidebar&&(h.uggSidebar.style.marginTop=g>b?h.uggSidebar.dataset.originalMarginTop:Number((h.uggSidebar.dataset.originalMarginTop||"").split("px")[0]||0)+(b-g)+"px"),h.ivHeader&&(g>b+84?(h.ivHeader.classList.add("minified"),h.ivNav.classList.add("minified"),h.ivPadding.style.display="block"):(h.ivHeader.classList.remove("minified"),h.ivNav.classList.remove("minified"),h.ivPadding.style.display="none")),"hidden"!=p.style.visibility){let e=this.stickyPlayer||null;if(!e&&a.invokedVideoPlayer){if(e=l.querySelector(".krg-floating-player"),!e){const t=l.querySelector("div[id^=scvp_]");t&&t.shadowRoot&&(e=t.shadowRoot.querySelector(".krg-floating-player"))}this.stickyPlayer=e}e&&""!=e.style.top&&(e.style.transform=g>=b?"translateY(0)":"translateY("+(b-window.scrollY)+"px)"),this.stickyThirdPartyPlayer&&(this.stickyThirdPartyPlayer.style.marginTop=g>=b?"0":b-window.scrollY+"px")}if(null!=(n=c.masthead)&&n.snMovingHeader)c.masthead.snMovingHeader.classList.contains("tsn-primary-menu__fixed")||(c.masthead.snMovingHeader.style.marginTop="0");else if(q("sportingnews.com")&&!r){const e=l.querySelector(".tsn-primary-menu:not(.tsn-primary-menu__fixed)");e&&(c.masthead.snMovingHeader=e,c.masthead.snMovingHeader.classList.contains("tsn-primary-menu__fixed")||(c.masthead.snMovingHeader.style.marginTop="0"))}if(null!=(o=c.masthead)&&o.snFixedHeader){const e=c.masthead.headerAnchor||null;if(e){const t=e.getBoundingClientRect();t.y+t.height>0?c.masthead.snFixedHeader.classList.contains("tsn-primary-menu__fixed")&&(c.masthead.snFixedHeader.style.marginTop=Math.floor(t.y+t.height)+"px"):c.masthead.snFixedHeader.classList.contains("tsn-primary-menu__fixed")&&c.masthead.snFixedHeader.style.removeProperty("margin-top")}}else if(q("sportingnews.com")&&!r){const e=l.querySelector(".tsn-primary-menu__fixed");if(e){c.masthead.snFixedHeader=e;const t=c.masthead.headerAnchor||null;if(t){const e=t.getBoundingClientRect();e.y+e.height>0?c.masthead.snFixedHeader.classList.contains("tsn-primary-menu__fixed")&&(c.masthead.snFixedHeader.style.marginTop=Math.floor(e.y+e.height)+"px"):c.masthead.snFixedHeader.classList.contains("tsn-primary-menu__fixed")&&c.masthead.snFixedHeader.style.removeProperty("margin-top")}}}i||requestAnimationFrame((e=>this.checkMastheadScrollPosition(e,0)))}wrapAndAppendComposerCreative(e,t){const i=document.createElement("iframe");i.style.cssText="overflow:hidden;border:none;margin:0 0;box-shadow:none;",i.style.width="320px",i.style.height="410px",t.appendChild(i);const s=i.contentWindow,n=null==s?void 0:s.document;if(!s||!n)return null;n.open(),n.write(e),n.close();try{n.documentElement.style.overflow="hidden",n.body&&(n.body.style.margin="0 0",n.body.style.padding="0 0")}catch(e){}return i.dataset.width="320px",i.dataset.height="410px",i}injectKargoCreativeStyles(e){if(!e.dataset.styleInjected)try{var t;const i=null==(t=e.contentWindow)?void 0:t.document;if(i){const t=i.createElement("style");t.textContent="div#professor_prebid-root { width: 0 !important; height: 0 !important; }",i.head?i.head.appendChild(t):i.documentElement.appendChild(t),e.dataset.styleInjected="1"}}catch(e){}}observeSpotlightCreative(e,t,i=0,s="open",n,o,a){if(!window.MutationObserver)return;o||(o="unknown"),n||(n="unknown");const l=document,r=this.standout.logger,d=this.standout.renderer,h=this.standout.device.mobile,c=this.standout.page.kargoDemoSite,p=this.mhFullWidth,g=this.overrideMaxWidth,m=this.overlayClickBlockerDelay,u=this.placements,b=(e,t)=>this.isCoreCreative(e||void 0,t||void 0),y=e=>this.standout.renderer.isIvo(e),v=()=>this.disableScrolling(),w=(e,t)=>this.checkMastheadScrollPosition(e,t),S=t.classList.contains("ksc-in-con"),k=this.standout.device.isSafariVC(),T=S&&h&&k?50:0;let A=0,E=0;"unknown"==n&&a&&a.width&&a.height&&(A=Number(a.width),E=Number(a.height));const C=e=>this.injectKargoCreativeStyles(e);function I(d,y){var S,k,x;let L=0;if(d)for(let e=0;e<d.length;e++){const t=d[e].target;t instanceof Element&&t.classList.contains("celtra-banner")&&"style"==d[e].attributeName&&(L=1)}if("1"==t.dataset.parallax&&!L&&!y)return;r.log("Adjusting Spotlight scale, element is ",e.clientWidth,e.clientHeight);const D=Math.max(l.documentElement.clientWidth||0,window.innerWidth||0),N=Math.max(l.documentElement.clientHeight||0,window.innerHeight||0);let P=getComputedStyle(e).maxWidth,q=getComputedStyle(e).maxHeight,_=null;if("none"==P)for(_=e;_.parentElement&&"none"==P;)_=_.parentElement,P=getComputedStyle(_).maxWidth;if("none"==q||parseInt(q)>N||isNaN(parseInt(q)))for(_=e;_.parentElement&&("none"==q||parseInt(q)>N||isNaN(parseInt(q)));)_=_.parentElement,q=getComputedStyle(_).maxHeight||"";const M=(null==(S=t.parentElement)?void 0:S.clientWidth)||e.clientWidth||D,R=(null==(k=t.parentElement)?void 0:k.clientHeight)||e.clientHeight||N;let O,F;var B;O=P.includes("%")?Number(P.split("%")[0])*M/100:P.includes("vw")?Number(P.split("vw")[0])*D/100:P.includes("px")?Number(P.split("px")[0]):"none"==P?M:e.clientWidth||D,F=q.includes("%")?Number(q.split("%")[0])*t.clientHeight/100:q.includes("vw")?Number(q.split("vw")[0])*N/100:q.includes("px")?Number(q.split("px")[0]):"none"==q?R:e.clientHeight||N,0===F&&(F=N),null!=(x=e.parentElement)&&x.classList.contains("ksc-masthead")?c&&!h&&l.querySelector('button[class*="LeftNavigationComponents_toggleOpen"]')&&(O-=(null==(B=l.querySelector('div[class*="MuiDrawer-docked"]'))?void 0:B.clientWidth)||0):(c||(F=N-140),h||O>D-40&&(O=D-40),c?h?F>N-80&&(F=N-80):F>N-200&&(F=N-200):F>N-140&&(F=N-140),T&&(F=Math.max(F-T,0)));const H=e.querySelector(".kargo-ad-content");let W=e.clientWidth,U=e.clientHeight;H&&H.querySelector("*[data-ivo-frame]")&&H.clientWidth>20&&H.clientHeight>20&&(W=H.clientWidth,U=H.clientHeight);const j=e.querySelector(".krg-at-container"),z=e.querySelector(".kargo-creative");if(z&&!h&&o&&b(n,o)&&("KeyArt"==n?(z.style.width="1300px",z.style.height="350px"):i&&p||(z.style.width="744px",z.style.height="250px")),z&&!z.dataset.ro&&(new ResizeObserver((e=>{for(const t of e)t.target===z&&I(null,1)})).observe(z),z.dataset.ro="1"),z&&C(z),(U<20||W<20)&&!h&&o&&b(n,o)&&("KeyArt"==n||i&&p||(W=744)),(300==W&&460==U||320==W&&460==U)&&j){const e=j.querySelector('div[class^="kargo-ad-"]');if(null!=e&&e.dataset&&"Venti"==e.dataset.format){const e=j.querySelector(".kargo-ad-content"),t=j.querySelector(".kargo-creative");t&&t.width&&"320"==t.width&&(r.log("mis-sized, adjusting to 300x460"),t.style.width="300px",t.width="300",e&&(e.style.width="300px"))}}if(0==W&&0==U&&e.firstChild){const t=e.firstChild;t&&(W=t.clientWidth,U=t.clientHeight)}if(A&&E&&A>0&&E>0)if(z&&z.contentWindow&&z.contentWindow.document){C(z);const e=z.contentWindow.document.getElementsByTagName("*")||[];let t=0;for(let i=0;i<e.length;i++)f(e[i])||(t=1);if(!t)return;const i=z.contentWindow.document.body.getBoundingClientRect();("unknown"!=n||0==A&&0==E)&&(z.style.width=i.width+"px",z.style.height=i.height+"px",W=i.width,U=i.height)}else W=A,U=E,z&&(z.style.width=A+"px",z.style.height=E+"px");(null==n||"unknown"==n)&&a&&A&&E&&(W=A,U=E,H&&"1"!=H.dataset.sized&&(H.style.width!=A+"px"&&(H.style.width=A+"px"),H.style.height!=E+"px"&&(H.style.height=E+"px"),H.style.maxWidth!=A+"px"&&(H.style.maxWidth=A+"px"),H.dataset.sized="1"),z&&"1"!=z.dataset.sized&&(z.style.width!=A+"px"&&(z.style.width=A+"px"),z.style.height!=E+"px"&&(z.style.height=E+"px"),z.style.maxWidth!=A+"px"&&(z.style.maxWidth=A+"px"),z.dataset.sized="1"));let G=Math.min(F/U,O/W);if("direct"==s||"pmp"==s||"demo"==s?(G>2&&(G=2),!h&&o&&b(n,o)&&G>1.75&&(G=1.75)):G>1.6&&(G=1.6),!h&&o&&b(n,o))"KeyArt"==n?W*G>1170?G=1170/W:U*G>612*.9&&(G=612*.9/U):i&&p?U*G>250&&(G=250/U):W*G>1170?G=1170/W:U*G>391.5&&(G=391.5/U);else if(!h&&"FabrikOutstream"==n)if(o&&"keyart"==o.toLowerCase())W*G>1170?G=1170/W:U*G>612*.9&&(G=612*.9/U);else{W*G>1170?G=1170/W:U*G>391.5&&(G=391.5/U);const t=e.querySelector("iframe.kargo-creative");t&&(C(t),t.style.width="744px",t.style.height="250px",t.style.backgroundColor="rgba(0,0,0,0)",W=e.clientWidth,U=e.clientHeight)}if(0==G)return;if(r.log("Setting scale to",G),i){if(h||"FabrikOutstream"!=n||(G=F/300),e.style.transform="scale("+G+")",e.style.transformOrigin="center top",t.style.height=U*G+"px",o&&"core"==o.toLowerCase()&&"KeyArt"==n||(t.style.width=W*G+"px"),t.style.justifyContent="stretch",t.parentElement&&(t.parentElement.style.height=t.style.height),!H||H.clientWidth==W&&H.clientHeight==U||(G=Math.min(U/H.clientHeight,W/H.clientWidth),"direct"==s||"pmp"==s||"demo"==s?(G>2&&(G=2),!h&&o&&b(n,o)&&G>1.75&&(G=1.75)):G>1.6&&(G=1.6),H.style.transform="scale("+G+")",H.style.transformOrigin="center top"),U>0&&W>0){const i=e.getElementsByTagName("*")||[];let s=0;for(let e=0;e<i.length;e++){const t=i[e];(t.clientWidth>0||t.clientHeight>0)&&(s=1)}s&&(t.dataset.sizeSet="1")}}else h||!o||!b(n,o)||z&&744==z.clientWidth&&(250==z.clientHeight||350==z.clientHeight)||z&&"744px"==z.width&&("250px"==z.height||"350px"==z.height)||z&&("250px"==z.style.height||"350px"==z.style.height)?e.style.transform="scale("+G+")":r.log("Not ready");H&&g&&(H.style.aspectRatio=g+"/1");const V=e.querySelector("#ksc-in-x");V&&(V.classList.contains("ksc-in-x-bc")?(V.style.transform="translateX(-50%) scale("+1/G+")",V.style.transformOrigin="top center",e.style.marginTop=U>0&&F-U*G<60?F-U*G-60+"px":"0"):(V.style.transform="scale("+1/G+")",V.style.transformOrigin="bottom right"));const $=e.querySelector(".ksl-adv-lbl");if($){const e=$.dataset.position;$.style.transform=e&&e.includes("center")?"translateX(-50%) scale("+1/G+")":"scale("+1/G+")"}if((e.clientHeight>0||e.firstChild&&e.firstChild.clientHeight)&&"0"==t.style.opacity&&!t.querySelector(".kargo-ad-preload")){const i=t.querySelector(".celtra-ad-inline-host");i?(i.clientHeight>0&&(e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m)),v()):(e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m),v())}i&&w(null,1)}let x;function L(s,a){var d,g,b;const y=e.querySelector(".kargo-ad-content");if(!y)return;"KeyArt"==n?(y.style.width="744px",y.style.height="350px",y.style.maxWidth="744px"):(y.style.width="744px",y.style.height="250px",y.style.maxWidth="744px");const f=y.clientWidth,S=y.clientHeight;if("1"==t.dataset.parallax&&!a)return;r.log("Adjusting Spotlight scale Core, element is ",e.clientWidth,e.clientHeight);const k=Math.max(l.documentElement.clientWidth||0,window.innerWidth||0),A=Math.max(l.documentElement.clientHeight||0,window.innerHeight||0);let E=getComputedStyle(e).maxWidth,I=getComputedStyle(e).maxHeight,D=null;if("none"==E)for(D=e;D.parentElement&&"none"==E;)D=D.parentElement,E=getComputedStyle(D).maxWidth;if("none"==I)for(D=e;D.parentElement&&"none"==I;)D=D.parentElement,I=getComputedStyle(D).maxHeight;const N=(null==(d=t.parentElement)?void 0:d.clientWidth)||e.clientWidth||k,P=(null==(g=t.parentElement)?void 0:g.clientHeight)||e.clientHeight||A;let q,_;var M;q=E.includes("%")?Number(E.split("%")[0])*N/100:E.includes("vw")?Number(E.split("vw")[0])*k/100:E.includes("px")?Number(E.split("px")[0]):"none"==E?N:e.clientWidth||k,_=I.includes("%")?Number(I.split("%")[0])*t.clientHeight/100:I.includes("vw")?Number(I.split("vw")[0])*A/100:I.includes("px")?Number(I.split("px")[0]):"none"==I?P:e.clientHeight||A,0===_&&(_=A),null!=(b=e.parentElement)&&b.classList.contains("ksc-masthead")?c&&!h&&l.querySelector('button[class*="LeftNavigationComponents_toggleOpen"]')&&(q-=(null==(M=l.querySelector('div[class*="MuiDrawer-docked"]'))?void 0:M.clientWidth)||0):(c||(_=A-140),h||q>k-40&&(q=k-40),c?h?_>A-80&&(_=A-80):_>A-200&&(_=A-200):_>A-140&&(_=A-140),T&&(_=Math.max(_-T,0)));let R=Math.min(_/S,q/f);R>1.75&&(R=1.75),h||("KeyArt"==n?f*R>1170?R=1170/f:S*R>612*.9&&(R=612*.9/S):i&&p?S*R>250&&(R=250/S):f*R>1170?R=1170/f:S*R>391.5&&(R=391.5/S));const O=e.querySelector(".kargo-creative");if(O&&!O.dataset.ro&&(C(O),new ResizeObserver((e=>{for(const t of e)t.target===O&&L(0,1)})).observe(O),O.dataset.ro="1"),0==R)return;i?(e.style.transform="scale("+R+")",e.style.transformOrigin="center top",t.style.height=S*R+"px",o&&"core"==o.toLowerCase()&&"KeyArt"==n||(t.style.width=f*R+"px"),t.style.justifyContent="stretch",t.parentElement&&(t.parentElement.style.height=t.style.height),S>0&&f>0&&(t.dataset.sizeSet="1")):e.style.transform="scale("+R+")";const F=e.querySelector("#ksc-in-x");F&&(F.classList.contains("ksc-in-x-bc")?(F.style.transform="translateX(-50%) scale("+1/R+")",F.style.transformOrigin="top center",e.style.marginTop=S>0&&_-S*R<60?_-S*R-60+"px":"0"):(F.style.transform="scale("+1/R+")",F.style.transformOrigin="bottom right"));const B=e.querySelector(".ksl-adv-lbl");if(B){const e=B.dataset.position;B.style.transform=e&&e.includes("center")?"translateX(-50%) scale("+1/R+")":"scale("+1/R+")"}if("0"==t.style.opacity&&!t.querySelector(".kargo-ad-preload"))if(t.querySelector(".celtra-ad-inline-host")){var H;const i=document.querySelector(".celtra-banner iframe");i&&null!=(H=i.contentDocument)&&null!=(H=H.querySelector("#viewport"))&&H.children.length?(x&&clearInterval(x),e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m),v()):x||(x=window.setInterval((()=>L(0,void 0)),100))}else t.querySelector("iframe.kargo-creative")&&(e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m),v());i&&w(null,1)}if(new MutationObserver((e=>{!b(n,o)||h||i?I(e):L()})).observe(e,{childList:1,subtree:1,attributes:1,attributeFilter:["width","height","style","data-format","data-exp-size","class"]}),h||i||!b(n,o)?I(null):L(),new MutationObserver((i=>{i.forEach((i=>{"0"==t.style.opacity&&y(e.innerHTML)?(e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m),v()):"1"==t.style.opacity&&y(e.innerHTML)&&"attributes"===i.type&&(e.style.width="initial")}))})).observe(e,{childList:1,subtree:1,attributes:1,attributeFilter:["style"]}),e.querySelector("iframe")&&"FabrikOutstream"!=n)try{var D;const i=e.querySelector("iframe"),s=null==i||null==(D=i.contentWindow)?void 0:D.document.body;s&&"0"==t.style.opacity&&y(s.innerHTML)&&(e.style.width="initial",t.style.opacity="1",t.style.visibility="visible",setTimeout((()=>{u.overlay.clickBlocker.style.display="none"}),m),v());const n=new MutationObserver((t=>{const i=null==s?void 0:s.querySelector("#fabrik-outstream,iframe");if(i){const t=i.clientHeight;t>0&&(e.dataset.height=t+"px",e.style.height=t+"px")}}));s&&n.observe(s,{attributes:1,childList:1,subtree:1})}catch(e){}e.querySelector("iframe")?d.watchForHeavyAd(e.querySelector("iframe"),a):new MutationObserver((t=>{e.querySelector("iframe")&&d.watchForHeavyAd(e.querySelector("iframe"),a)})).observe(e,{attributes:0,childList:1,subtree:1})}addInarticleMargins(e){e.dataset&&e.dataset.iaMarginTop&&(e.style.marginTop=e.dataset.iaMarginTop),e.dataset&&e.dataset.iaMarginBottom&&(e.style.marginBottom=e.dataset.iaMarginBottom)}observeInarticleCreative(e,t,i="open",s,n){const o=this.standout.device.mobile,a=this.inarticleSticky,l=this.activateInarticleParallax.bind(this),r=this.injectKargoCreativeStyles.bind(this);if(e.querySelector("iframe")){var d;const i=e.querySelector("iframe"),s=null==i||null==(d=i.contentWindow)?void 0:d.document.body,n=new MutationObserver((i=>{if(null!=s&&s.querySelector("iframe")){const i=s.querySelector("iframe"),n=(null==i?void 0:i.clientHeight)||0;n>20&&(e.dataset.height=n+"px",e.style.height=n+"px",t.style.visibility="visible",t.style.removeProperty("max-height"),this.addInarticleMargins(t),a&&l(e,t))}}));s&&n.observe(s,{attributes:1,childList:1,subtree:1})}const h=i=>{if(t.clientWidth>0&&t.clientHeight>0&&(e.clientWidth&&e.clientWidth>t.clientWidth&&(e.style.transform="scale("+t.clientWidth/e.clientWidth+")",t.style.height=a?e.clientHeight*(t.clientWidth/e.clientWidth)+40+"px":e.clientHeight*(t.clientWidth/e.clientWidth)+"px"),!o&&"FabrikOutstream"==s)){const t=e.querySelector("iframe.kargo-creative");t&&(r(t),t.style.width="744px",t.style.height="250px")}};new MutationObserver((i=>{o||this.placements.inarticle.parallaxActivated||h(),e.clientHeight>20&&a&&(this.addInarticleMargins(t),t.style.visibility="visible",t.style.removeProperty("max-height"),l(e,t),t.clientHeight<e.clientHeight+40&&(t.style.height=e.clientHeight+40+"px"))})).observe(t,{attributes:1,childList:1,subtree:1}),o||h()}activateInarticleParallax(e,t){this.placements.inarticle.parallaxActivated||(this.placements.inarticle.parallaxActivated=1,t.style.height=e.clientHeight+40+"px",t.style.clip="rect(0px,auto,auto,0px)",t.style.clipPath="inset(0px)",e.style.position="absolute",e.style.top="0",this.placements.inarticle.parallaxContainer=t,this.placements.inarticle.parallaxElement=e,this.checkInarticleScrollPosition())}checkInarticleScrollPosition(){const e=this.placements.inarticle.parallaxContainer,t=this.placements.inarticle.parallaxElement,i=window.scrollY||window.scrollTop||document.documentElement.scrollTop,s=e.getBoundingClientRect().top+i;let n=0;this.standout.serverSettings.showAdvLabel&&(n=8);let o=this.placements.inarticle.stickyNavBar;o&&f(o)&&(o=null),o||0!=this.inarticleScrollPositionTick||(o=(C(this.standout.page.kargoDemoSite)||[])[0]||null,this.placements.inarticle.stickyNavBar=o),o&&o!=t&&o!=e&&(n+=o.clientHeight||0),i>s-n?2===this.inarticleSticky||i-s+n<e.clientHeight-t.clientHeight?(t.style.top=n+"px",t.style.position="fixed"):(t.style.top=e.clientHeight-t.clientHeight+"px",t.style.position="absolute"):("0px"!=t.style.top&&(t.style.top="0px"),"absolute"!=t.style.position&&(t.style.position="absolute")),this.inarticleScrollPositionTick+=1,this.inarticleScrollPositionTick>30&&(this.inarticleScrollPositionTick=0),requestAnimationFrame((()=>this.checkInarticleScrollPosition()))}overlayMousedown(e){}shouldAutoscroll(e,t=0){return["idletime","reactivate","mouseleave","navaccess","refocus","manual"].includes(e)&&document.documentElement.scrollTop-t<window.innerHeight*this.mastheadAutoscrollThreshold?1:0}recordSpotlightAvail(e,t,i){let s,n,o;if((!i||!i.f)&&this.placements[e]&&this.placements[e].lastReportedAvail&&(new Date).getTime()-this.placements[e].lastReportedAvail<1e3*this.frequencyCapGeneral)return;if(this.placements[e]&&(this.placements[e].reportedImpression||this.placements[e].reportedAvail))return;i&&1==i.f?this.placements[e].reportedImpression=1:this.placements[e].reportedAvail=1,"overlay"==e?s="ov":"masthead"==e?s="mh":"inarticle"==e&&(s="if"),n=this.placements[e].auctionId,o=this.placements[e].adSlotId,this.placements[e].lastReportedAvail=(new Date).getTime(),i||(i={}),i.auId=n,i.ads=o,i.dm="cpm";const a=[];this.placements.overlay.adSlotId&&a.push(this.placements.overlay.adSlotId),this.placements.masthead.adSlotId&&"scrolltotop"==t&&a.push(this.placements.masthead.adSlotId),this.placements.inarticle.adSlotId&&"fastscroll"!=t&&"scrolltotop"!=t&&"interarticle"!=t&&"externallink"!=t&&a.push(this.placements.inarticle.adSlotId),i.slots=a,this.standout.logger.recordLogEvent("interstitial-avail-"+s+"-"+t,i)}hasOverlaySlot(){return this.placements.overlay&&this.placements.overlay.auctionConfig&&this.placements.overlay.auctionConfig.bidders&&this.placements.overlay.auctionConfig.bidders.length?1:0}hasInarticleSlot(){return this.placements.inarticle&&this.placements.inarticle.auctionConfig&&this.placements.inarticle.auctionConfig.bidders&&this.placements.inarticle.auctionConfig.bidders.length?1:0}hasMastheadSlot(){return this.placements.masthead&&this.placements.masthead.auctionConfig&&this.placements.masthead.auctionConfig.bidders&&this.placements.masthead.auctionConfig.bidders.length?1:0}recordSpotlightNoFillAvail(e,t,i,s){if(e&&this.hasOverlaySlot()&&!this.showingOverlay)return this.recordSpotlightAvail("overlay",s),1;if(t&&this.hasInarticleSlot()||i&&this.hasMastheadSlot()){if(t&&this.hasInarticleSlot()&&!this.showingInarticle)return this.recordSpotlightAvail("inarticle",s),1;if(i&&this.hasMastheadSlot()&&!this.showingMasthead)return this.recordSpotlightAvail("masthead",s),1}if(e&&!this.showingOverlay)return this.recordSpotlightAvail("overlay",s),1;if(t||i){if(t&&!this.showingInarticle)return this.recordSpotlightAvail("inarticle",s),1;if(i&&!this.showingMasthead)return this.recordSpotlightAvail("masthead",s),1}}recordOverlayClose(e){const t={};t.pos=e,t.ot=(new Date).getTime()-this.overlayShownTime,t.auId=this.placements.overlay.auctionId,t.ads=this.placements.overlay.adSlotId,this.standout.logger.recordLogEvent("interstitial-press-close",t),this.logExternally("overlay-close",{})}unidleAction(e,t){if(!t&&Date.now()-this.lastInidleTime>1e3*this.minIdleTime&&(this.triggersAvailable().overlay.reactivate||this.triggersAvailable().inarticle.reactivate||this.shouldAutoscroll("reactivate")&&this.triggersAvailable().masthead.reactivate||this.mocking)){if(!this.timingEligible(this.nextPlacement())&&!this.forceTiming)return;if(!this.spotlightOverlayAvailable&&!this.spotlightInarticleAvailable&&!this.spotlightMastheadAvailable)return void this.recordSpotlightNoFillAvail(1,1,this.shouldAutoscroll("reactivate"),"reactivate");this.mocking?this.mockShowSpotlight(1,1,this.shouldAutoscroll("reactivate"),"reactivate"):this.showSpotlight(null,0,1,1,this.shouldAutoscroll("reactivate"),"reactivate")}this.lastInidleTime=Date.now()}blurAction(e){var t;this.lastBlurTimestamp=Date.now(),this.standout.logger.log("Blur action"),document.activeElement&&"IFRAME"==document.activeElement.tagName&&(document.activeElement.dataset.embedUrl||document.activeElement.parentElement&&document.activeElement.parentElement.dataset.embedUrl||(document.activeElement.parentElement||{}).parentElement&&null!=(t=document.activeElement)&&null!=(t=t.parentElement)&&(t=t.parentElement))}navigateAction(e){if(!e.navigationType||"traverse"!==e.navigationType&&"back"!==e.navigationType&&"forward"!==e.navigationType)return;const t={timestamp:Date.now(),hasFill:0,placements:{},navigationType:e.navigationType};this.spotlightOverlayAvailable&&this.spotlightOverlayAllowed&&(t.hasFill=1,t.placements.overlay={available:1,auctionId:this.placements.overlay.auctionId||null,adSlotId:this.placements.overlay.adSlotId||null}),this.spotlightInarticleAvailable&&this.spotlightInarticleAllowed&&(t.hasFill=1,t.placements.inarticle={available:1,auctionId:this.placements.inarticle.auctionId||null,adSlotId:this.placements.inarticle.adSlotId||null}),this.spotlightMastheadAvailable&&this.spotlightMastheadAllowed&&(t.hasFill=1,t.placements.masthead={available:1,auctionId:this.placements.masthead.auctionId||null,adSlotId:this.placements.masthead.adSlotId||null}),this.standout.logger.recordLogEvent("spotlight-back-button",t)}mouseoutAction(e){if(e instanceof MouseEvent&&(e.clientY<0||e.clientY<30&&e.clientX<0||e.clientY<30&&e.clientX>window.innerWidth)&&(this.triggersAvailable().overlay.mouseLeave||this.triggersAvailable().inarticle.mouseLeave||this.shouldAutoscroll("mouseleave")&&this.triggersAvailable().masthead.mouseLeave||this.mocking)){if(!this.timingEligible(this.nextPlacement())&&!this.forceTiming)return;if(!this.spotlightOverlayAvailable&&!this.spotlightInarticleAvailable&&!this.spotlightMastheadAvailable)return void this.recordSpotlightNoFillAvail(1,1,this.shouldAutoscroll("mouseleave"),"mouseleave");this.mocking?this.mockShowSpotlight(1,1,this.shouldAutoscroll("mouseleave"),"mouseleave"):this.showSpotlight(null,0,1,1,this.shouldAutoscroll("mouseleave"),"mouseleave")}}navAccessTimer(){if(!this.standout.device.mobile)return;this.naLog||(this.naLog=[]);const e={};e.sY=window.scrollY,e.iH=window.innerHeight,e.t=(new Date).getTime(),e.td=this.touchDown,this.naLog.push(e),this.naLog.length>720&&this.naLog.shift();let t=0;if(this.naLog.length>60){let i=0,s=0,n=-1,o=-1,a=-1;for(t=this.naLog.length-1;t>=0;t--){if(e.iH>this.naLog[t].iH&&o<0&&n<0){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 1");break}if(this.naLog[t].iH!=e.iH&&e.t-this.naLog[t].t<150){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 2");break}if(e.iH<this.naLog[t].iH&&e.t-this.naLog[t].t>=150&&e.t-this.naLog[t].t<200&&(i=1,this.naLogDebug&&this.standout.logger.log("NAL: Eligible")),this.naLog[t].iH>e.iH&&n<0&&(n=t+1,this.naLogDebug&&this.standout.logger.log("NAL: Set shrink end point")),o<0&&t<this.naLog.length-10&&n>=0&&t<n&&this.naLog[t].iH==this.naLog[t+1].iH&&this.naLog[t].iH==this.naLog[t+5].iH&&this.naLog[t].iH==this.naLog[t+9].iH&&(o=t+9,a=this.naLog[t+9].sY,this.naLogDebug&&this.standout.logger.log("NAL: Set shrink start point")),o>=0&&n>=0&&a>=0){if(this.naLog[o].t-this.naLog[t].t<300&&Math.abs(this.naLog[o].sY-this.naLog[t].sY)>10){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 6");break}if(this.naLog[o].t-this.naLog[t].t<150&&this.naLog[t].td){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 7");break}if(this.naLog[o].iH-this.naLog[n].iH<20){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 8");break}if(this.naLog[o].td){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 3");break}if(this.naLog[t].sY>this.naLog[o].sY&&this.naLog[o].t-this.naLog[t].t<250){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 4");break}if(this.naLog[o].sY-this.naLog[n].sY>this.naLog[o].iH-this.naLog[n].iH||(this.standout.device.ua.includes("chrome")||this.standout.device.ua.includes("crios"))&&this.naLog[o].sY-this.naLog[n].sY>10){s=1,this.naLogDebug&&this.standout.logger.log("NAL: Failed 5");break}if((new Date).getTime()-(this.lastTouchTime||0)<500){s=1;break}}}if(i&&!s&&o>0&&n>0&&(this.standout.logger.log("Nav bar appear action!"),this.standout.logger.log("Shrink start:",o,this.naLog[o].sY,this.naLog[o].iH,this.naLog[o].t),this.standout.logger.log("Shrink end:  ",n,this.naLog[n].sY,this.naLog[n].iH,this.naLog[n].t),this.standout.logger.log("Time since last touch",(new Date).getTime()-(this.lastTouchTime||0)),this.navaccessCloseOverlay(),this.triggersAvailable().overlay.mouseLeave||this.triggersAvailable().inarticle.mouseLeave||this.shouldAutoscroll("navaccess")&&this.triggersAvailable().masthead.mouseLeave||this.mocking)){if(this.standout.logger.log("Navaccess timer trigger"),!this.timingEligible(this.nextPlacement())&&!this.forceTiming)return;if(!this.spotlightOverlayAvailable&&!this.spotlightInarticleAvailable&&!this.spotlightMastheadAvailable)return void this.recordSpotlightNoFillAvail(1,1,this.shouldAutoscroll("navaccess"),"navaccess");this.mocking?this.mockShowSpotlight(1,1,this.shouldAutoscroll("navaccess"),"navaccess"):this.showSpotlight(null,0,1,1,this.shouldAutoscroll("navaccess"),"navaccess")}}this.naLogDebug=0,requestAnimationFrame(this.navAccessTimer.bind(this))}navaccessCloseOverlay(){if(this.showingOverlay&&this.placements.overlay.container){if(this.overlayShownTime&&(new Date).getTime()-this.overlayShownTime<1e3)return;if(!q("tmz.com"))return;this.recordOverlayClose("navaccess"),this.placements.overlay.container.style.display="none",this.cancelOverlayAdjustmentCheck(),this.showingOverlay=0,this.enableScrolling()}}chromeResizeAction(e){try{this.previousHeight=window.innerHeight,this.previousScrollTop=window.visualViewport?window.visualViewport.pageTop:window.scrollY,this.lastScroll=(new Date).getTime()}catch(e){this.standout.logger.log("Resize listener error",e)}}touchStartAction(e){this.standout.logger.log("Touch start"),this.touchDown=1,this.lastTouchTime=(new Date).getTime()}touchMoveAction(e){this.touchDown=1,this.standout.logger.log("Touch move"),this.lastTouchTime=(new Date).getTime()}touchEndAction(e){this.standout.logger.log("Touch end"),this.touchDown=0}touchCancelAction(e){this.standout.logger.log("Touch cancel"),this.touchDown=0}scrollAction(e){if(this.svCurPosition=window.scrollY,null!=this.svPrevPosition&&(this.svChange=this.svCurPosition-this.svPrevPosition),this.svPrevPosition=this.svCurPosition,this.svTimer&&clearTimeout(this.svTimer),this.svTimer=window.setTimeout((()=>{this.svPrevPosition=null,this.svChange=0}),50),this.naTimer&&clearTimeout(this.naTimer),this.naTimer=window.setTimeout((()=>{this.naFurthestScrolled=document.documentElement.scrollTop}),200),!this.scrolledDownOverlay&&document.documentElement.scrollTop>window.innerHeight*this.overlayScrollToTopScrollDownThreshold&&(this.scrolledDownOverlay=1),!this.scrolledDownMasthead&&document.documentElement.scrollTop>window.innerHeight*this.mastheadScrollToTopScrollDownThreshold&&(this.scrolledDownMasthead=1),document.documentElement.scrollTop>this.furthestScrolled&&(this.furthestScrolled=document.documentElement.scrollTop),document.documentElement.scrollTop>this.naFurthestScrolled&&(this.naFurthestScrolled=document.documentElement.scrollTop),this.scrolledDownOverlay&&document.documentElement.scrollTop<window.innerHeight/5&&(this.triggersAvailable().overlay.scrollToTop||this.mocking)&&((this.timingEligible(0)||this.forceTiming)&&this.spotlightOverlayAvailable?(this.scrolledDownOverlay=0,this.mocking?this.mockShowSpotlight(1,0,0,"scrolltotop"):this.showSpotlight(null,0,1,0,0,"scrolltotop")):this.spotlightOverlayAvailable||this.recordSpotlightNoFillAvail(1,0,0,"scrolltotop")),Math.abs(this.svChange||0)>100&&(this.triggersAvailable().overlay.fastScroll||this.mocking)&&((this.timingEligible(0)||this.forceTiming)&&this.spotlightOverlayAvailable?(this.svChange=0,this.mocking?this.mockShowSpotlight(1,0,0,"fastscroll"):this.showSpotlight(null,0,1,0,0,"fastscroll")):this.spotlightOverlayAvailable||this.recordSpotlightNoFillAvail(1,0,0,"fastscroll")),(this.svChange||0)<-60&&document.documentElement.scrollTop<this.naFurthestScrolled-.75*window.innerHeight&&this.standout.device.mobile&&(this.triggersAvailable().overlay.mouseLeave||this.shouldAutoscroll("mouseleave")&&this.triggersAvailable().masthead.mouseLeave||this.mocking)){if(this.standout.logger.log("Scroll navaccess",this.svChange),this.navaccessCloseOverlay(),!this.timingEligible(this.nextPlacement())&&!this.forceTiming)return;if(!this.spotlightOverlayAvailable&&!this.spotlightInarticleAvailable&&!this.spotlightMastheadAvailable)return void this.recordSpotlightNoFillAvail(1,0,this.shouldAutoscroll("navaccess"),"navaccess");this.mocking?this.mockShowSpotlight(1,0,this.shouldAutoscroll("navaccess"),"navaccess"):this.showSpotlight(null,0,1,0,this.shouldAutoscroll("navaccess"),"navaccess"),this.naFurthestScrolled=document.documentElement.scrollTop}if(0==this.mastheadMode){if(this.scrolledDownMasthead&&document.documentElement.scrollTop<this.previousScrollTop&&document.documentElement.scrollTop<this.furthestScrolled-window.innerHeight/5){this.furthestScrolled=document.documentElement.scrollTop;const e=document.querySelector(".sci-topsticky");e?this.showingOverlay||(e.style.transform="translateY(0)",this.showingMasthead=1):(this.timingEligible(2)||this.forceTiming)&&this.spotlightMastheadAvailable?this.waitingForSticky||(this.waitingForSticky=1,window.setTimeout((()=>{this.showingOverlay||(this.mocking?this.mockShowSpotlight(0,0,1,"scrollup"):this.showSpotlight(null,0,0,0,1,"scrollup")),this.waitingForSticky=0}),500)):this.spotlightMastheadAvailable||this.recordSpotlightNoFillAvail(0,0,1,"scrollup")}if(document.documentElement.scrollTop>this.previousScrollTop){const e=document.querySelector(".sci-topsticky");e&&(e.style.transform="translateY(-100%)",this.showingMasthead=0)}if(document.documentElement.scrollTop<window.innerHeight/2){const e=document.querySelector(".sci-topsticky");e&&(e.style.transform="translateY(-100%)",this.showingMasthead=0)}}else 1==this.mastheadMode&&(this.showingMasthead||this.scrolledDownMasthead&&document.documentElement.scrollTop<this.previousScrollTop&&document.documentElement.scrollTop<.5*window.innerHeight&&(this.furthestScrolled=document.documentElement.scrollTop,this.showingMasthead||((this.timingEligible(2)||this.forceTiming)&&this.spotlightMastheadAvailable?this.showingOverlay||(this.mocking?this.mockShowSpotlight(0,0,1,"scrolltotop"):this.showSpotlight(null,0,0,0,1,"scrolltotop")):this.spotlightMastheadAvailable||this.recordSpotlightNoFillAvail(0,0,1,"scrolltotop"))));if(this.unidleAction(null),!this.pendingDelay&&(this.triggersAvailable().overlay.endOfArticle||this.triggersAvailable().inarticle.endOfArticle||this.shouldAutoscroll("endOfArticle")&&this.triggersAvailable().masthead.endOfArticle)&&this.triggerElementConfig&&this.triggerElementConfig.selector){const e=document.querySelector(this.triggerElementConfig.selector);if(e&&e instanceof HTMLElement){let t=0;if(0==this.triggerElementConfig.mode){if(k(e)<=.75){this.pendingDelay=1,this.standout.logger.log("End of article reached");const t=i=>{const s=((new Date).getTime()-i)/1e3;if(s>=1){let t=.2;if(s>=3&&(t=.5),s>=5&&(t=.75),this.standout.logger.log("Trigger element at",k(e),"required",t),k(e)<=t){let e=1;return(this.showingOverlay||!this.mocking&&!this.standout.bidStack.adSlotFill&&!this.disableFillCheck||this.standout.settings.disableAdRendering)&&(e=0),this.timingEligible(this.nextPlacement(0))||this.forceTiming||(e=0),this.spotlightOverlayAvailable||this.spotlightInarticleAvailable||this.spotlightMastheadAvailable&&1!=this.mastheadMode||(e=0,this.recordSpotlightNoFillAvail(1,1,0==this.mastheadMode,"endOfArticle")),e&&(this.mocking?this.mockShowSpotlight(1,1,1,"endOfArticle"):this.showSpotlight(null,0,1,1,0==this.mastheadMode,"endOfArticle")),void(this.pendingDelay=0)}if(k(e)>.75)return void(this.pendingDelay=0)}setTimeout((()=>{t(i)}),1e3)};setTimeout((()=>{t((new Date).getTime())}),1e3)}}else 1==this.triggerElementConfig.mode?w(e)&&(t=1):w(e)?this.triggerElementSeen=1:this.triggerElementSeen&&(t=1);if(t){let e=1;(this.showingOverlay||!this.mocking&&!this.standout.bidStack.adSlotFill&&!this.disableFillCheck||this.standout.settings.disableAdRendering)&&(e=0),this.timingEligible(this.nextPlacement(0))||this.forceTiming||(e=0),this.spotlightOverlayAvailable||this.spotlightInarticleAvailable||this.spotlightMastheadAvailable&&1!=this.mastheadMode||(e=0,this.recordSpotlightNoFillAvail(1,1,0==this.mastheadMode,"endOfArticle")),e&&(this.mocking?this.mockShowSpotlight(1,1,1,"endOfArticle"):this.showSpotlight(null,0,1,1,0==this.mastheadMode,"endOfArticle"))}}}this.lastScroll=(new Date).getTime(),this.previousScrollTop=window.visualViewport?window.visualViewport.pageTop:window.scrollY}newUrl(e,t){this.resetSpotlight();const i=this.lastServerSettings?s({},this.lastServerSettings):null;i&&this.loadServerSettings(i)}checkAdExpiration(){}checkGoogleVignette(){window.location.href.includes("#google_vignette")&&(this.googleVignetteShown=1,this.suppressOverlay())}disableScrolling(){this.standout.logger.log("Disabling scrolling"),document.body.classList.add("ksl_overlay_displayed")}enableScrolling(){document.body.classList.remove("ksl_overlay_displayed"),this.standout.logger.log("Enabling scrolling")}resetSpotlight(){var e,t,i;this.standout.serverSettings.processedScriptSettings=0,this.enableScrolling(),this.cancelOverlayAdjustmentCheck(),null!==this.idleIntervalId&&(window.clearInterval(this.idleIntervalId),this.idleIntervalId=null),this.refocusListenersAdded=0,this.windowClickListener&&(document.removeEventListener("click",this.windowClickListener,1),this.windowClickListener=null),this.documentVisibilityListener&&(document.removeEventListener("visibilitychange",this.documentVisibilityListener,1),this.documentVisibilityListener=null),this.windowFocusListener&&(window.removeEventListener("focus",this.windowFocusListener,1),this.windowFocusListener=null),this.windowWheelListener&&(window.removeEventListener("wheel",this.windowWheelListener),this.windowWheelListener=null),this.overlayMouseDownListener&&this.placements.overlay&&this.placements.overlay.container&&this.placements.overlay.container.removeEventListener("mousedown",this.overlayMouseDownListener),this.overlayMouseDownListener=null,this.standout.bidStack.cancelSpotlightAuctions(),this.recordedInarticleEligibility=0,this.recordedOverlayEligibility=0,this.recordedMastheadEligibility=0,this.showingOverlay=0,this.showingInarticle=0,this.showingMasthead=0,this.showingMastheadElement=null,this.showingMastheadNavElement=null,this.didSetUp=0;const{inarticle:s,overlay:n,masthead:o}=this.placements;null!=s&&null!=(e=s.container)&&e.parentElement&&s.container.parentElement.removeChild(s.container),null!=n&&null!=(t=n.container)&&t.parentElement&&n.container.parentElement.removeChild(n.container),null!=o&&null!=(i=o.container)&&i.parentElement&&o.container.parentElement.removeChild(o.container),null!=o&&o.parallaxElement&&o.parallaxElement.dataset.originalStyle&&(o.parallaxElement.style.cssText=o.parallaxElement.dataset.originalStyle),this.mastheadParallaxElement=null,this.mastheadNavElements=[],this.mastheadAutoNavElements=[],this.placements={overlay:{enabled:0},masthead:{enabled:0},inarticle:{enabled:0}},this.spotlightEnabled=0,this.spotlightFill=0,this.spotlightSettings={},this.mocking=0,this.triggerElementSeen=0,this.adFilledTime=0,this.pendingDelay=0,this.spotlightInarticleAllowed=0,this.spotlightOverlayAllowed=0,this.spotlightMastheadAllowed=0,this.spotlightInarticleAvailable=0,this.spotlightOverlayAvailable=0,this.spotlightMastheadAvailable=0,this.mastheadNavSelector=null,this.articleContentSelector=null,this.lastInidleTime=Date.now(),this.overlayAdjustedElements=[],this.googleVignetteShown=0}triggerSpotlightManually(e,t,i){return e&&this.spotlightOverlayAvailable&&!this.showingOverlay&&this.triggersAvailable().overlay.manual?(this.standout.logger.log("Triggering overlay manually"),this.showSpotlight(null,0,1,0,0,"manual"),1):t&&this.spotlightMastheadAvailable&&!this.showingOverlay&&this.triggersAvailable().masthead.manual?(this.standout.logger.log("Triggering masthead manually"),this.showSpotlight(null,0,0,1,0,"manual"),1):i&&this.spotlightInarticleAvailable&&!this.showingOverlay&&this.triggersAvailable().inarticle.manual?(this.standout.logger.log("Triggering in-article manually"),this.showSpotlight(null,0,0,0,1,"manual"),1):0}getSpotlightFill(){const e={overlay:{fill:0,cpm:0},masthead:{fill:0,cpm:0},inArticle:{fill:0,cpm:0}};return this.demoData&&this.demoData.upper&&(e.overlay.fill=1,e.overlay.cpm=0,e.masthead.fill=1,e.masthead.cpm=0,e.inArticle.fill=1,e.inArticle.cpm=0),this.spotlightOverlayAvailable&&this.placements.overlay.fill&&this.placements.overlay.fill.bid&&(e.overlay.fill=1,e.overlay.cpm=this.placements.overlay.fill.bid.cpm),this.spotlightMastheadAvailable&&this.placements.masthead.fill&&this.placements.masthead.fill.bid&&(e.masthead.fill=1,e.masthead.cpm=this.placements.masthead.fill.bid.cpm),this.spotlightInarticleAvailable&&this.placements.inarticle.fill&&this.placements.inarticle.fill.bid&&(e.inArticle.fill=1,e.inArticle.cpm=this.placements.inarticle.fill.bid.cpm),e}}ie.productName="Spotlight";class se extends ${constructor(e){super(e),this.demoSuppressConfigButton=0}activate(){this.loadSettings()}loadSettings(){this.standout.settings.qsBool("ksl_noconfig")&&(this.demoSuppressConfigButton=1),this.standout.settings.qsBool("sciconfig")||this.standout.settings.qsBool("ksl_config")?(this.showSpotlightConfigButton(),this.showSpotlightConfig()):(this.getSpotlight().forceEnable||this.standout.settings.qsHas("sci_settings")||this.standout.settings.qsHas("ksl_settings"))&&this.showSpotlightConfigButton()}getSpotlight(){return this.standout.getProductByType(e.ProductType.Spotlight)}showSpotlightConfigButton(){const t=this.getSpotlight(),i=document;if(this.demoSuppressConfigButton||t.demoSuppressConfigButton)return;if(t.forceEnable){const s=p("div",null,null,"position: fixed;bottom: 0;background-color: white;color: black;text-align: center;padding: 8px 85px;z-index:"+(e.zIndexMax-10)+";font-size: 14px;line-height:1.3;left:50%;transform:translateX(-50%);border-radius: 10px 10px 0px 0px;box-shadow: rgba(0, 0, 0, 0.3) 0px 0px 11px;width: min(100%, 400px);");s.id="ksl-demo-summary",s.innerHTML="<strong>Spotlight Demo Mode<strong>";const n=[];t.spotlightOverlayAllowed&&n.push("Overlay"),t.spotlightInarticleAllowed&&n.push("In-Article"),t.spotlightMastheadAllowed&&n.push("Masthead"),s.innerHTML+="<br/>"+n.join(", "),1===t.deviceTypes?s.innerHTML+=" (Mobile Only)":2===t.deviceTypes&&(s.innerHTML+=" (Desktop Only)");const o=[];t.triggers.interArticleLinks&&o.push("Inter-Article Links"),t.triggers.externalLinks&&o.push("External Links"),t.triggers.backButton&&o.push("Back Button"),t.triggers.idleTime&&o.push("Idle Time"),t.triggers.refocus&&o.push("Refocus"),t.triggers.endOfArticle&&o.push("End of Article"),t.triggers.reactivate&&o.push("Reactivate"),t.triggers.mouseLeave&&o.push("Nav Access"),t.triggers.fastScroll&&o.push("Fast Scroll"),t.triggers.scrollToTop&&o.push("Scroll to Top"),t.triggers.manual&&o.push("Manual"),s.innerHTML+="<br/>"+(o.length?"Actions: "+o.join(", "):"No Actions Configured");const a=p("a",null,"","background-image: url("+e.cdnDom+"img/focus_close.png);position: absolute;top: 0px;left: 0px;padding: 12px;font-size: 14px;color: black;text-decoration: none;width: 34px;height: 34px;background-size: contain;opacity: 0.4;cursor: pointer;",null,null);a.addEventListener("click",(e=>{e.preventDefault(),s.style.display="none"})),s.appendChild(a),i.body.appendChild(s)}const s=p("a",null,null,"position: fixed;bottom: 0;right: 14px;height: 48px;width: 56px;background-color: white;z-index: "+e.zIndexMax+";display: block;text-align: center;border-radius: 10px 10px 0 0;box-shadow: 0 0 11px rgba(0,0,0,0.5);background-image: url(https://socialcanvas-cdn.kargo.com/img/espsettings.png);background-size: 65%;background-repeat: no-repeat;background-position: center center;",null,null);s.addEventListener("click",(e=>{e.preventDefault(),this.showSpotlightConfig()})),i.body.appendChild(s)}showSpotlightConfig(){const t=this.getSpotlight(),i=document;let s=".rhscicp {position:fixed;bottom:0;right:0;height:85vh;background-color:white;z-index:"+e.zIndexMax+";border-radius:10px 10px 0 0;box-shadow:0 0 11px rgba(0,0,0,0.5);display:flex;flex-direction:column;color:black;font-family:sans-serif;max-width: min(400px, 100%);width: 400px;}";s+=".rhscicp label {display:inline-block;}",s+=".rhscicp .switch-line, .rhscicp .input-line {margin-bottom:8px;height:34px;line-height:34px;}",s+=".rhscicp .switch {position:relative;display:inline-block;width:60px;height:34px;}",s+=".rhscicp .switch input {opacity:0;width:0;height:0;border-color:white;}",s+=".rhscicp .switch-line .switch-sld {position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s;border-radius:34px;}",s+='.rhscicp .switch-line .switch-sld:before {position:absolute;content:"";height:26px;width:26px;left:4px;bottom:4px;background-color:white;transition:.4s;border-radius:50%;}',s+=".rhscicp .switch-line input:checked + .switch-sld {background-color:#2196F3;}",s+=".rhscicp .switch-line input:focus + .switch-sld {box-shadow:0 0 1px #2196F3;}",s+=".rhscicp .switch-line input:checked + .switch-sld:before {transform:translateX(26px);}",s+=".rhscicp .input-line input {float:right;width:100px;height:34px;padding:0 6px;margin:0 0;}",s+=".rhscicp .input-line select {float:right;width:170px;height:34px;padding:0 6px;}";const n=i.createElement("style");n.innerHTML=s,i.body.appendChild(n);const o=p("div","rhscicp",null,null);i.body.appendChild(o);const a=p("div","",null,"font-size:22px;display:flex;align-items:center;");o.appendChild(a);const l=p("img","",null,"height:34px;vertical-align:middle;margin-left:14px;margin-right:6px;");l.src=e.cdnDom+"img/kargoesp.png",a.appendChild(l),a.appendChild(p("span","","Spotlight Config","flex-grow:1;line-height:1;"));const r=p("a","","","float:right;width:60px;height:66px;text-align:center;line-height:55px;font-size:40px;font-weight:300;cursor:pointer;",null,null);r.addEventListener("click",(e=>{e.preventDefault(),o.style.display="none"})),a.appendChild(r);const d=p("div","",null,"flex-grow:1;padding:12px 16px;overflow-y:scroll;overflow-x:hidden;");o.appendChild(d);const h=p("div",null,null,null);d.appendChild(h),h.appendChild(this.createSwitchLine("Spotlight Demo Mode","ksci_forceEnableInterstitial",t.forceEnable)),h.appendChild(this.createSwitchLine("Allow Overlay","ksci_allowOverlay",t.spotlightOverlayAllowed)),h.appendChild(this.createSwitchLine("Allow In-article","ksci_allowInfeed",t.spotlightInarticleAllowed)),h.appendChild(this.createSwitchLine("Allow Masthead","ksci_allowMasthead",t.spotlightMastheadAllowed)),h.appendChild(this.createSelectLine("Device Types","ksci_interstitialDeviceTypes",0===t.deviceTypes?"All":1===t.deviceTypes?"Mobile":"Desktop",["All","Mobile","Desktop"])),h.appendChild(this.createInputLine("Demo Creative Key","ksci_interstitialDemoKey",t.demoKey||"","text","170px")),h.appendChild(p("h3","","Triggers",null)),h.appendChild(this.createSwitchLine("Idle Time","ksci_triggerIdleTime",t.triggers.idleTime)),h.appendChild(this.createSwitchLine("Refocus/Tab Visibility","ksci_triggerVisibility",t.triggers.refocus)),h.appendChild(this.createSwitchLine("Reactivate","ksci_triggerRefocus",t.triggers.reactivate)),h.appendChild(this.createSwitchLine("Scroll to Top","ksci_triggerScrollToTop",t.triggers.scrollToTop)),h.appendChild(this.createSwitchLine("Mouse Leave/Address Bar","ksci_triggerMouseLeave",t.triggers.mouseLeave)),h.appendChild(this.createSwitchLine("Fast Scroll","ksci_triggerFastScroll",t.triggers.fastScroll)),h.appendChild(this.createSwitchLine("Inter-article Links","ksci_triggerInterArticle",t.triggers.interArticleLinks)),h.appendChild(this.createSwitchLine("External Links","ksci_triggerExternal",t.triggers.externalLinks)),h.appendChild(this.createSwitchLine("End of Article","ksci_triggerElement",t.triggers.endOfArticle)),h.appendChild(this.createInputLine("Article Element Selector","ksci_elementConfigSelector",t.triggerElementConfig.selector||"","text","170px")),h.appendChild(p("h3","","Masthead",null)),h.appendChild(this.createInputLine("Masthead Nav Selector","ksci_interstitialMastheadNavSelector",t.mastheadNavSelector||"","text","170px")),h.appendChild(p("h3","","Thresholds",null)),h.appendChild(this.createInputLine("Minimum Idle Time (s)","ksci_interstitialMinIdleTime",t.minIdleTime)),h.appendChild(p("h3","","",null)),h.appendChild(p("h3","","",null));const c=p("a","kfi-disable","Generate Demo Link","display:block;padding:8px;text-align:center;background-color:#a0a0a0;border-radius:20px;font-size:18px;cursor:pointer;",null,null);c.addEventListener("click",(e=>{e.preventDefault(),localStorage.removeItem("rh-ksc-cfg");const t=this.generateEIDemoLink();navigator.clipboard.writeText(t).then((()=>{alert("Demo URL has been saved to the clipboard: \n"+t)})).catch((()=>{alert("Demo URL: \n"+t)}))})),h.appendChild(c),h.appendChild(p("h3","","",null));const g=p("a","","Reset to Defaults and Reload","display:block;padding:8px;text-align:center;background-color:#a0a0a0;border-radius:20px;font-size:18px;cursor:pointer;",null,null);g.addEventListener("click",(e=>{e.preventDefault(),localStorage.removeItem("rh-ksc-cfg");const t=new URL(location.href);t.searchParams.delete("sciconfig"),t.searchParams.delete("sci_settings"),t.searchParams.delete("ksl_config"),t.searchParams.delete("ksl_settings"),t.searchParams.delete("scidemo"),window.location.href=t.href})),h.appendChild(g);const m=p("div","",null,"padding:16px;");o.appendChild(m);const u=p("a","","Apply and Reload","display:block;padding:10px;text-align:center;background-color:#a4e0ff;border-radius:20px;font-size:18px;cursor:pointer;",null,null);u.addEventListener("click",(e=>{e.preventDefault(),localStorage.removeItem("rh-ksc-cfg");const t=this.generateEIDemoLink();window.location.href=t})),m.appendChild(u),i.body.appendChild(o)}generateEIDemoLink(){const e=document,t=new URL(location.href);t.searchParams.delete("sciconfig"),t.searchParams.delete("sci_settings"),t.searchParams.delete("ksl_config"),t.searchParams.delete("ksl_settings"),t.searchParams.delete("ksl_demo"),t.searchParams.delete("scidemo");let i="";const s=e.getElementById("ksci_allowOverlay").checked,n=e.getElementById("ksci_allowInfeed").checked,o=e.getElementById("ksci_allowMasthead").checked;!s||n||o?s||!n||o?s||n||!o?(i+=s?"o":"",i+=n?"i":"",i+=o?"m":""):i+="masthead":i+="inarticle":i+="overlay";const a=e.getElementById("ksci_interstitialDeviceTypes").value;i+=","+("All"==a?"all":"Mobile"==a?"mobile":"desktop"),i+=","+e.getElementById("ksci_interstitialDemoKey").value;const l=[];e.getElementById("ksci_triggerIdleTime").checked&&l.push("i"),e.getElementById("ksci_triggerVisibility").checked&&l.push("r"),e.getElementById("ksci_triggerRefocus").checked&&l.push("v"),e.getElementById("ksci_triggerScrollToTop").checked&&l.push("s"),e.getElementById("ksci_triggerMouseLeave").checked&&l.push("n"),e.getElementById("ksci_triggerFastScroll").checked&&l.push("f"),e.getElementById("ksci_triggerInterArticle").checked&&l.push("l"),e.getElementById("ksci_triggerExternal").checked&&l.push("x"),e.getElementById("ksci_triggerElement").checked&&l.push("e"),i+=",",i+=l.join("");const r=[];r.push(e.getElementById("ksci_interstitialMinIdleTime").value),r.push(e.getElementById("ksci_interstitialMastheadNavSelector").value),r.push(""),r.push(""),r.push(e.getElementById("ksci_elementConfigSelector").value);for(let e=0;e<r.length;e++)r[e]=encodeURIComponent(r[e]);for(;r.length&&""==r[r.length-1];)r.pop();r.length>0&&(i+=","+r.join(","));let d=t.href.split("#")[0];return d.includes("?")?d+="&ksl_demo="+i:d+="?ksl_demo="+i,t.hash&&(d+=t.hash),d}createSwitchLine(e,t,i){const s=p("div","switch-line",null,null);s.id="ksc_il_"+t;const n=p("label","",e,null);n.setAttribute("for",t),s.appendChild(n);const o=p("label","switch",null,"float:right;"),a=p("input",null,null,null);return a.id=t,a.setAttribute("type","checkbox"),i&&a.setAttribute("checked","true"),o.appendChild(a),o.appendChild(p("span","switch-sld",null,null)),s.appendChild(o),s}createInputLine(e,t,i,s,n){const o=p("div","input-line",null,null);o.id="ksc_il_"+t;const a=p("label","",e,null);a.setAttribute("for",t),o.appendChild(a);const l=p("input",null,null,null);return l.id=t,l.setAttribute("type",s||"number"),n&&(l.style.width=n),l.value=i,o.appendChild(l),o}createSelectLine(e,t,i,s){const n=p("div","input-line",null,null);n.id="ksc_il_"+t;const o=p("label","",e,null);o.setAttribute("for",t),n.appendChild(o);const a=p("select",null,null,null);a.id=t,a.name=t;for(const e of s||[]){const t=p("option",null,e,null,null,null);t.value=e,a.appendChild(t)}return n.appendChild(a),a.value="number"==typeof i?s[i]:i,n}}se.productName="SpotlightConfigUI",window.krg_so||(window.krg_so={}),window.krg_so.kso_load=document.timeline.currentTime;const ne=new class{constructor(){this.version="3.0.17",this.logger=new U(this),this.settings=new R,this.serverSettings=new B(this),this.communications=new j(this),this.session=new O,this.device=new H(this),this.page=new W(this),this.listeners=new F,this.bidStack=new V(this),this.renderer=new z(this),this.products=[],this.urlCheckInterval=null,this.doingReloadFor=null}activate(){if(this.logger.log("Standout version",this.version,"loading"),this.logger.SDTLog(1,this.version),/bot|crawler|spider|robot|crawling/i.test(navigator.userAgent))return;if(this.settings.ksoDisabled)return void this.logger.SDTLog(4);if(this.checkForStagingScript())return;if(this.settings.alreadyRan)return;(()=>{if("undefined"==typeof window)return;const e=window.kso||{handlers:{},addHandler(){},__cehInitialized:0};if(!e.__cehInitialized&&e.handlers)for(const[t,i]of Object.entries(e.handlers))X.includes(t)&&i.forEach((e=>Z.add(t,e)));e.handlers=e.handlers||{},e.addHandler=(t,i)=>{((e,t)=>{Z.add(e,t)})(t,i),e.handlers[t]||(e.handlers[t]=[]),e.handlers[t].push(i)},e.__cehInitialized=1,window.kso=e})(),this.settings.alreadyRan=1,this.settings.timeStart=(new Date).getTime();let e=window.location.href.split(/[?#]/)[0];if(document.body.rhData&&!this.settings.rhRunAgain&&(document.body.rhData.url==e||e.startsWith(document.body.rhData.url))&&document.body.rhVer&&1==document.body.rhVer[this.version])return this.logger.log("Standout already ran on this page."),void this.logger.SDTLog(2);if(document.body.rhData&&document.body.rhData.url!=e){if(this.settings.otherUrlRequestIds[e])return document.body.rhData.url=e,void this.logger.SDTLog(6);this.session.resetPageViewId(),this.logger.SDTLog(5),this.settings.requests[this.session.pageViewId]={slotIds:i(this.serverSettings.originalSlotIds||[])}}document.body.rhVer||(document.body.rhVer={}),document.body.rhVer[this.version]=1,this.settings.otherUrlRequestIds[e]=this.session.pageViewId,this.listeners.activate(),this.listeners.subscribeToEvent("beforeunload",0,(()=>{this.communications.sendUnloadBeacon()})),this.listenForUrlChanges();const t=1==(document.body.rhData||{}).sit;document.body.rhData={run:1,url:e},t&&(document.body.rhData.sit=1),this.settings.doingReloadFor=null,this.communications.overrideHttp(),this.bidStack.activate(),this.loadProducts(),this.page.collapseLoadingContainers()}loadProducts(){this.products.push(new K(this)),this.products.push(new Y(this)),this.products.push(new Q(this)),this.products.push(new ie(this)),this.products.push(new se(this));for(const e of this.products)e.activate()}getProductByType(e){for(const t of this.products)if(t.constructor.productName===e)return t;return null}checkForStagingScript(){if(this.settings.qsHas("rhstaging")&&this.settings.qsGet("rhstaging").length>0&&!("rhstaging"in document.body)){let t=a(this.settings.qsGet("rhstaging"));return t=t.includes("stg-")?e.cdnDom+"js/"+t.split("stg-")[1]+".js":"http://localhost:"+e.lhPort+"/"+t+".js",document.body.rhstaging=1,document.body.rhData=null,d(t,1,null,"rhscript"),this.logger.SDTLog(12,{script:t}),this.urlCheckInterval&&clearInterval(this.urlCheckInterval),1}return 1==document.body.rhstaging&&(this.settings.debugMode=1),0}listenForUrlChanges(){let e=window.location.href.split(/[?#]/)[0];const t=()=>{const s=window.location.href.split(/[?#]/)[0];if(s!==e){if(e=s,document.body.rhData&&document,s!=this.doingReloadFor&&document.body.rhData&&document.body.rhData.url!=s&&!((e,t)=>{if(!e||!t)return 0;const i=e.replace(/\/$/,""),s=t.replace(/\/$/,"");if(s.startsWith(i)){const e=s.charAt(i.length);if("/"===e||"#"===e)return 1}return 0})(document.body.rhData.url,s)){var n;this.doingReloadFor=s,this.session.resetPageViewId(),this.settings.requests[this.session.pageViewId]={slotIds:i(this.serverSettings.originalSlotIds||[])},this.settings.otherUrlRequestIds[s]=this.session.pageViewId,this.settings.timeStart=Date.now(),null!=(n=document.timeline)&&n.currentTime?window.krg_so.kso_load=document.timeline.currentTime:window.krg_so.kso_load=Date.now(),document.body.rhData.url=s;const e=document.querySelectorAll("section[data-slug]");if(this.logger.log("URL changed, looking for",s),this.logger.SDTLog(111,s),e.length)for(let t=0;t<e.length;t++){var o,a;this.logger.log("  comparing to ",e[t].getAttribute("data-slug"));const i=(null!=(o=e[t].getAttribute("data-slug"))?o:"").replace(" ",""),n=(null!=(a=e[t].getAttribute("data-permalink"))?a:"").replace(" ","").replace("https:","").replace("http:","");if(s.endsWith(i)||s.replace("https:","").replace("http:","")==n){for(const i of this.products)i.newUrl(s,e[t]);break}}else for(const e of this.products)e.newUrl(s,null);this.doingReloadFor=null}else document.body.rhData&&document.body.rhData.url!=s||s!=this.doingReloadFor&&document;requestAnimationFrame(t)}else requestAnimationFrame(t)};requestAnimationFrame(t)}getProductEligiblityObj(){const t={spotlight:{enabled:0,bidder:0},masthead:{enabled:0,bidder:0},overlay:{enabled:0,bidder:0},inarticle:{enabled:0,bidder:0},socan:{enabled:0,bidder:0}},i=this.getProductByType(e.ProductType.Spotlight);if(i&&(i.placements.overlay.enabled&&(t.overlay.enabled=1,t.spotlight.enabled=1),i.placements.masthead.enabled&&(t.masthead.enabled=1,t.spotlight.enabled=1),i.placements.inarticle.enabled&&(t.inarticle.enabled=1,t.spotlight.enabled=1)),this.bidStack.bidderDefs&&this.bidStack.bidderDefs.display&&this.bidStack.bidderDefs.display.prebid&&this.bidStack.bidderDefs.display.prebid.bidders)for(let e=0;e<this.bidStack.bidderDefs.display.prebid.bidders.length;e++){const i=this.bidStack.bidderDefs.display.prebid.bidders[e];i.enabled&&"masthead"==i.products&&(t.masthead.bidder=1,t.spotlight.bidder=1),i.enabled&&"inarticle"==i.products&&(t.inarticle.bidder=1,t.spotlight.bidder=1),i.enabled&&"overlay"==i.products&&(t.overlay.bidder=1,t.spotlight.bidder=1),i.enabled&&"socan"==i.products&&(t.socan.bidder=1),i.enabled&&"happeningnow"==i.products&&(t.socan.bidder=1)}const s={};return t&&(s.sl=t.spotlight.enabled&&t.spotlight.bidder,s.sc=t.socan.enabled&&t.socan.bidder,s.ov=t.overlay.enabled&&t.overlay.bidder,s.mh=t.masthead.enabled&&t.masthead.bidder,s.ia=t.inarticle.enabled&&t.inarticle.bidder),s}};"loading"!==document.readyState?ne.activate():document.addEventListener("DOMContentLoaded",(()=>{ne.activate()}))})();
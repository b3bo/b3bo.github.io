/**
 * @file theme.js
 * @description Theme Manager - Light/Dark mode with localStorage persistence.
 * @copyright 2025 Kimberly Bauman, P.A. All rights reserved.
 * @author John Bauman
 */
export const ThemeManager={init(){if("single"===new URLSearchParams(window.location.search).get("mode")){const e=window.CONFIG?.theme?.singleModeTheme||"light";let t=e;return"system"===e&&(t=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.classList.add("no-transitions"),this.setTheme(t,!1),void requestAnimationFrame(()=>{setTimeout(()=>{document.documentElement.classList.remove("no-transitions")},100)})}const e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,n=e||(t?"dark":"light");document.documentElement.classList.add("no-transitions"),this.setTheme(n,!1),requestAnimationFrame(()=>{setTimeout(()=>{document.documentElement.classList.remove("no-transitions")},100)}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem("theme")||this.setTheme(e.matches?"dark":"light")})},setTheme(e,t=!0){console.log("setTheme called with:",e),"dark"===e?(document.documentElement.classList.add("dark"),console.log("Added dark class to html")):(document.documentElement.classList.remove("dark"),console.log("Removed dark class from html")),console.log("HTML classes now:",document.documentElement.className),t&&localStorage.setItem("theme",e),this.updateToggleButton(e),this.updateMapTheme(e)},toggle(){const e=document.documentElement.classList.contains("dark");this.setTheme(e?"light":"dark")},updateToggleButton(e){const t=document.querySelector(".theme-icon-light"),n=document.querySelector(".theme-icon-dark");t&&n&&("dark"===e?(t.classList.remove("hidden"),n.classList.add("hidden")):(t.classList.add("hidden"),n.classList.remove("hidden")));const o=document.getElementById("theme-toggle");o&&o.setAttribute("aria-label",`Switch to ${"dark"===e?"light":"dark"} mode`)},updateMapTheme(e){window.dispatchEvent(new CustomEvent("themechange",{detail:{theme:e}}))},getCurrentTheme:()=>document.documentElement.classList.contains("dark")?"dark":"light"};if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",()=>{ThemeManager.init();const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",()=>ThemeManager.toggle())});else{ThemeManager.init();const e=document.getElementById("theme-toggle");e&&e.addEventListener("click",()=>ThemeManager.toggle())}
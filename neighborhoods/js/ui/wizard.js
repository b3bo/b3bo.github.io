/**
 * @file ui/wizard.js
 * @description Multi-step onboarding wizard for Neighborhood Finder™.
 * @copyright 2025 Kimberly Bauman, P.A. All rights reserved.
 */
import{formatSliderPrice as e,formatPrice as t,parseRange as n}from"../utils.js";const a=[{label:"Welcome",sublabel:"Get started"},{label:"Property Type",sublabel:"Homes or condos"},{label:"Budget & Size",sublabel:"Price and size"},{label:"Location",sublabel:"Where to look"},{label:"Amenities",sublabel:"Must-haves"},{label:"Summary",sublabel:"Your matches"}],s={isOpen:!1,currentStep:0,selections:{homes:!1,condos:!1,priceMin:0,priceMax:0,bedsMin:1,bathsMin:1,areas:new Set,amenities:new Set}};let i=null;const r=[function(){return'\n<div class="text-center py-6">\n            <div class="w-16 h-16 bg-neutral-800 dark:bg-neutral-700 rounded-xl flex items-center justify-center mx-auto mb-4">\n                <span style="font-family: \'Cinzel\', serif; font-size: 1.75rem; font-weight: 600; color: white; letter-spacing: 0.05em;">TS</span>\n            </div>\n            <h2 id="wizard-title" class="text-xl font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-3">\n                Welcome to Neighborhood Finder™\n            </h2>\n            <p class="text-sm text-neutral-600 dark:text-dark-text-secondary leading-relaxed max-w-sm mx-auto">\n                Discover your perfect community along 30A and Florida\'s Emerald Coast.\n                We\'ll help you explore <strong>700+ neighborhoods</strong> across Destin, Santa Rosa Beach,\n                Miramar Beach, Inlet Beach, and Panama City Beach. \n            </p>\n            <p class="text-sm text-neutral-500 dark:text-neutral-400 mt-4">\n                Let\'s find what you\'re looking for in just a few quick steps.\n            </p>\n        </div>\n    '},function(){return`\n        <div class="py-4">\n            <h2 class="text-lg font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-2 text-center">\n                Are you looking for a home or condo?\n            </h2>\n            <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-6 text-center">\n                You can select both if you're open to either.\n            </p>\n            <div class="flex gap-4 justify-center py-4">\n                <button class="wizard-prop-type flex-1 max-w-[140px] flex flex-col items-center gap-3 p-6 rounded-xl border border-neutral-300 dark:border-dark-border bg-white dark:bg-dark-bg-elevated hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-all ${s.selections.homes?"selected":""}" data-type="Homes">\n                    <svg class="w-10 h-10 text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>\n                    </svg>\n                    <span class="text-sm font-medium text-neutral-700 dark:text-dark-text-primary">Homes</span>\n                </button>\n                <button class="wizard-prop-type flex-1 max-w-[140px] flex flex-col items-center gap-3 p-6 rounded-xl border border-neutral-300 dark:border-dark-border bg-white dark:bg-dark-bg-elevated hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-all ${s.selections.condos?"selected":""}" data-type="Condos">\n                    <svg class="w-10 h-10 text-neutral-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>\n                    </svg>\n                    <span class="text-sm font-medium text-neutral-700 dark:text-dark-text-primary">Condos</span>\n                </button>\n            </div>\n            <p class="text-xs text-neutral-400 dark:text-neutral-500 text-center mt-2">\n                Or skip to see everything\n            </p>\n        </div>\n    `},function(){const t=window.PRICE_STEPS||[],n=s.selections.priceMin,a=s.selections.priceMax,i=t[n]||t[0]||25e4,r=0===a?t[t.length-1]||35e6:t[a]||t[t.length-1]||35e6,d=`${e(i)} - ${e(r)}${0===a||a>=41?"+":""}`,l=0===a?0:0===n?a/41*100:(a-n)/41*100,o=1===s.selections.bedsMin?"Any":s.selections.bedsMin>=6?"6+":`${s.selections.bedsMin}+`,c=1===s.selections.bathsMin?"Any":s.selections.bathsMin>=6?"6+":`${s.selections.bathsMin}+`,m=(s.selections.bedsMin-1)/5*100,u=(s.selections.bathsMin-1)/5*100;return`\n        <div class="py-4">\n            <h2 class="text-lg font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-2 text-center">\n                What's your budget and size needs?\n            </h2>\n            <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-6 text-center">\n                Don't worry, you can always adjust these later.\n            </p>\n            <div class="space-y-8 py-4">\n                \x3c!-- Price --\x3e\n                <div>\n                    <div class="flex justify-between items-baseline mb-2">\n                        <span class="text-sm font-medium text-neutral-600 dark:text-dark-text-secondary">Price</span>\n                        <span class="text-sm font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-price-display">${d}</span>\n                    </div>\n                    <div class="range-slider">\n                        <div class="range-track-bg"></div>\n                        <div class="range-track-fill" id="wizard-price-fill" style="left: 0%; width: ${l}%;"></div>\n                        <input type="range" min="0" max="41" value="${s.selections.priceMin}" id="wizard-price-min">\n                        <input type="range" min="0" max="41" value="${s.selections.priceMax}" id="wizard-price-max">\n                    </div>\n                </div>\n\n                \x3c!-- Beds --\x3e\n                <div>\n                    <div class="flex justify-between items-baseline mb-2">\n                        <span class="text-sm font-medium text-neutral-600 dark:text-dark-text-secondary">Bedrooms</span>\n                        <span class="text-sm font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-beds-display">${o}</span>\n                    </div>\n                    <div class="range-slider">\n                        <div class="range-track-bg"></div>\n                        <div class="range-track-fill" id="wizard-beds-fill" style="width: ${m}%;"></div>\n                        <input type="range" min="1" max="6" value="${s.selections.bedsMin}" step="1" id="wizard-beds-min">\n                    </div>\n                </div>\n\n                \x3c!-- Baths --\x3e\n                <div>\n                    <div class="flex justify-between items-baseline mb-2">\n                        <span class="text-sm font-medium text-neutral-600 dark:text-dark-text-secondary">Bathrooms</span>\n                        <span class="text-sm font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-baths-display">${c}</span>\n                    </div>\n                    <div class="range-slider">\n                        <div class="range-track-bg"></div>\n                        <div class="range-track-fill" id="wizard-baths-fill" style="width: ${u}%;"></div>\n                        <input type="range" min="1" max="6" value="${s.selections.bathsMin}" step="1" id="wizard-baths-min">\n                    </div>\n                </div>\n            </div>\n        </div>\n    `},function(){return`\n        <div class="py-4">\n            <h2 class="text-lg font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-2 text-center">\n                Where would you like to live?\n            </h2>\n            <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-6 text-center">\n                Pick as many areas as you'd like to explore.\n            </p>\n            <div class="py-2">\n                <span class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-3 block">Cities</span>\n                <div class="flex flex-wrap gap-2 mb-4">\n                    ${[{name:"Destin",zipcode:"32541"},{name:"Santa Rosa Beach",zipcode:"32459"},{name:"Miramar Beach",zipcode:"32550"},{name:"Inlet Beach",zipcode:"32461"},{name:"Panama City Beach",zipcode:"32413"}].map(e=>`<button class="wizard-area-tag px-3 py-2 rounded-lg text-sm font-medium border border-neutral-300 dark:border-dark-border bg-white dark:bg-dark-bg-elevated text-neutral-700 dark:text-dark-text-primary hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-colors ${s.selections.areas.has(e.zipcode)?"selected":""}" data-zipcode="${e.zipcode}">${e.name}</button>`).join("\n                ")}\n                </div>\n                <span class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-3 block mt-4">Sub-Areas</span>\n                <div class="flex flex-wrap gap-2">\n                    ${[{name:"West 30A",subarea:"17 - 30A West"},{name:"East 30A",subarea:"18 - 30A East"},{name:"Sandestin",subarea:"1503 - Sandestin Resort"}].map(e=>`<button class="wizard-area-tag px-3 py-2 rounded-lg text-sm font-medium border border-neutral-300 dark:border-dark-border bg-white dark:bg-dark-bg-elevated text-neutral-700 dark:text-dark-text-primary hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-colors ${s.selections.areas.has(e.subarea)?"selected":""}" data-subarea="${e.subarea}">${e.name}</button>`).join("\n                ")}\n                </div>\n            </div>\n            <p class="text-xs text-neutral-400 dark:text-neutral-500 text-center mt-4">\n                Or skip to search the entire coast\n            </p>\n        </div>\n    `},function(){return`\n        <div class="py-4">\n            <h2 class="text-lg font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-2 text-center">\n                Any must-have features?\n            </h2>\n            <p class="text-sm text-neutral-500 dark:text-neutral-400 mb-6 text-center">\n                Select the amenities that matter most to you.\n            </p>\n            <div class="py-2">\n                <div class="flex flex-wrap gap-2 justify-center">\n                    ${["Beach Access","Community Pool","Gated","Golf","Tennis","Pickleball","Fitness","Waterfront","Pet-Friendly"].map(e=>`<button class="wizard-amenity-tag btn btn--pill hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-colors ${s.selections.amenities.has(e)?"selected":""}" data-amenity="${e}">${e}</button>`).join("\n                ")}\n                </div>\n                <hr class="border-neutral-200 dark:border-dark-border my-4">\n                <span class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-3 block text-center">Rental Policy</span>\n                <div class="flex gap-2 justify-center">\n                    ${["Short-Term","No Short-Term"].map(e=>`<button class="wizard-amenity-tag btn btn--pill hover:bg-brand-100 dark:hover:bg-brand-dark/20 transition-colors ${s.selections.amenities.has(e)?"selected":""}" data-amenity="${e}">${"Short-Term"===e?"Short-Term OK":"No Short-Term"}</button>`).join("\n                ")}\n                </div>\n            </div>\n        </div>\n    `},function(){return'\n        <div class="py-2 sm:py-4">\n            <h2 class="text-base sm:text-lg font-heading font-semibold text-neutral-800 dark:text-dark-text-primary mb-1 sm:mb-2 text-center">\n                Here\'s what we found.\n            </h2>\n            <p class="text-xs sm:text-sm text-neutral-500 dark:text-neutral-400 mb-4 sm:mb-6 text-center">\n                These neighborhoods match your criteria.\n            </p>\n\n            \x3c!-- Hero Number --\x3e\n            <div class="text-center mb-4 sm:mb-6">\n                <div class="text-3xl sm:text-5xl font-bold text-brand-600 dark:text-brand-dark" id="wizard-stat-communities">--</div>\n                <div class="text-xs sm:text-sm text-neutral-500 dark:text-neutral-400 mt-1">Matching Neighborhoods</div>\n            </div>\n\n            \x3c!-- Stats Grid --\x3e\n            <div class="grid grid-cols-2 gap-2 sm:gap-3 mb-4 sm:mb-6">\n                <div class="bg-neutral-50 dark:bg-dark-bg-elevated-2 rounded-xl p-3 sm:p-4 text-center">\n                    <div class="text-base sm:text-xl font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-stat-listings">--</div>\n                    <div class="text-xs text-neutral-500 dark:text-neutral-400 mt-1">Active</div>\n                </div>\n                <div class="bg-neutral-50 dark:bg-dark-bg-elevated-2 rounded-xl p-3 sm:p-4 text-center">\n                    <div class="text-base sm:text-xl font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-stat-median">--</div>\n                    <div class="text-xs text-neutral-500 dark:text-neutral-400 mt-1">Median</div>\n                </div>\n                <div class="bg-neutral-50 dark:bg-dark-bg-elevated-2 rounded-xl p-3 sm:p-4 text-center">\n                    <div class="text-base sm:text-xl font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-stat-price-range">--</div>\n                    <div class="text-xs text-neutral-500 dark:text-neutral-400 mt-1">Price Range</div>\n                </div>\n                <div class="bg-neutral-50 dark:bg-dark-bg-elevated-2 rounded-xl p-3 sm:p-4 text-center">\n                    <div class="text-base sm:text-xl font-semibold text-neutral-800 dark:text-dark-text-primary" id="wizard-stat-dom">--</div>\n                    <div class="text-xs text-neutral-500 dark:text-neutral-400 mt-1">Avg Days on Market</div>\n                </div>\n            </div>\n\n            \x3c!-- Top Neighborhoods Preview --\x3e\n            <div id="wizard-top-communities">\n                <span class="text-xs font-medium text-neutral-500 dark:text-neutral-400 uppercase tracking-wider mb-2 block">Top Neighborhoods by Listings</span>\n                <div id="wizard-top-list" class="space-y-2">\n                    \x3c!-- Populated dynamically --\x3e\n                </div>\n            </div>\n        </div>\n    '}];export function openWizard(){const e=document.getElementById("wizard-modal");if(!e)return;i=document.activeElement;const t=s.selections,n=t.homes||t.condos||0!==t.priceMin||0!==t.priceMax||1!==t.bedsMin||1!==t.bathsMin||t.areas.size>0||t.amenities.size>0;s.currentStep=n?1:0,e.classList.remove("hidden"),s.isOpen=!0,d(),l(),o(),setTimeout(()=>{const e=document.getElementById("wizard-close");e&&e.focus()},100)}export function closeWizard(){const e=document.getElementById("wizard-modal");if(e){e.classList.add("hidden"),s.isOpen=!1;try{localStorage.setItem("nf_wizard_seen","1")}catch(e){}i&&i.focus()}}export function nextStep(){if(s.currentStep>=5)return function(){const e=window.filterState;if(!e)return;const t=document.getElementById("btn-homes"),n=document.getElementById("btn-condos");t&&(s.selections.homes?t.classList.add("active"):t.classList.remove("active")),n&&(s.selections.condos?n.classList.add("active"):n.classList.remove("active")),e.priceMin=s.selections.priceMin,e.priceMax=s.selections.priceMax;const a=document.getElementById("price-min"),i=document.getElementById("price-max");a&&(a.value=e.priceMin),i&&(i.value=e.priceMax),e.bedsMin=s.selections.bedsMin,e.bathsMin=s.selections.bathsMin;const r=document.getElementById("beds-min"),d=document.getElementById("baths-min");r&&(r.value=e.bedsMin),d&&(d.value=e.bathsMin),e.areas=new Set(s.selections.areas),document.querySelectorAll(".area-tag").forEach(t=>{const n=t.dataset.zipcode,a=t.dataset.subarea;(e.areas.has(n)||e.areas.has(a))&&t.classList.add("selected")}),e.amenities=new Set(s.selections.amenities),document.querySelectorAll(".amenity-tag").forEach(t=>{const n=t.dataset.amenity;e.amenities.has(n)&&t.classList.add("selected")}),window.updatePriceSlider&&window.updatePriceSlider(a,i),window.updateBedsSlider&&window.updateBedsSlider(),window.updateBathsSlider&&window.updateBathsSlider(),window.applyFilters&&window.applyFilters();const l=document.getElementById("summary-panel"),o=document.getElementById("main-menu");l&&(document.querySelectorAll(".sliding-panel").forEach(e=>{e.classList.add("translate-x-full")}),o&&(o.style.display="none"),l.classList.remove("translate-x-full"))}(),void closeWizard();s.currentStep++,d(),l(),o(),5===s.currentStep&&setTimeout(c,50)}export function prevStep(){s.currentStep<=0||(s.currentStep--,d(),l(),o())}function d(){const t=document.getElementById("wizard-content");if(!t)return;const n=r[s.currentStep];n&&(t.innerHTML=n(),function(){document.querySelectorAll(".wizard-prop-type").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.type;e.classList.toggle("selected");const n=e.classList.contains("selected");"Homes"===t?s.selections.homes=n:"Condos"===t&&(s.selections.condos=n)})}),document.querySelectorAll(".wizard-area-tag").forEach(e=>{e.addEventListener("click",()=>{e.classList.toggle("selected");const t=e.dataset.zipcode,n=e.dataset.subarea,a=t||n;e.classList.contains("selected")?s.selections.areas.add(a):s.selections.areas.delete(a)})}),document.querySelectorAll(".wizard-amenity-tag").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.amenity;if("Short-Term"===t||"No Short-Term"===t){const e="Short-Term"===t?"No Short-Term":"Short-Term",n=document.querySelector(`.wizard-amenity-tag[data-amenity="${e}"]`);n&&(n.classList.remove("selected"),s.selections.amenities.delete(e))}e.classList.toggle("selected"),e.classList.contains("selected")?s.selections.amenities.add(t):s.selections.amenities.delete(t)})});const t=document.getElementById("wizard-price-min"),n=document.getElementById("wizard-price-max");if(t&&n){const a=a=>{const i=window.PRICE_STEPS||[];let r=parseInt(t.value)||0,d=parseInt(n.value)||0;r>d&&0!==d&&(a?.target===n?(t.value=d,r=d):(n.value=r,d=r)),s.selections.priceMin=r,s.selections.priceMax=d;const l=document.getElementById("wizard-price-display");if(l){const t=i[r]||i[0],n=0===d?i[i.length-1]:i[d]||i[i.length-1];l.textContent=`${e(t)} - ${e(n)}${0===d||d>=41?"+":""}`}const o=document.getElementById("wizard-price-fill");if(o)if(0===d)o.style.left="0",o.style.width="0";else{const e=r/41,t=d/41;o.style.left=100*e+"%",o.style.width=100*(t-e)+"%"}};t.addEventListener("input",e=>a(e)),n.addEventListener("input",e=>a(e))}const a=(e,t,n,a)=>{const i=document.getElementById(e),r=document.getElementById(t),d=document.getElementById(n);i&&i.addEventListener("input",()=>{const e=parseInt(i.value);s.selections[a]=e,r&&(r.textContent=1===e?"Any":e>=6?"6+":`${e}+`),d&&(d.style.width=(e-1)/5*100+"%")})};a("wizard-beds-min","wizard-beds-display","wizard-beds-fill","bedsMin"),a("wizard-baths-min","wizard-baths-display","wizard-baths-fill","bathsMin")}())}function l(){const e=document.getElementById("wizard-steps-vertical"),t=document.getElementById("wizard-steps-horizontal");if(e){const t='<svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">\n            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>\n        </svg>';e.innerHTML=a.map((e,n)=>{let a="",i=n+1;return n<s.currentStep?(a="completed",i=t):n===s.currentStep&&(a="active"),`\n                <div class="wizard-step-item ${a}">\n                    <div class="wizard-step-circle">${i}</div>\n                    <div class="pt-1">\n                        <div class="wizard-step-label">${e.label}</div>\n                        <div class="wizard-step-sublabel">${e.sublabel}</div>\n                    </div>\n                </div>\n            `}).join("")}t&&(t.innerHTML=a.map((e,t)=>{let n="",a=t+1;return t<s.currentStep?(n="completed",a='<svg class="w-3.5 h-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">\n        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>\n    </svg>'):t===s.currentStep&&(n="active"),`\n                <div class="wizard-step-h ${n}">\n                    ${t>0?'<div class="wizard-step-h-line"></div>':""}\n                    <div class="wizard-step-h-circle">${a}</div>\n                </div>\n            `}).join(""))}function o(){const e=document.getElementById("wizard-back"),t=document.getElementById("wizard-next");e&&(e.disabled=0===s.currentStep),t&&(t.textContent=5===s.currentStep?"Explore Results":"Next")}function c(){const e=window.neighborhoods||[],a=window.PRICE_STEPS||[];if(console.log("[Wizard] Calculating stats with",e.length,"neighborhoods"),console.log("[Wizard] Selections:",JSON.stringify({homes:s.selections.homes,condos:s.selections.condos,priceMin:s.selections.priceMin,priceMax:s.selections.priceMax,bedsMin:s.selections.bedsMin,bathsMin:s.selections.bathsMin,areas:[...s.selections.areas],amenities:[...s.selections.amenities]})),0===e.length)return void console.warn("[Wizard] No neighborhoods data available");const i=e.filter(e=>{const t=s.selections.homes,i=s.selections.condos;if(t||i){const n=(e.propertyType||"").toLowerCase();let a=!1;if(!t||"homes"!==n&&"townhomes"!==n||(a=!0),i&&"condos"===n&&(a=!0),!a)return!1}if(s.selections.areas.size>0&&!(s.selections.areas.has(e.zipCode)||s.selections.areas.has(e.area)||s.selections.areas.has(e.subArea)))return!1;if(s.selections.amenities.size>0){const t=e.amenities||[];if(![...s.selections.amenities].every(e=>t.includes(e)))return!1}const r=e.stats||{},d=s.selections.priceMin,l=s.selections.priceMax,o=0===d?0:a[d]||0,c=0===l||l>=41?Number.MAX_SAFE_INTEGER:a[l]||Number.MAX_SAFE_INTEGER;let m=null!=r.minPrice?parseFloat(r.minPrice):null,u=null!=r.maxPrice?parseFloat(r.maxPrice):null;if((null===m||null===u)&&r.priceRange){const e=n(r.priceRange);e&&(m=e.min,u=e.max)}if(!(null===m||null===u||isNaN(m)||isNaN(u)||c>=m&&o<=u))return!1;if(s.selections.bedsMin>1){const e=void 0!==r.maxBeds?parseFloat(r.maxBeds):null;if(null!==e&&!isNaN(e)&&e<s.selections.bedsMin)return!1}if(s.selections.bathsMin>1){const e=void 0!==r.maxBaths?parseFloat(r.maxBaths):null;if(null!==e&&!isNaN(e)&&e<s.selections.bathsMin)return!1}return!0});console.log("[Wizard] Filtered to",i.length,"of",e.length,"neighborhoods");const r=i.reduce((e,t)=>e+(t.stats?.listingCount||0),0),d=i.map(e=>e.stats?.medianPrice||e.stats?.avgPrice||0).filter(e=>e>0),l=d.length>0?Math.min(...d):0,o=d.length>0?Math.max(...d):0,c=d.length>0?d.sort((e,t)=>e-t)[Math.floor(d.length/2)]:0,m=i.length>0?Math.round(i.reduce((e,t)=>e+(t.stats?.avgDom||0),0)/i.length):0,u=document.getElementById("wizard-stat-communities"),p=document.getElementById("wizard-stat-listings"),x=document.getElementById("wizard-stat-price-range"),b=document.getElementById("wizard-stat-median"),h=document.getElementById("wizard-stat-dom");u&&(u.textContent=i.length.toLocaleString()),p&&(p.textContent=r.toLocaleString()),x&&(x.textContent=d.length>0?`${t(l)} - ${t(o)}`:"N/A"),b&&(b.textContent=c>0?t(c):"N/A"),h&&(h.textContent=m>0?`${m} days`:"N/A");const g=[...i].sort((e,t)=>(t.stats?.listingCount||0)-(e.stats?.listingCount||0)).slice(0,3),v=document.getElementById("wizard-top-list");v&&(g.length>0?v.innerHTML=g.map(e=>`\n                <div class="flex justify-between items-center py-2 px-3 bg-white dark:bg-dark-bg-elevated rounded-lg border border-neutral-200 dark:border-dark-border">\n                    <span class="text-sm font-medium text-neutral-700 dark:text-dark-text-primary">${e.name}</span>\n                    <span class="text-xs text-neutral-500 dark:text-neutral-400">${e.stats?.listingCount||0} listings</span>\n                </div>\n            `).join(""):v.innerHTML='<p class="text-sm text-neutral-500 dark:text-neutral-400 text-center py-2">No matching neighborhoods found</p>')}export function initWizard(){const e=document.getElementById("wizard-trigger");e&&e.addEventListener("click",openWizard);const t=document.getElementById("wizard-close");t&&t.addEventListener("click",closeWizard);const n=document.getElementById("wizard-close-mobile");n&&n.addEventListener("click",closeWizard);const a=document.getElementById("wizard-next"),i=document.getElementById("wizard-back");if(a&&a.addEventListener("click",nextStep),i&&i.addEventListener("click",prevStep),document.addEventListener("keydown",e=>{"Escape"===e.key&&s.isOpen&&closeWizard()}),"single"!==new URLSearchParams(window.location.search).get("mode"))try{localStorage.getItem("nf_wizard_seen")||setTimeout(()=>{openWizard()},500)}catch(e){}console.log("[Wizard] Initialized")}"undefined"!=typeof window&&(window.openWizard=openWizard,window.closeWizard=closeWizard);
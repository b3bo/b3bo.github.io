/**
 * Neighborhood Finder - Tailwind 4 Design System
 *
 * Enterprise-grade theming with light/dark mode support
 * Last Updated: December 3, 2025
 */

/* Tailwind base, components, utilities */
@import "tailwindcss";

/* Apply fonts globally */
@layer base {
  /* Expose CSS dvh to JavaScript via custom property */
  :root {
    --one-dvh: 1dvh;
  }

  /* Security: Prevent text selection (except inputs) */
  body {
    font-family: 'Roboto', ui-sans-serif, system-ui, sans-serif;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  /* Allow selection in form elements */
  input, textarea, [contenteditable="true"] {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }
  
  h1, h2, h3, h4, h5, h6 {
    font-family: 'Montserrat', ui-sans-serif, system-ui, sans-serif;
  }
  
  /* Prevent iOS zoom on input focus without changing font size */
  input, textarea, select {
    font-size: 16px;
    /* Prevent iOS from zooming when focused */
    -webkit-text-size-adjust: 100%;
  }
}

@theme {
  /* ===================================================================
     AGENT REBRAND SECTION START
     Change these 4 values to rebrand the entire application
     =================================================================== */

  /* Primary Brand Color */
  --color-brand-base: #4c8f96;
  --color-brand-hover: #3a7179;
  --color-brand-light: rgba(76, 143, 150, 0.1);
  --color-brand-rgb: 76, 143, 150;

  /* ===================================================================
     AGENT REBRAND SECTION END
     =================================================================== */

  /* Neutral Palette (Light Mode) */
  --color-neutral-50: #f9fafb;
  --color-neutral-100: #f3f4f6;
  --color-neutral-200: #e5e7eb;
  --color-neutral-300: #d1d5db;
  --color-neutral-400: #9ca3af;
  --color-neutral-500: #6b7280;
  --color-neutral-600: #4b5563;
  --color-neutral-700: #374151;
  --color-neutral-800: #313842;
  --color-neutral-900: #1f2937;

  /* Dark Mode Colors */
  --color-dark-bg-base: #0f1419;
  --color-dark-bg-elevated: #1a1f26;
  --color-dark-bg-elevated-2: #252b34;
  --color-dark-border: #2d3440;
  --color-dark-text-primary: #e8eaed;
  --color-dark-text-secondary: #9ca3af;

  /* Brand Colors (Dark Mode Adjusted) */
  --color-brand-dark: #5ba3ab;
  --color-brand-dark-hover: #6bb5be;

  /* Functional Colors */
  --color-success: #10b981;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  --color-info: #3b82f6;

  /* === SEMANTIC ALIASES === */

  /* Primary/Brand */
  --color-primary: var(--color-brand-base);
  --color-primary-hover: var(--color-brand-hover);
  --color-primary-light: var(--color-brand-light);

  /* Text Colors */
  --color-text-primary: var(--color-neutral-800);
  --color-text-secondary: var(--color-neutral-600);
  --color-text-muted: var(--color-neutral-500);
  --color-text-inverse: white;

  /* Background Colors */
  --color-bg-base: white;
  --color-bg-sidebar: white;
  --color-bg-panel: white;
  --color-bg-card: white;
  --color-bg-hover: var(--color-neutral-50);
  --color-bg-active: var(--color-neutral-100);
  --color-bg-tag: var(--color-neutral-100);
  --color-bg-overlay: rgba(0, 0, 0, 0.5);

  /* Border Colors */
  --color-border: var(--color-neutral-200);
  --color-border-divider: var(--color-neutral-200);
  --color-border-focus: var(--color-brand-base);
  --color-border-hover: var(--color-neutral-300);

  /* Shadow Colors */
  --color-shadow: rgba(0, 0, 0, 0.1);
  --color-shadow-lg: rgba(0, 0, 0, 0.15);

  /* === EXTEND TAILWIND COLOR SCALE === */

  /* Brand Scale (for bg-brand-500, text-brand-600, etc.) */
  --color-brand-50: #f0f9fa;
  --color-brand-100: #d9f0f3;
  --color-brand-200: #b3e1e7;
  --color-brand-300: #8dd2db;
  --color-brand-400: #67c3cf;
  --color-brand-500: var(--color-brand-base);
  --color-brand-600: var(--color-brand-hover);
  --color-brand-700: #2d575d;
  --color-brand-800: #1f3d41;
  --color-brand-900: #122325;

  /* === TYPOGRAPHY === */

  /* Font Families */
  --font-sans: 'Roboto', ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  --font-heading: 'Montserrat', ui-sans-serif, system-ui, sans-serif;

  /* Font Weights */
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 600;
  --font-weight-bold: 700;

  /* Fluid Typography Scale (Responsive) */
  --font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
  --font-size-sm: clamp(0.875rem, 0.8rem + 0.35vw, 1rem);
  --font-size-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
  --font-size-lg: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
  --font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
  --font-size-2xl: clamp(1.5rem, 1.3rem + 1vw, 1.875rem);
  --font-size-3xl: clamp(1.875rem, 1.6rem + 1.375vw, 2.25rem);
  --font-size-4xl: clamp(2.25rem, 1.9rem + 1.75vw, 3rem);

  /* Line Heights */
  --line-height-tight: 1.25;
  --line-height-snug: 1.375;
  --line-height-normal: 1.5;
  --line-height-relaxed: 1.625;
  --line-height-loose: 2;

  /* === SPACING === */

  /* Vertical Spacing (8px base unit) */
  --space-1: 0.5rem;
  --space-2: 1rem;
  --space-3: 1.5rem;
  --space-4: 2rem;
  --space-6: 3rem;
  --space-8: 4rem;
  --space-12: 6rem;

  /* Horizontal Container Spacing */
  --container-padding-mobile: 1rem;
  --container-padding-tablet: 1.5rem;
  --container-padding-desktop: 2rem;
  --container-padding-wide: 3rem;

  /* Container Max Widths */
  --container-sm: 640px;
  --container-md: 768px;
  --container-lg: 1024px;
  --container-xl: 1280px;
  --container-2xl: 1536px;

  /* Custom Spacing */
  --space-sidebar-width: 460px;

  /* === BORDER RADIUS === */

  --radius-sm: 0.375rem;
  --radius-md: 0.5rem;
  --radius-lg: 0.75rem;
  --radius-xl: 1rem;
  --radius-2xl: 1.5rem;

  /* === TRANSITIONS === */

  --transition-fast: 150ms;
  --transition-base: 200ms;
  --transition-slow: 300ms;
  --panel-duration: 1000ms;  /* Set by CONFIG.animations.panelSlideDuration */

  /* === Z-INDEX SCALE === */

  --z-sidebar: 1000;
  --z-dropdown: 1100;
  --z-modal: 1200;
  --z-tooltip: 1300;

  /* === BREAKPOINTS === */

  --breakpoint-xs: 420px;
  --breakpoint-sm: 640px;
  --breakpoint-md: 768px;
  --breakpoint-lg: 1024px;
  --breakpoint-xl: 1280px;
  --breakpoint-2xl: 1536px;
}

/* Smooth theme transitions */
/* Apply to elements without explicit transitions defined */
*:not(.sliding-panel):not(#sidebar):not([class*="duration-"]) {
  transition-property: background-color, border-color, color;
  transition-duration: var(--transition-base);
  transition-timing-function: ease-in-out;
}

/* Allow map clicks through backdrop - fix marker click issue */
#map {
  position: relative;
  z-index: 31 !important; /* Higher than backdrop (z-30) */
  pointer-events: auto !important;
}

/* Google Maps Info Window Styling */
.gm-style-iw-container {
  padding: 0 !important;
  max-width: 320px !important;
}

.gm-style-iw {
  padding: 0 !important;
}

.gm-style-iw-d {
  overflow: auto !important;
  max-height: 400px !important;
}

/* Info window content wrapper */
.info-window-content {
  padding: 1rem;
  font-family: var(--font-sans);
}

.info-window-content h3 {
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--color-text-primary);
  margin-bottom: 0.5rem;
}

.dark .info-window-content h3 {
  color: var(--color-dark-text-primary);
}

.info-window-content p {
  font-size: 0.875rem;
  color: var(--color-text-secondary);
  margin-bottom: 0.25rem;
}

.dark .info-window-content p {
  color: var(--color-dark-text-secondary);
}

.info-window-content .amenities {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.info-window-content .amenity-tag {
  display: inline-block;
  padding: 0.25rem 0.75rem;
  background-color: var(--color-brand-light);
  color: var(--color-brand-base);
  border-radius: 9999px;
  font-size: 0.75rem;
  font-weight: 500;
}

.dark .info-window-content .amenity-tag {
  background-color: rgba(var(--color-brand-rgb), 0.2);
  color: var(--color-brand-dark);
}

/* Disable transitions during theme initialization */
.no-transitions *,
.no-transitions *::before,
.no-transitions *::after {
  transition: none !important;
}

/* Custom Divider - Light/Dark theme flexible */
hr.divider {
  border-color: var(--color-neutral-200);
  margin: 0;
}

.dark hr.divider {
  border-color: var(--color-dark-border);
}

/* Range Slider Styles */
.range-slider {
  position: relative;
  height: 4px;
  margin: 1rem 0;
}

.range-track-bg {
  position: absolute;
  width: 100%;
  height: 4px;
  background-color: var(--color-neutral-200);
  border-radius: 2px;
}

.dark .range-track-bg {
  background-color: var(--color-dark-border);
}

.range-track-fill {
  position: absolute;
  height: 4px;
  background-color: var(--color-brand-base);
  opacity: 0.5;
  border-radius: 2px;
  pointer-events: none;
}

.dark .range-track-fill {
  background-color: var(--color-brand-dark);
  opacity: 0.5;
}

.range-slider input[type="range"] {
  position: absolute;
  width: calc(100% + 16px);
  margin-left: -8px;
  height: 4px;
  background: transparent;
  pointer-events: none;
  -webkit-appearance: none;
  appearance: none;
}

/* Range slider thumb styles moved to POST-TAILWIND section */

/* Optional: Scan files for classes */
@source "../../../index.html";
@source "../../../assets/js/*.js";


/* Configure dark mode to use class strategy instead of prefers-color-scheme */
@variant dark (.dark &);

/* ============================================
   POST-TAILWIND OVERRIDES
   These must come AFTER @import to avoid being processed/optimized by Tailwind
   ============================================ */

/* Range slider thumb - 32px hit area with 16px visual circle */
/* Uses native border rendering (smooth) + transparent outer border (hit area) + drop-shadow */
.range-slider input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 32px;
  height: 32px;
  background-color: var(--color-brand-base);
  background-clip: content-box;
  padding: 2px;
  border: 8px solid transparent;
  border-radius: 50%;
  cursor: pointer;
  pointer-events: auto;
  box-shadow: inset 0 0 0 2px white;
  filter: drop-shadow(0 1px 1.5px rgba(0, 0, 0, 0.25));
}

.dark .range-slider input[type="range"]::-webkit-slider-thumb {
  background-color: var(--color-brand-dark);
  box-shadow: inset 0 0 0 2px var(--color-dark-bg-elevated);
}

.range-slider input[type="range"]::-moz-range-thumb {
  width: 32px;
  height: 32px;
  background-color: var(--color-brand-base);
  background-clip: content-box;
  padding: 2px;
  border: 8px solid transparent;
  border-radius: 50%;
  cursor: pointer;
  pointer-events: auto;
  box-shadow: inset 0 0 0 2px white;
  filter: drop-shadow(0 1px 1.5px rgba(0, 0, 0, 0.25));
}

.dark .range-slider input[type="range"]::-moz-range-thumb {
  background-color: var(--color-brand-dark);
  box-shadow: inset 0 0 0 2px var(--color-dark-bg-elevated);
}

/* Missing Tailwind classes - manually defined (NOT processed by Tailwind) */
/* CRITICAL: translate: initial unsets Tailwind v4's translate property so transform works */
.-translate-x-full {
  translate: initial !important;
  transform: translateX(-100%) !important;
}

/* Positive translate for hiding sliding panels off-screen right */
.translate-x-full {
  translate: initial !important;
  transform: translateX(100%) !important;
}

.translate-x-0 {
  translate: initial !important;
  transform: translateX(0) !important;
}

/* Sidebar closed state - shows 5px peek edge */
.-translate-x-\[calc\(100\%-5px\)\] {
  --tw-translate-x: 0 !important;
  --tw-translate-y: 0 !important;
  translate: initial !important;
  transform: translateX(calc(-100% + 5px)) !important;
}

/* Direct sidebar default (closed) state - ID selector for specificity */
#sidebar {
  translate: initial !important;
  transform: translateX(calc(-100% + 5px)) !important;
}

/* Sliding panel visibility with delayed hide for close animation */
.sliding-panel {
  transition: transform var(--panel-duration) ease-out, visibility 0s linear var(--panel-duration) !important;
}

/* Force hidden panels to be invisible AFTER animation completes */
.sliding-panel.translate-x-full {
  visibility: hidden !important;
  pointer-events: none !important;
}

/* Make panels visible immediately when opening (no delay) */
.sliding-panel:not(.translate-x-full) {
  visibility: visible !important;
  pointer-events: auto !important;
  transition-delay: 0s !important;
}

/* Sidebar peer-checked override (NOT processed by Tailwind) */
#drawer-toggle:checked ~ #sidebar {
  translate: initial !important;
  transform: translateX(0) !important;
  --tw-translate-x: 0 !important;
  --tw-translate-y: 0 !important;
}

/* Property type, area & amenity button active/selected state */
#btn-homes.active,
#btn-condos.active,
.area-tag.selected,
.amenity-tag.selected {
  background-color: var(--color-brand-base);
  border-color: var(--color-brand-base);
  color: white;
}

.dark #btn-homes.active,
.dark #btn-condos.active,
.dark .area-tag.selected,
.dark .amenity-tag.selected {
  background-color: var(--color-brand-dark);
  border-color: var(--color-brand-dark);
  color: white;
}
/* ========================================================================
   LAZY LOADING - Image Performance
   ======================================================================== */

/**
 * Native lazy loading with blur-up placeholder effect
 * Usage:
 *   <img data-src="image.jpg" src="blur-placeholder.jpg" class="lazy-image" alt="...">
 */

/* Base lazy image styles */
img[data-src],
img.lazy-image {
  /* Prevent layout shift while loading */
  background-color: var(--color-neutral-100);
}

.dark img[data-src],
.dark img.lazy-image {
  background-color: var(--color-dark-bg-elevated);
}

/* Blur placeholder effect (while loading) */
img[data-src]:not(.loaded) {
  filter: blur(10px);
  opacity: 0.8;
}

/* Smooth transition when image loads */
img.lazy-image,
img.lazy-loaded {
  transition: filter 0.3s ease-out, opacity 0.3s ease-out;
}

/* Full-res image loaded */
img.lazy-loaded,
img[data-src].loaded {
  filter: blur(0);
  opacity: 1;
}

/* Fallback: Apply blur-up to images with placeholders */
.blur-up-container img {
  background-size: cover;
  background-position: center;
}

/* ========================================================================
   WCAG Focus Ring Styles
   ======================================================================== */

/* Global default: All focusable elements get brand focus ring (inset to avoid clipping) */
button:focus-visible,
a:focus-visible,
input:focus-visible,
select:focus-visible,
textarea:focus-visible,
[tabindex="0"]:focus-visible,
.focus-ring:focus,
.focus-ring:focus-visible {
  outline: none !important;
  box-shadow: inset 0 0 0 2px rgba(103, 195, 207, 0.3) !important; /* brand-400/30 inset */
}

/* Exclude scroll containers from focus ring */
.panel-content:focus-visible,
.overflow-y-auto:focus-visible,
[style*="overflow"]:focus-visible {
  outline: none !important;
  box-shadow: none !important;
}

.dark button:focus-visible,
.dark a:focus-visible,
.dark input:focus-visible,
.dark select:focus-visible,
.dark textarea:focus-visible,
.dark [tabindex]:focus-visible,
.dark .focus-ring:focus,
.dark .focus-ring:focus-visible {
  box-shadow: inset 0 0 0 2px rgba(107, 181, 190, 0.3) !important; /* brand-dark-hover/30 inset */
}

/* Focus ring with offset for buttons/cards */
.focus-ring-offset:focus,
.focus-ring-offset:focus-visible {
  outline: none;
  box-shadow: 0 0 0 2px white, 0 0 0 4px rgba(76, 143, 150, 0.5);
}

.dark .focus-ring-offset:focus,
.dark .focus-ring-offset:focus-visible {
  box-shadow: 0 0 0 2px var(--color-dark-bg-elevated), 0 0 0 4px rgba(91, 163, 171, 0.5);
}

/* ========================================================================
   INLINE CSS EXTRACTION (from index.html)
   ======================================================================== */

/* Custom scrollbar - uses brand CSS variables */
.panel-content::-webkit-scrollbar,
#main-menu::-webkit-scrollbar,
#search-results::-webkit-scrollbar {
  width: 10px;
}
.panel-content::-webkit-scrollbar-track,
#main-menu::-webkit-scrollbar-track,
#search-results::-webkit-scrollbar-track {
  background: transparent;
}
.panel-content::-webkit-scrollbar-thumb,
#main-menu::-webkit-scrollbar-thumb,
#search-results::-webkit-scrollbar-thumb {
  background-color: var(--color-brand-100);
  border-radius: 20px;
  transition: background-color 0.2s;
  min-height: 60px;
}
.panel-content::-webkit-scrollbar-thumb:hover,
#main-menu::-webkit-scrollbar-thumb:hover,
#search-results::-webkit-scrollbar-thumb:hover {
  background-color: var(--color-brand-base);
}
.panel-content::-webkit-scrollbar-thumb:active,
#main-menu::-webkit-scrollbar-thumb:active,
#search-results::-webkit-scrollbar-thumb:active {
  background-color: var(--color-brand-base);
}
.dark .panel-content::-webkit-scrollbar-thumb,
.dark #main-menu::-webkit-scrollbar-thumb,
html.dark #search-results::-webkit-scrollbar-thumb {
  background-color: rgba(var(--color-brand-rgb), 0.2);
}
.dark .panel-content::-webkit-scrollbar-thumb:hover,
.dark #main-menu::-webkit-scrollbar-thumb:hover,
html.dark #search-results::-webkit-scrollbar-thumb:hover {
  background-color: var(--color-brand-dark);
}
.dark .panel-content::-webkit-scrollbar-thumb:active,
.dark #main-menu::-webkit-scrollbar-thumb:active,
html.dark #search-results::-webkit-scrollbar-thumb:active {
  background-color: var(--color-brand-dark);
}

/* Tab icon switching - show X when drawer is open */
#drawer-toggle:checked ~ aside .tab-icon-closed {
  display: none;
}
#drawer-toggle:checked ~ aside .tab-icon-open {
  display: block;
}

/* Info window close button removal - CSS fallback before JS removes it */
.gm-style-iw-chr {
  display: none !important;
}
.gm-style .gm-style-iw-c {
  padding: 0 !important;
  border: none !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15) !important;
  outline: none !important;
  border-radius: 12px !important;
}
.gm-style .gm-style-iw-tc::after {
  background: transparent !important;
}
.dark .gm-style .gm-style-iw-c {
  background-color: #262626 !important;
}

/* Prevent black focus outlines on map and marker elements */
#map:focus,
.gm-style *:focus,
.marker-pin:focus,
.gm-style-iw:focus,
.gm-style-iw *:focus {
  outline: none !important;
}

/* Scrollable amenities (3-row max) - fade only when overflow */
.amenities-scroll {
  max-height: 3.9em;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}
.amenities-scroll.has-overflow {
  mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
  -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
}
.amenities-scroll strong {
  font-weight: 700;
  color: inherit;
}
.amenities-scroll::-webkit-scrollbar { width: 3px; }
.amenities-scroll::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 2px;
}

/* Scrollable communities (3-row max) - fade only when overflow */
.communities-scroll {
  max-height: 3.9em;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}
.communities-scroll.has-overflow {
  mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
  -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
}
.communities-scroll::-webkit-scrollbar { width: 3px; }
.communities-scroll::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 2px;
}

/* Search dropdown fade effect (stationary mask on container) */
#search-results.has-overflow {
  mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
  -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%);
}

/* Single mode: hide sidebar before paint */
.single-mode #sidebar,
.single-mode #drawer-toggle,
.single-mode label[for="drawer-toggle"],
.single-mode .disclaimer-bar {
  display: none !important;
}
.single-mode #map-layout {
  height: 100dvh !important;
}

/* Marker fade transition for area filter */
.marker-fade-out {
  opacity: 0 !important;
  transition: opacity 0.4s ease-out !important;
}

/* Dark mode disclaimer bar */
.dark .disclaimer-bar {
  background-color: #2E2E2E !important;
}

/* ========================================================================
   LOADER ANIMATION (from index.html)
   ======================================================================== */

/* Dual-shape rotating loader */
.loader-dual-shape {
  position: relative;
  width: 2.5em;
  height: 2.5em;
  transform: rotate(165deg);
}
.loader-dual-shape:before,
.loader-dual-shape:after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  display: block;
  width: 0.5em;
  height: 0.5em;
  border-radius: 0.25em;
  transform: translate(-50%, -50%);
}
.loader-dual-shape:before {
  animation: loader-before 2s infinite;
}
.loader-dual-shape:after {
  animation: loader-after 2s infinite;
}

/* Light mode loader */
@keyframes loader-before {
  0% { width: 0.5em; box-shadow: 1em -0.5em rgba(76, 143, 150, 0.75), -1em 0.5em rgba(163, 163, 163, 0.75); }
  35% { width: 2.5em; box-shadow: 0 -0.5em rgba(76, 143, 150, 0.75), 0 0.5em rgba(163, 163, 163, 0.75); }
  70% { width: 0.5em; box-shadow: -1em -0.5em rgba(76, 143, 150, 0.75), 1em 0.5em rgba(163, 163, 163, 0.75); }
  100% { box-shadow: 1em -0.5em rgba(76, 143, 150, 0.75), -1em 0.5em rgba(163, 163, 163, 0.75); }
}
@keyframes loader-after {
  0% { height: 0.5em; box-shadow: 0.5em 1em rgba(91, 163, 171, 0.75), -0.5em -1em rgba(115, 115, 115, 0.75); }
  35% { height: 2.5em; box-shadow: 0.5em 0 rgba(91, 163, 171, 0.75), -0.5em 0 rgba(115, 115, 115, 0.75); }
  70% { height: 0.5em; box-shadow: 0.5em -1em rgba(91, 163, 171, 0.75), -0.5em 1em rgba(115, 115, 115, 0.75); }
  100% { box-shadow: 0.5em 1em rgba(91, 163, 171, 0.75), -0.5em -1em rgba(115, 115, 115, 0.75); }
}

/* Dark mode loader */
.dark .loader-dual-shape:before {
  animation: loader-before-dark 2s infinite;
}
.dark .loader-dual-shape:after {
  animation: loader-after-dark 2s infinite;
}
@keyframes loader-before-dark {
  0% { width: 0.5em; box-shadow: 1em -0.5em rgba(91, 163, 171, 0.85), -1em 0.5em rgba(163, 163, 163, 0.85); }
  35% { width: 2.5em; box-shadow: 0 -0.5em rgba(91, 163, 171, 0.85), 0 0.5em rgba(163, 163, 163, 0.85); }
  70% { width: 0.5em; box-shadow: -1em -0.5em rgba(91, 163, 171, 0.85), 1em 0.5em rgba(163, 163, 163, 0.85); }
  100% { box-shadow: 1em -0.5em rgba(91, 163, 171, 0.85), -1em 0.5em rgba(163, 163, 163, 0.85); }
}
@keyframes loader-after-dark {
  0% { height: 0.5em; box-shadow: 0.5em 1em rgba(76, 143, 150, 0.85), -0.5em -1em rgba(192, 192, 192, 0.85); }
  35% { height: 2.5em; box-shadow: 0.5em 0 rgba(76, 143, 150, 0.85), -0.5em 0 rgba(192, 192, 192, 0.85); }
  70% { height: 0.5em; box-shadow: 0.5em -1em rgba(76, 143, 150, 0.85), -0.5em 1em rgba(192, 192, 192, 0.85); }
  100% { box-shadow: 0.5em 1em rgba(76, 143, 150, 0.85), -0.5em -1em rgba(192, 192, 192, 0.85); }
}

/* ========================================================================
   ONBOARDING WIZARD STYLES
   ======================================================================== */

/* Modal entrance/exit animation */
#wizard-modal {
  transition: opacity 0.2s ease-out;
}
#wizard-modal.hidden {
  opacity: 0;
  pointer-events: none;
}
#wizard-modal:not(.hidden) {
  opacity: 1;
}

/* Card entrance animation */
#wizard-card {
  transition: transform 0.3s ease-out, opacity 0.3s ease-out;
}
#wizard-modal.hidden #wizard-card {
  transform: scale(0.95) translateY(10px);
  opacity: 0;
}
#wizard-modal:not(.hidden) #wizard-card {
  transform: scale(1) translateY(0);
  opacity: 1;
}

/* Vertical Step Indicator */
.wizard-step-item {
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  padding: 0.75rem 0;
  position: relative;
}

/* Connecting line between steps */
.wizard-step-item:not(:last-child)::after {
  content: '';
  position: absolute;
  left: 15px;
  top: 44px;
  width: 2px;
  height: calc(100% - 32px);
  background-color: var(--color-neutral-200);
}
.dark .wizard-step-item:not(:last-child)::after {
  background-color: var(--color-dark-border, #2d3440);
}
.wizard-step-item.completed:not(:last-child)::after {
  background-color: var(--color-neutral-400);
}
.dark .wizard-step-item.completed:not(:last-child)::after {
  background-color: var(--color-neutral-500);
}

/* Step circle (number or checkmark) */
.wizard-step-circle {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.875rem;
  font-weight: 600;
  flex-shrink: 0;
  transition: all 0.2s ease;
  border: 2px solid var(--color-neutral-300);
  background-color: white;
  color: var(--color-neutral-500);
}
.dark .wizard-step-circle {
  border-color: var(--color-dark-border, #2d3440);
  background-color: var(--color-dark-bg-elevated, #1a1f26);
  color: var(--color-neutral-400);
}

/* Active step */
.wizard-step-item.active .wizard-step-circle {
  border-color: var(--color-brand-base);
  background-color: var(--color-brand-base);
  color: white;
}
.dark .wizard-step-item.active .wizard-step-circle {
  border-color: var(--color-brand-dark);
  background-color: var(--color-brand-dark);
  color: white;
}

/* Completed step - outlined circle with gray checkmark */
.wizard-step-item.completed .wizard-step-circle {
  border-color: var(--color-neutral-400);
  background-color: transparent;
  color: var(--color-neutral-500);
}
.dark .wizard-step-item.completed .wizard-step-circle {
  border-color: var(--color-neutral-500);
  background-color: transparent;
  color: var(--color-neutral-400);
}

/* Step text labels */
.wizard-step-label {
  font-size: 0.8125rem;
  font-weight: 500;
  color: var(--color-neutral-600);
  line-height: 1.3;
}
.wizard-step-sublabel {
  font-size: 0.6875rem;
  color: var(--color-neutral-400);
  margin-top: 2px;
}
.dark .wizard-step-label {
  color: var(--color-dark-text-secondary, #9ca3af);
}
.dark .wizard-step-sublabel {
  color: var(--color-neutral-500);
}
.wizard-step-item.active .wizard-step-label {
  color: var(--color-brand-base);
  font-weight: 600;
}
.dark .wizard-step-item.active .wizard-step-label {
  color: var(--color-brand-dark);
}
.wizard-step-item.completed .wizard-step-label {
  color: var(--color-neutral-700);
}
.dark .wizard-step-item.completed .wizard-step-label {
  color: var(--color-dark-text-primary, #e8eaed);
}

/* Horizontal step indicators (mobile) */
.wizard-step-h {
  display: flex;
  align-items: center;
}
.wizard-step-h-circle {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.75rem;
  font-weight: 600;
  border: 2px solid var(--color-neutral-300);
  background-color: white;
  color: var(--color-neutral-400);
  flex-shrink: 0;
}
.dark .wizard-step-h-circle {
  border-color: var(--color-dark-border, #2d3440);
  background-color: var(--color-dark-bg-elevated, #1a1f26);
  color: var(--color-neutral-500);
}
.wizard-step-h.active .wizard-step-h-circle {
  border-color: var(--color-brand-base);
  background-color: var(--color-brand-base);
  color: white;
}
.dark .wizard-step-h.active .wizard-step-h-circle {
  border-color: var(--color-brand-dark);
  background-color: var(--color-brand-dark);
  color: white;
}
.wizard-step-h.completed .wizard-step-h-circle {
  border-color: var(--color-neutral-400);
  background-color: transparent;
  color: var(--color-neutral-500);
}
.dark .wizard-step-h.completed .wizard-step-h-circle {
  border-color: var(--color-neutral-500);
  background-color: transparent;
  color: var(--color-neutral-400);
}
.wizard-step-h-line {
  width: 20px;
  height: 2px;
  background-color: var(--color-neutral-300);
}
.dark .wizard-step-h-line {
  background-color: var(--color-dark-border, #2d3440);
}
.wizard-step-h.completed + .wizard-step-h .wizard-step-h-line-before,
.wizard-step-h.completed .wizard-step-h-line {
  background-color: var(--color-neutral-400);
}
.dark .wizard-step-h.completed + .wizard-step-h .wizard-step-h-line-before,
.dark .wizard-step-h.completed .wizard-step-h-line {
  background-color: var(--color-neutral-500);
}

/* Property type selection cards */
.wizard-prop-type {
  transition: border-color 0.2s ease, background-color 0.2s ease;
}
/* Match sidebar Homes/Condos button styling */
.wizard-prop-type.selected {
  background-color: var(--color-brand-base) !important;
  border-color: var(--color-brand-base) !important;
  color: white !important;
}
.wizard-prop-type.selected svg {
  color: white !important;
}
.wizard-prop-type.selected span {
  color: white !important;
}
.dark .wizard-prop-type.selected {
  background-color: var(--color-brand-dark) !important;
  border-color: var(--color-brand-dark) !important;
  color: white !important;
}
.dark .wizard-prop-type.selected svg {
  color: white !important;
}
.dark .wizard-prop-type.selected span {
  color: white !important;
}

/* Area and Amenity tag selection */
.wizard-area-tag,
.wizard-amenity-tag {
  transition: all 0.15s ease;
}
.wizard-area-tag.selected,
.wizard-amenity-tag.selected {
  background-color: var(--color-brand-base) !important;
  border-color: var(--color-brand-base) !important;
  color: white !important;
}
.dark .wizard-area-tag.selected,
.dark .wizard-amenity-tag.selected {
  background-color: var(--color-brand-dark) !important;
  border-color: var(--color-brand-dark) !important;
  color: white !important;
}

/* Summary stats highlight animation */
@keyframes wizard-stat-pop {
  0% { transform: scale(1); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1); }
}
.wizard-stat-highlight {
  animation: wizard-stat-pop 0.3s ease-out;
}

/* Responsive adjustments */
@media (max-width: 640px) {
  #wizard-card {
    margin: 0.5rem;
    max-height: calc(100vh - 1rem);
  }
  #wizard-content {
    max-height: calc(100vh - 160px) !important;
  }
  .wizard-prop-type {
    padding: 1rem !important;
  }
}